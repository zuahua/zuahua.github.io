<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>使用PHPMailer库发送邮件支持ssl方式</title>
    <url>/2019-12-14-shi-yong-phpmailer-ku-fa-song-you-jian.html</url>
    <content><![CDATA[<p>说明：</p>
<ul>
<li>PHP7..</li>
<li>PHPMailer 6.1.4 Github下载 <a href="https://github.com/PHPMailer/PHPMailer" target="_blank" rel="noopener external nofollow noreferrer">PHPMailer</a>，直接克隆下来就ok</li>
<li>开启PHP扩展：sockets、openssl；方法:PHP.ini文件中搜索对应名，去掉使用扩展前的注释(不细说了)</li>
<li>本文使用ssl方式</li>
<li>网易邮箱</li>
<li>端口 465</li>
</ul>
<a id="more"></a>

<h3><span id="写本文原因">写本文原因</span></h3><p>阿里云25端口被封印，上篇文章使用SMTP 25端口，本地能成，服务器上不行</p>
<p>阿里，emmmmmmmmmmm</p>
<p>网上大量的教程，大部分使用的是低版本PHPMailer；</p>
<p>他们只引入PHPMailer.class.php之类的文件；</p>
<p>然后我发现现在没有这文件了…</p>
<h3><span id="phpmailer的引入">PHPMailer的引入</span></h3><p>克隆下来的包重命名为PHPMailer</p>
<p>包的结构：</p>
<p>PHPMailer</p>
<ul>
<li>language</li>
<li>src</li>
<li>…</li>
</ul>
<p>主要使用</p>
<ul>
<li>src/Exception.php</li>
<li>src/PHPMailer.php</li>
<li>PHPMailer/src/SMTP.php</li>
</ul>
<p><strong>将PHPMailer包放在将要使用的项目文件夹下</strong></p>
<h3><span id="sendmailphp">sendMail.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">&#x2F;&#x2F; 发送邮件的函数 </span><br><span class="line"></span><br><span class="line">    use PHPMailer\PHPMailer\PHPMailer;</span><br><span class="line">    use PHPMailer\PHPMailer\Exception;</span><br><span class="line">    &#x2F;&#x2F;引入项目</span><br><span class="line">    require &#39;.&#x2F;PHPMailer&#x2F;src&#x2F;Exception.php&#39;;</span><br><span class="line">    require &#39;.&#x2F;PHPMailer&#x2F;src&#x2F;PHPMailer.php&#39;;</span><br><span class="line">    require &#39;.&#x2F;PHPMailer&#x2F;src&#x2F;SMTP.php&#39;;</span><br><span class="line"></span><br><span class="line">    function funSendMail($toMail, $mailcontent) &#123;     </span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;实例化PHPMail类</span><br><span class="line">        $mail &#x3D; new PHPMailer(true);                              </span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F;Server settings</span><br><span class="line">            $mail-&gt;SMTPDebug &#x3D; 0; &#x2F;&#x2F; 0 1 2                                 </span><br><span class="line">            $mail-&gt;isSMTP();  &#x2F;&#x2F; 使用SMTP发送邮件</span><br><span class="line">            $mail-&gt;Host &#x3D; &#39;smtp.163.com&#39;;  &#x2F;&#x2F;SMTP邮件服务器地址（腾讯企业邮为例）</span><br><span class="line">            $mail-&gt;SMTPAuth &#x3D; true;                               </span><br><span class="line">            $mail-&gt;Username &#x3D; &#39;187xxxxx8@163.com&#39;; &#x2F;&#x2F; SMTP 发件人邮箱</span><br><span class="line">            $mail-&gt;Password &#x3D; &#39;xxxx&#39;;  &#x2F;&#x2F; SMTP 发件人邮箱密码</span><br><span class="line">            $mail-&gt;SMTPSecure &#x3D; &#39;ssl&#39;;      &#x2F;&#x2F; Enable TLS encryption, &#96;ssl&#96; also accepted</span><br><span class="line">            $mail-&gt;Port &#x3D; 465;       &#x2F;&#x2F; TCP port to connect to</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;发件人</span><br><span class="line">            $mail-&gt;setFrom(&quot;187xxxxx8@163.com&quot;, &#39;网站管理系统&#39;); &#x2F;&#x2F;发件人邮箱（同 $mail-&gt;Username项设置）、发件人名称</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;收件人。多收件人可设置多个addAddress</span><br><span class="line">            $mail-&gt;addAddress($toMail);&#x2F;&#x2F;收件人邮箱地址，收件人姓名（选填）</span><br><span class="line">            &#x2F;&#x2F;$mail-&gt;addAddress(&#39;ellen@example.com&#39;);               &#x2F;&#x2F; 收件人邮箱地址</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;发送附件</span><br><span class="line">            &#x2F;&#x2F;$mail-&gt;addAttachment(&#39;&#x2F;var&#x2F;tmp&#x2F;file.tar.gz&#39;);         &#x2F;&#x2F; 添加附件</span><br><span class="line">            &#x2F;&#x2F;$mail-&gt;addAttachment(&#39;&#x2F;tmp&#x2F;image.jpg&#39;, &#39;new.jpg&#39;);    &#x2F;&#x2F; 设置附件以及附件名称</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;邮件内容</span><br><span class="line">            $mail-&gt;isHTML(true);                                  &#x2F;&#x2F;   发送html格式邮件</span><br><span class="line">            $mail-&gt;Subject &#x3D; &#39;用户帐号激活&#39;;                                &#x2F;&#x2F;邮件标题</span><br><span class="line">            $mail-&gt;Body    &#x3D; $mailcontent; &#x2F;&#x2F;邮件内容</span><br><span class="line">            &#x2F;&#x2F;$mail-&gt;AltBody &#x3D; &#39;邮件摘要&#39;;                    &#x2F;&#x2F;目测没什么用，可去掉</span><br><span class="line"></span><br><span class="line">            $mail-&gt;send();</span><br><span class="line"></span><br><span class="line">            echo &quot;恭喜！注册成功！请登录邮箱及时激活账号，若未收到邮件，请查看垃圾邮件&quot;;</span><br><span class="line">            </span><br><span class="line">        &#125; catch (Exception $e) &#123;</span><br><span class="line">            &#x2F;&#x2F;echo &#39;Message could not be sent. Mailer Error: &#39;, $mail-&gt;ErrorInfo;</span><br><span class="line">            echo &quot;对不起，邮件发送失败！请检查邮箱填写是否有误。&quot;;</span><br><span class="line">            </span><br><span class="line">            exit();</span><br><span class="line">        &#125;</span><br><span class="line">            &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>


<h3><span id="testphp">test.php</span></h3><p>调用函数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">    require_once &#39;sendMail.php&#39;;</span><br><span class="line">    $toMail &#x3D; &quot;1xxxxxxx12@qq.com&quot;;</span><br><span class="line">    $mailcontent &#x3D; &quot;hello&quot;;</span><br><span class="line">    funSendMail($toMail, $mailcontent);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="邮件内容乱码问题">邮件内容乱码问题</span></h3><p>电脑邮箱查看不乱码</p>
<p>手机上看乱码</p>
<p>解决: </p>
<p>进入到PHPMailer/src目录，打开PHPMailer.php文件，将CHARSET_ISO88591、CHARSET_UTF8两项修改为UTF-8编码</p>
<p>设置邮件编码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$mail &#x3D; new PHPMailer();</span><br><span class="line">$mail-&gt;Charset&#x3D;&#39;UTF-8&#39;;</span><br></pre></td></tr></table></figure>

<h3><span id="参考">参考</span></h3><p><a href="https://www.jianshu.com/p/d103cabb9d68" target="_blank" rel="noopener external nofollow noreferrer">PHPMailer6.0.5邮件发送实例，并解决乱码问题</a></p>
<p><a href="https://www.cnblogs.com/wangpg/p/5330759.html" target="_blank" rel="noopener external nofollow noreferrer">PHPMailer中文乱码问题的解决方法</a></p>
]]></content>
      <tags>
        <tag>PHPMailer 邮件</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP实现注册时邮箱验证</title>
    <url>/2019-12-11-php-shi-xian-zhu-ce-shi-you-xiang-yan-zheng.html</url>
    <content><![CDATA[<p>说明：</p>
<ul>
<li>PHP7</li>
<li>使用smtp</li>
<li>163邮箱</li>
</ul>
<p>实现思路：</p>
<ul>
<li>注册时利用用户名、加密密码、时间戳构建激活识别码存入数据库，数据库中active_status=0</li>
<li>发送邮件给用户，激活识别码传入 激活链接，点击链接GET方式将激活识别码交给后台处理</li>
<li>激活将active_status=1</li>
</ul>
<p>文件目录:</p>
<ul>
<li>register.html</li>
<li>register.php</li>
<li>sql.php</li>
<li>Smtp.class.php</li>
<li>active.php</li>
</ul>
<a id="more"></a>

<h3><span id="数据表">数据表</span></h3><p><img src="/assets/images/PHPMail/1.png" alt="image"></p>
<ul>
<li>注意设置数值型字段初值</li>
</ul>
<h3><span id="registerhtml">register.html</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;注册&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;register.php&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">        &lt;label&gt;姓名：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sName&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;label&gt;学号：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sId&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;label&gt;班级：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sClass&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;label&gt;手机号：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sPhone&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;label&gt;邮箱：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sMail&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;label&gt;密码：&lt;&#x2F;label&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;sPwd&quot; &#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;注册&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="sqlphp">sql.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $server &#x3D; &quot;localhost&quot;;</span><br><span class="line">	$user &#x3D; &quot;root&quot;;</span><br><span class="line">	$password &#x3D; &quot;密码&quot;;</span><br><span class="line">    $dbname &#x3D; &quot;users&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="registerphp">register.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    if(!isset($_POST[&quot;submit&quot;])) &#123;</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    include &#39;.&#x2F;sql.php&#39;;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 连接</span><br><span class="line">	$conn &#x3D; new mysqli($server, $user, $password, $dbname);</span><br><span class="line">	if($conn-&gt;connect_error)&#123;</span><br><span class="line">		die(&quot;连接失败&quot; . $conn-&gt;connect_error);</span><br><span class="line">		exit();</span><br><span class="line">	&#125;</span><br><span class="line">    $conn-&gt;query(&quot;set names utf8&quot;);</span><br><span class="line"></span><br><span class="line">    $sName &#x3D; trim($_POST[&quot;sName&quot;]);</span><br><span class="line">    $sId &#x3D; trim($_POST[&quot;sId&quot;]);</span><br><span class="line">    $sClass &#x3D; trim($_POST[&quot;sClass&quot;]);</span><br><span class="line">    $sPhone &#x3D; trim($_POST[&quot;sPhone&quot;]);</span><br><span class="line">    $sMail &#x3D; trim($_POST[&quot;sMail&quot;]);</span><br><span class="line">    </span><br><span class="line">    $sPwd &#x3D; md5(trim($_POST[&quot;sPwd&quot;]));</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 用户名是否存在...</span><br><span class="line"></span><br><span class="line">    $regtime &#x3D; time();</span><br><span class="line"> </span><br><span class="line">    $token &#x3D; md5($sName.$sPwd.$regtime); &#x2F;&#x2F;创建用于激活识别码</span><br><span class="line">    $token_exptime &#x3D; time()+60*60*24;&#x2F;&#x2F;过期时间为24小时后</span><br><span class="line"></span><br><span class="line">    $sql_insert &#x3D; &quot;INSERT INTO &#96;sys_students&#96; </span><br><span class="line">        (&#96;sId&#96;, &#96;sName&#96;, &#96;sClass&#96;, &#96;sPhone&#96;, &#96;sMail&#96;, &#96;sPwd&#96;, &#96;token&#96;, </span><br><span class="line">        &#96;token_exptime&#96;, &#96;regtime&#96;)</span><br><span class="line">        VALUES ($sId, &#39;$sName&#39;, &#39;$sClass&#39;, &#39;$sPhone&#39;, &#39;$sMail&#39;, &#39;$sPwd&#39;, &#39;$token&#39;, </span><br><span class="line">        $token_exptime, $regtime)&quot;;</span><br><span class="line">    $result &#x3D; $conn-&gt;query($sql_insert);</span><br><span class="line">    </span><br><span class="line">    if($result) &#123;&#x2F;&#x2F; 数据插入成功</span><br><span class="line">        require_once &quot;Smtp.class.php&quot;;</span><br><span class="line">        &#x2F;&#x2F;******************** 配置信息 ********************************</span><br><span class="line">        $smtpserver &#x3D; &quot;smtp.163.com&quot;;&#x2F;&#x2F;SMTP服务器</span><br><span class="line">        $smtpserverport &#x3D;25;&#x2F;&#x2F;SMTP服务器端口</span><br><span class="line">        $smtpusermail &#x3D; &quot;187xx212478@163.com&quot;;&#x2F;&#x2F;SMTP服务器的用户邮箱</span><br><span class="line">        $smtpemailto &#x3D; $sMail;&#x2F;&#x2F;发送给谁</span><br><span class="line">        $smtpuser &#x3D; &quot;187xx2478@163.com&quot;;&#x2F;&#x2F;SMTP服务器的用户帐号，注：部分邮箱只需@前面的用户名</span><br><span class="line">        $smtppass &#x3D; &quot;密码&quot;;&#x2F;&#x2F;SMTP服务器的授权码</span><br><span class="line">        $mailtitle &#x3D; &quot;用户帐号激活&quot;;&#x2F;&#x2F;邮件主题</span><br><span class="line">        $mailcontent &#x3D; &quot;亲爱的&quot;.$sName.&quot;：&lt;br&#x2F;&gt;感谢您在我站注册了新帐号。&lt;br&#x2F;&gt;请点击链接激活您的帐号。&lt;br&#x2F;&gt;&lt;a href&#x3D;&#39;http:&#x2F;&#x2F;127.0.0.1:82&#x2F;test&#x2F;mailValidate&#x2F;active.php?verify&#x3D;&quot;.$token.&quot;&#39; target&#x3D;&#39;_blank&#39;&gt;http:&#x2F;&#x2F;127.0.0.1:82&#x2F;test&#x2F;mailValidate&#x2F;active.php?verify&#x3D;&quot;.$token.&quot;&lt;&#x2F;a&gt;&lt;br&#x2F;&gt;如果以上链接无法点击，请将它复制到你的浏览器地址栏中进入访问，该链接24小时内有效。&lt;br&#x2F;&gt;如果此次激活请求非你本人所发，请忽略本邮件。&lt;br&#x2F;&gt;&lt;p style&#x3D;&#39;text-align:right&#39;&gt;注册&lt;&#x2F;p&gt;&quot;;&#x2F;&#x2F;邮件内容</span><br><span class="line">        $mailtype &#x3D; &quot;HTML&quot;;&#x2F;&#x2F;邮件格式（HTML&#x2F;TXT）,TXT为文本邮件</span><br><span class="line">        &#x2F;&#x2F;************************ 配置信息 ****************************</span><br><span class="line">        $smtp &#x3D; new Smtp($smtpserver,$smtpserverport,true,$smtpuser,$smtppass);&#x2F;&#x2F;这里面的一个true是表示使用身份验证,否则不使用身份验证.</span><br><span class="line">        $smtp-&gt;debug &#x3D; false;&#x2F;&#x2F;是否显示发送的调试信息</span><br><span class="line">        $state &#x3D; $smtp-&gt;sendmail($smtpemailto, $smtpusermail, $mailtitle, $mailcontent, $mailtype);</span><br><span class="line">    </span><br><span class="line">        echo &quot;&lt;div style&#x3D;&#39;width:300px; margin:36px auto;&#39;&gt;&quot;;</span><br><span class="line">        if($state&#x3D;&#x3D;&quot;&quot;)&#123;</span><br><span class="line">            echo &quot;对不起，邮件发送失败！请检查邮箱填写是否有误。&quot;;</span><br><span class="line">            echo &quot;&lt;a href&#x3D;&#39;index.html&#39;&gt;点此返回&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">            exit();</span><br><span class="line">        &#125;</span><br><span class="line">        echo &quot;恭喜！注册成功！请登录邮箱即使激活账号，若未收到邮件，请查看垃圾邮件&quot;;</span><br><span class="line">        echo &quot;&lt;a href&#x3D;&#39;index.html&#39;&gt;点此返回&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;&#x2F;div&gt;&quot;;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="注意">注意</span></h4><ul>
<li>这里使用本地apache服务器</li>
<li>163邮箱开启SMTP需要设置授权码，密码使用授权码</li>
</ul>
<h3><span id="smtpclassphp">Smtp.class.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * email smtp （support php7）</span><br><span class="line"> *</span><br><span class="line"> * Modified by: Reson 2017&#x2F;06</span><br><span class="line"> * UPDATE:</span><br><span class="line"> * 1、change ereg to preg_match；change ereg_replace to preg_replace.</span><br><span class="line"> * 2、change var to public&#x2F;private.</span><br><span class="line"> *</span><br><span class="line"> * </span><br><span class="line"> *</span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Smtp</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* Public Variables *&#x2F;</span><br><span class="line">    public $smtp_port;</span><br><span class="line"></span><br><span class="line">    public $time_out;</span><br><span class="line"></span><br><span class="line">    public $host_name;</span><br><span class="line"></span><br><span class="line">    public $log_file;</span><br><span class="line"></span><br><span class="line">    public $relay_host;</span><br><span class="line"></span><br><span class="line">    public $debug;</span><br><span class="line"></span><br><span class="line">    public $auth;</span><br><span class="line"></span><br><span class="line">    public $user;</span><br><span class="line"></span><br><span class="line">    public $pass;</span><br><span class="line"></span><br><span class="line">    &#x2F;* Private Variables *&#x2F;</span><br><span class="line">    private $sock;</span><br><span class="line"></span><br><span class="line">    &#x2F;* Constractor *&#x2F;</span><br><span class="line">    function __construct($relay_host &#x3D; &quot;&quot;, $smtp_port &#x3D; 25,$auth &#x3D; false,$user,$pass)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;debug &#x3D; FALSE;</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_port &#x3D; $smtp_port;</span><br><span class="line"></span><br><span class="line">        $this-&gt;relay_host &#x3D; $relay_host;</span><br><span class="line"></span><br><span class="line">        $this-&gt;time_out &#x3D; 30; &#x2F;&#x2F;is used in fsockopen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        $this-&gt;auth &#x3D; $auth;&#x2F;&#x2F;auth</span><br><span class="line"></span><br><span class="line">        $this-&gt;user &#x3D; $user;</span><br><span class="line"></span><br><span class="line">        $this-&gt;pass &#x3D; $pass;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        $this-&gt;host_name &#x3D; &quot;localhost&quot;; &#x2F;&#x2F;is used in HELO command</span><br><span class="line">        $this-&gt;log_file &#x3D; &quot;&quot;;</span><br><span class="line"></span><br><span class="line">        $this-&gt;sock &#x3D; FALSE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;* Main Function *&#x2F;</span><br><span class="line"></span><br><span class="line">    function sendmail($to, $from, $subject &#x3D; &quot;&quot;, $body &#x3D; &quot;&quot;, $mailtype, $cc &#x3D; &quot;&quot;, $bcc &#x3D; &quot;&quot;, $additional_headers &#x3D; &quot;&quot;)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $mail_from &#x3D; $this-&gt;get_address($this-&gt;strip_comment($from));</span><br><span class="line"></span><br><span class="line">        $body &#x3D; preg_replace(&quot;&#x2F;(^|(\r\n))(\.)&#x2F;&quot;, &quot;\1.\3&quot;, $body);</span><br><span class="line"></span><br><span class="line">        $header &#x3D; &quot;MIME-Version:1.0\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        if($mailtype&#x3D;&#x3D;&quot;HTML&quot;)&#123;</span><br><span class="line"></span><br><span class="line">            $header .&#x3D; &quot;Content-Type:text&#x2F;html\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;To: &quot;.$to.&quot;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        if ($cc !&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            $header .&#x3D; &quot;Cc: &quot;.$cc.&quot;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;From: $from&lt;&quot;.$from.&quot;&gt;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;Subject: &quot;.$subject.&quot;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; $additional_headers;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;Date: &quot;.date(&quot;r&quot;).&quot;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;X-Mailer:By Redhat (PHP&#x2F;&quot;.phpversion().&quot;)\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        list($msec, $sec) &#x3D; explode(&quot; &quot;, microtime());</span><br><span class="line"></span><br><span class="line">        $header .&#x3D; &quot;Message-ID: &lt;&quot;.date(&quot;YmdHis&quot;, $sec).&quot;.&quot;.($msec*1000000).&quot;.&quot;.$mail_from.&quot;&gt;\r\n&quot;;</span><br><span class="line"></span><br><span class="line">        $TO &#x3D; explode(&quot;,&quot;, $this-&gt;strip_comment($to));</span><br><span class="line"></span><br><span class="line">        if ($cc !&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            $TO &#x3D; array_merge($TO, explode(&quot;,&quot;, $this-&gt;strip_comment($cc)));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if ($bcc !&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            $TO &#x3D; array_merge($TO, explode(&quot;,&quot;, $this-&gt;strip_comment($bcc)));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $sent &#x3D; TRUE;</span><br><span class="line"></span><br><span class="line">        foreach ($TO as $rcpt_to) &#123;</span><br><span class="line"></span><br><span class="line">            $rcpt_to &#x3D; $this-&gt;get_address($rcpt_to);</span><br><span class="line"></span><br><span class="line">            if (!$this-&gt;smtp_sockopen($rcpt_to)) &#123;</span><br><span class="line"></span><br><span class="line">                $this-&gt;log_write(&quot;Error: Cannot send email to &quot;.$rcpt_to.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">                $sent &#x3D; FALSE;</span><br><span class="line"></span><br><span class="line">                continue;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if ($this-&gt;smtp_send($this-&gt;host_name, $mail_from, $rcpt_to, $header, $body)) &#123;</span><br><span class="line"></span><br><span class="line">                $this-&gt;log_write(&quot;E-mail has been sent to &lt;&quot;.$rcpt_to.&quot;&gt;\n&quot;);</span><br><span class="line"></span><br><span class="line">            &#125; else &#123;</span><br><span class="line"></span><br><span class="line">                $this-&gt;log_write(&quot;Error: Cannot send email to &lt;&quot;.$rcpt_to.&quot;&gt;\n&quot;);</span><br><span class="line"></span><br><span class="line">                $sent &#x3D; FALSE;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            fclose($this-&gt;sock);</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Disconnected from remote host\n&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $sent;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;* Private Functions *&#x2F;</span><br><span class="line"></span><br><span class="line">    function smtp_send($helo, $from, $to, $header, $body &#x3D; &quot;&quot;)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_putcmd(&quot;HELO&quot;, $helo)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending HELO command&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;auth</span><br><span class="line">        if($this-&gt;auth)&#123;</span><br><span class="line"></span><br><span class="line">            if (!$this-&gt;smtp_putcmd(&quot;AUTH LOGIN&quot;, base64_encode($this-&gt;user))) &#123;</span><br><span class="line"></span><br><span class="line">                return $this-&gt;smtp_error(&quot;sending HELO command&quot;);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (!$this-&gt;smtp_putcmd(&quot;&quot;, base64_encode($this-&gt;pass))) &#123;</span><br><span class="line"></span><br><span class="line">                return $this-&gt;smtp_error(&quot;sending HELO command&quot;);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_putcmd(&quot;MAIL&quot;, &quot;FROM:&lt;&quot;.$from.&quot;&gt;&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending MAIL FROM command&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_putcmd(&quot;RCPT&quot;, &quot;TO:&lt;&quot;.$to.&quot;&gt;&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending RCPT TO command&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_putcmd(&quot;DATA&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending DATA command&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_message($header, $body)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending message&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_eom()) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt; [EOM]&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!$this-&gt;smtp_putcmd(&quot;QUIT&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_error(&quot;sending QUIT command&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return TRUE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_sockopen($address)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if ($this-&gt;relay_host &#x3D;&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_sockopen_mx($address);</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line"></span><br><span class="line">            return $this-&gt;smtp_sockopen_relay();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_sockopen_relay()</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $this-&gt;log_write(&quot;Trying to &quot;.$this-&gt;relay_host.&quot;:&quot;.$this-&gt;smtp_port.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">        $this-&gt;sock &#x3D; @fsockopen($this-&gt;relay_host, $this-&gt;smtp_port, $errno, $errstr, $this-&gt;time_out);</span><br><span class="line"></span><br><span class="line">        if (!($this-&gt;sock &amp;&amp; $this-&gt;smtp_ok())) &#123;</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Error: Cannot connenct to relay host &quot;.$this-&gt;relay_host.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Error: &quot;.$errstr.&quot; (&quot;.$errno.&quot;)\n&quot;);</span><br><span class="line"></span><br><span class="line">            return FALSE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $this-&gt;log_write(&quot;Connected to relay host &quot;.$this-&gt;relay_host.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">        return TRUE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_sockopen_mx($address)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $domain &#x3D; preg_replace(&quot;&#x2F;^.+@([^@]+)$&#x2F;&quot;, &quot;\1&quot;, $address);</span><br><span class="line"></span><br><span class="line">        if (!@getmxrr($domain, $MXHOSTS)) &#123;</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Error: Cannot resolve MX \&quot;&quot;.$domain.&quot;\&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            return FALSE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        foreach ($MXHOSTS as $host) &#123;</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Trying to &quot;.$host.&quot;:&quot;.$this-&gt;smtp_port.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            $this-&gt;sock &#x3D; @fsockopen($host, $this-&gt;smtp_port, $errno, $errstr, $this-&gt;time_out);</span><br><span class="line"></span><br><span class="line">            if (!($this-&gt;sock &amp;&amp; $this-&gt;smtp_ok())) &#123;</span><br><span class="line"></span><br><span class="line">                $this-&gt;log_write(&quot;Warning: Cannot connect to mx host &quot;.$host.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">                $this-&gt;log_write(&quot;Error: &quot;.$errstr.&quot; (&quot;.$errno.&quot;)\n&quot;);</span><br><span class="line"></span><br><span class="line">                continue;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Connected to mx host &quot;.$host.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            return TRUE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $this-&gt;log_write(&quot;Error: Cannot connect to any mx hosts (&quot;.implode(&quot;, &quot;, $MXHOSTS).&quot;)\n&quot;);</span><br><span class="line"></span><br><span class="line">        return FALSE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_message($header, $body)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        fputs($this-&gt;sock, $header.&quot;\r\n&quot;.$body);</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_debug(&quot;&gt; &quot;.str_replace(&quot;\r\n&quot;, &quot;\n&quot;.&quot;&gt; &quot;, $header.&quot;\n&gt; &quot;.$body.&quot;\n&gt; &quot;));</span><br><span class="line"></span><br><span class="line">        return TRUE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_eom()</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        fputs($this-&gt;sock, &quot;\r\n.\r\n&quot;);</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_debug(&quot;. [EOM]\n&quot;);</span><br><span class="line"></span><br><span class="line">        return $this-&gt;smtp_ok();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_ok()</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $response &#x3D; str_replace(&quot;\r\n&quot;, &quot;&quot;, fgets($this-&gt;sock, 512));</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_debug($response.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">        if (!preg_match(&quot;&#x2F;^[23]&#x2F;&quot;, $response)) &#123;</span><br><span class="line"></span><br><span class="line">            fputs($this-&gt;sock, &quot;QUIT\r\n&quot;);</span><br><span class="line"></span><br><span class="line">            fgets($this-&gt;sock, 512);</span><br><span class="line"></span><br><span class="line">            $this-&gt;log_write(&quot;Error: Remote host returned \&quot;&quot;.$response.&quot;\&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            return FALSE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return TRUE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_putcmd($cmd, $arg &#x3D; &quot;&quot;)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if ($arg !&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            if($cmd&#x3D;&#x3D;&quot;&quot;) $cmd &#x3D; $arg;</span><br><span class="line"></span><br><span class="line">            else $cmd &#x3D; $cmd.&quot; &quot;.$arg;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fputs($this-&gt;sock, $cmd.&quot;\r\n&quot;);</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_debug(&quot;&gt; &quot;.$cmd.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">        return $this-&gt;smtp_ok();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_error($string)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $this-&gt;log_write(&quot;Error: Error occurred while &quot;.$string.&quot;.\n&quot;);</span><br><span class="line"></span><br><span class="line">        return FALSE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function log_write($message)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $this-&gt;smtp_debug($message);</span><br><span class="line"></span><br><span class="line">        if ($this-&gt;log_file &#x3D;&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            return TRUE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $message &#x3D; date(&quot;M d H:i:s &quot;).get_current_user().&quot;[&quot;.getmypid().&quot;]: &quot;.$message;</span><br><span class="line"></span><br><span class="line">        if (!@file_exists($this-&gt;log_file) || !($fp &#x3D; @fopen($this-&gt;log_file, &quot;a&quot;))) &#123;</span><br><span class="line"></span><br><span class="line">            $this-&gt;smtp_debug(&quot;Warning: Cannot open log file \&quot;&quot;.$this-&gt;log_file.&quot;\&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">            return FALSE;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        flock($fp, LOCK_EX);</span><br><span class="line"></span><br><span class="line">        fputs($fp, $message);</span><br><span class="line"></span><br><span class="line">        fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        return TRUE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function strip_comment($address)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $comment &#x3D; &quot;&#x2F;\([^()]*\)&#x2F;&quot;;</span><br><span class="line"></span><br><span class="line">        while (preg_match($comment, $address)) &#123;</span><br><span class="line"></span><br><span class="line">            $address &#x3D; preg_replace($comment, &quot;&quot;, $address);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $address;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function get_address($address)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $address &#x3D; preg_replace(&quot;&#x2F;([ \t\r\n])+&#x2F;&quot;, &quot;&quot;, $address);</span><br><span class="line"></span><br><span class="line">        $address &#x3D; preg_replace(&quot;&#x2F;^.*&lt;(.+)&gt;.*$&#x2F;&quot;, &quot;\1&quot;, $address);</span><br><span class="line"></span><br><span class="line">        return $address;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function smtp_debug($message)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if ($this-&gt;debug) &#123;</span><br><span class="line"></span><br><span class="line">            echo $message;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3><span id="activephp">active.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;.&#x2F;sql.php&#39;;</span><br><span class="line">&#x2F;&#x2F; 连接</span><br><span class="line">$conn &#x3D; new mysqli($server, $user, $password, $dbname);</span><br><span class="line">if($conn-&gt;connect_error)&#123;</span><br><span class="line">    die(&quot;连接失败&quot; . $conn-&gt;connect_error);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">$conn-&gt;query(&quot;set names utf8&quot;);</span><br><span class="line"></span><br><span class="line">$verify &#x3D; stripslashes(trim($_GET[&#39;verify&#39;]));</span><br><span class="line">$nowtime &#x3D; time();</span><br><span class="line">$sql &#x3D; &quot;SELECT id,token_exptime FROM sys_students WHERE status&#x3D;0 AND token&#x3D;&#39;$verify&#39;&quot;;</span><br><span class="line">$result &#x3D; $conn-&gt;query($sql);</span><br><span class="line">$row &#x3D; $result-&gt;fetch_assoc();</span><br><span class="line"></span><br><span class="line">if ($row) &#123;</span><br><span class="line">	if ($nowtime &gt; $row[&#39;token_exptime&#39;]) &#123; </span><br><span class="line">        echo &quot;&lt;script&gt;</span><br><span class="line">                alert(&#39;您的激活有效期已过，请登录您的帐号重新发送激活邮件&#39;);</span><br><span class="line">        &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">    &#125; </span><br><span class="line">    else &#123;</span><br><span class="line">        $sql_update &#x3D; &quot;UPDATE sys_students SET active_status&#x3D;1 WHERE id&#x3D;&quot; . $row[&#39;id&#39;];</span><br><span class="line">        $result_update &#x3D; $conn-&gt;query($sql_update);</span><br><span class="line">        if ($result_update) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;</span><br><span class="line">            alert(&#39;激活成功！&#39;);</span><br><span class="line">            &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            </span><br><span class="line">        &#125; </span><br><span class="line">        else &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;</span><br><span class="line">            alert(&#39;服务器忙！&#39;);</span><br><span class="line">            &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;&lt;script&gt;</span><br><span class="line">            alert(&#39;error&#39;);</span><br><span class="line">    &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="参考链接">参考链接</span></h3><p><a href="https://www.cnblogs.com/linksgo2011/archive/2013/04/23/3037429.html" target="_blank" rel="noopener external nofollow noreferrer">php 邮箱验证原理</a></p>
<p><a href="https://www.moquit.com/1520.html" target="_blank" rel="noopener external nofollow noreferrer">PHP用户注册邮箱验证激活帐号</a></p>
<p><a href="https://segmentfault.com/a/1190000014789528" target="_blank" rel="noopener external nofollow noreferrer">用phpmail发送邮件，简单实现php发邮件功能！</a></p>
]]></content>
      <tags>
        <tag>php 邮箱验证</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建IPSec VPN 虚拟局域网</title>
    <url>/2019-11-12-ipsec-vpn-xu-ni-ju-yu-wang-da-jian.html</url>
    <content><![CDATA[<p>环境: </p>
<ul>
<li>服务器：阿里云 ubuntu</li>
<li>客户端：其他设备</li>
</ul>
<a id="more"></a>

<h3><span id="服务端">服务端</span></h3><p>参考github: <a href="https://github.com/hwdsl2/setup-ipsec-vpn/blob/master/README-zh.md" target="_blank" rel="noopener external nofollow noreferrer">IPsec VPN 服务器一键安装脚本</a></p>
<h3><span id="客户端">客户端</span></h3><ul>
<li>win10</li>
</ul>
<p>所有问题都能在此找到：<br><a href="https://github.com/hwdsl2/setup-ipsec-vpn/blob/master/docs/clients-zh.md#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4" target="_blank" rel="noopener external nofollow noreferrer">配置 IPsec/L2TP VPN 客户端</a></p>
<h4><span id="网络设置里新建vpn">网络设置里新建VPN</span></h4><p>如下界面进行配置：</p>
<p><img src="/assets/images/IPSec/1.png" alt="图片"></p>
<h4><span id="点击新建的vpn进行连接">点击新建的vpn进行连接</span></h4><p>未成功连接时，使用以下方法</p>
<h4><span id="查看服务">查看服务</span></h4><p><a href="https://www.tp-link.com/en/support/faq/1029/" target="_blank" rel="noopener external nofollow noreferrer">查看服务是否启动</a></p>
<h4><span id="注册表里添加">注册表里添加</span></h4><p>方法：使用管理员打开CMD</p>
<p>输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Services\PolicyAgent &#x2F;v AssumeUDPEncapsulationContextOnSendRule &#x2F;t REG_DWORD &#x2F;d 0x2 &#x2F;f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Services\RasMan\Parameters &#x2F;v ProhibitIpSec &#x2F;t REG_DWORD &#x2F;d 0x0 &#x2F;f</span><br></pre></td></tr></table></figure>
<p>CMD提示操作完成</p>
<p>重启计算机</p>
<h4><span id="连接后无法使用网络的问题">连接后无法使用网络的问题</span></h4><p><img src="/assets/images/IPSec/2.png" alt="图片"></p>
<p><img src="/assets/images/IPSec/3.png" alt="图片"></p>
<h4><span id="客户端在同一局域网无法ping通">客户端在同一局域网无法ping通</span></h4><p>关闭本地防火墙</p>
]]></content>
      <tags>
        <tag>VPN IPSec 虚拟局域网</tag>
      </tags>
  </entry>
  <entry>
    <title>arcEngine C# 独立的地理信息系统程序 计算点坐标、线长、面积</title>
    <url>/2019-09-23-cshape-du-li-de-di-li-xin-xi-xi-tong-cheng-xu.html</url>
    <content><![CDATA[<p>功能说明：</p>
<ul>
<li>计算面的面积、线的长度、点的坐标</li>
<li>保存在新建的字段</li>
<li>将功能封装为几个函数</li>
<li>函数包括：</li>
<li>AddField() 添加字段</li>
<li>calcArea() 计算面积</li>
<li>calcLine() 计算线长</li>
<li>calcXY() 计算点坐标</li>
</ul>
<h3><span id="独立的地理信息系统程序">独立的地理信息系统程序</span></h3><ul>
<li>建立窗体应用程序</li>
<li>添加控件</li>
<li>添加服务代码</li>
<li>新建项classLibrary-&gt;Base Command</li>
</ul>
<h4><span id="command1cs">command1.cs</span></h4><ul>
<li>主要在public command1(){}</li>
<li>OnClick(){}</li>
<li>新建的其他函数</li>
</ul>
<a id="more"></a>

<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.ADF.BaseClasses;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.ADF.CATIDs;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Controls;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.ArcMapUI;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Geodatabase;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Carto;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.ArcMapUI;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Geometry;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Input;</span><br><span class="line"><span class="keyword">using</span> GISApp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ArcMapClassLibrary1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Command that works in ArcMap/Map/PageLayout</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">Guid(<span class="meta-string">"b31d8a09-03b3-4587-a69e-5944625f7f15"</span>)</span>]</span><br><span class="line">    [<span class="meta">ClassInterface(ClassInterfaceType.None)</span>]</span><br><span class="line">    [<span class="meta">ProgId(<span class="meta-string">"ArcMapClassLibrary1.Command1"</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">Command1</span> : <span class="title">BaseCommand</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> COM Registration Function(s)</span></span><br><span class="line">        [<span class="meta">ComRegisterFunction()</span>]</span><br><span class="line">        [<span class="meta">ComVisible(false)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RegisterFunction</span>(<span class="params">Type registerType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// Required for ArcGIS Component Category Registrar support</span></span><br><span class="line">            ArcGISCategoryRegistration(registerType);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Add any COM registration code here</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">ComUnregisterFunction()</span>]</span><br><span class="line">        [<span class="meta">ComVisible(false)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UnregisterFunction</span>(<span class="params">Type registerType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// Required for ArcGIS Component Category Registrar support</span></span><br><span class="line">            ArcGISCategoryUnregistration(registerType);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Add any COM unregistration code here</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ArcGIS Component Category Registrar generated code</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Required method for ArcGIS Component Category registration -</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Do not modify the contents of this method with the code editor.</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ArcGISCategoryRegistration</span>(<span class="params">Type registerType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> regKey = <span class="keyword">string</span>.Format(<span class="string">"HKEY_CLASSES_ROOT\\CLSID\\&#123;&#123;&#123;0&#125;&#125;&#125;"</span>, registerType.GUID);</span><br><span class="line">            MxCommands.Register(regKey);</span><br><span class="line">            ControlsCommands.Register(regKey);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Required method for ArcGIS Component Category unregistration -</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Do not modify the contents of this method with the code editor.</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ArcGISCategoryUnregistration</span>(<span class="params">Type registerType</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> regKey = <span class="keyword">string</span>.Format(<span class="string">"HKEY_CLASSES_ROOT\\CLSID\\&#123;&#123;&#123;0&#125;&#125;&#125;"</span>, registerType.GUID);</span><br><span class="line">            MxCommands.Unregister(regKey);</span><br><span class="line">            ControlsCommands.Unregister(regKey);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> IHookHelper m_hookHelper = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Command1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Define values for the public properties</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="keyword">base</span>.m_category = <span class="string">"GISAPP"</span>; <span class="comment">//localizable text</span></span><br><span class="line">            <span class="keyword">base</span>.m_caption = <span class="string">"家乡数据处理"</span>;  <span class="comment">//localizable text </span></span><br><span class="line">            <span class="keyword">base</span>.m_message = <span class="string">"家乡数据处理"</span>;  <span class="comment">//localizable text</span></span><br><span class="line">            <span class="keyword">base</span>.m_toolTip = <span class="string">"家乡数据处理，面图层计算面积，线图层计算长度与弯曲度，点图层计算经纬度坐标"</span>;  <span class="comment">//localizable text</span></span><br><span class="line">            <span class="keyword">base</span>.m_name = <span class="string">""</span>;   <span class="comment">//unique id, non-localizable (e.g. "MyCategory_MyCommand")</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> change bitmap name if necessary</span></span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">                <span class="keyword">string</span> bitmapResourceName = GetType().Name + <span class="string">".bmp"</span>;</span><br><span class="line">                <span class="keyword">base</span>.m_bitmap = <span class="keyword">new</span> Bitmap(GetType(), bitmapResourceName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                System.Diagnostics.Trace.WriteLine(ex.Message, <span class="string">"Invalid Bitmap"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> Overridden Class Methods</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Occurs when this command is created</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="hook"&gt;</span>Instance of the application<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnCreate</span>(<span class="params"><span class="keyword">object</span> hook</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (hook == <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                m_hookHelper = <span class="keyword">new</span> HookHelperClass();</span><br><span class="line">                m_hookHelper.Hook = hook;</span><br><span class="line">                <span class="keyword">if</span> (m_hookHelper.ActiveView == <span class="literal">null</span>)</span><br><span class="line">                    m_hookHelper = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span></span><br><span class="line">            &#123;</span><br><span class="line">                m_hookHelper = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (m_hookHelper == <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">base</span>.m_enabled = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">base</span>.m_enabled = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span>  Add other initialization code</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Occurs when this command is clicked</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnClick</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Add Command1.OnClick implementation</span></span><br><span class="line">            <span class="comment">//MessageBox.Show("ok");</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取当前地图</span></span><br><span class="line">            IMap pMap = m_hookHelper.FocusMap;</span><br><span class="line">            <span class="comment">// 获取地图中第一个图层</span></span><br><span class="line">            ILayer pLyr = pMap.get_Layer(<span class="number">0</span>);</span><br><span class="line">            IFeatureLayer pFeatLyr = pLyr <span class="keyword">as</span> IFeatureLayer; <span class="comment">//QI</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取表</span></span><br><span class="line">            IFeatureClass pFeatCls = pFeatLyr.FeatureClass;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 面图层计算面积 //</span></span><br><span class="line">            <span class="keyword">if</span>(esriGeometryType.esriGeometryPolygon == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 添加字段，调用建立字段方法</span></span><br><span class="line">                addField(pFeatCls, <span class="string">"VS_area"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 调用计算面积方法</span></span><br><span class="line">                calcArea(pFeatCls);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 线图层计算线长 //</span></span><br><span class="line">            <span class="keyword">if</span>(esriGeometryType.esriGeometryPolyline == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 添加线长字段，调用新建字段方法</span></span><br><span class="line">                addField(pFeatCls, <span class="string">"VS_length"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 调用计算线长方法</span></span><br><span class="line">                calcLine(pFeatCls);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 点图层计算经纬度坐标 //</span></span><br><span class="line">            <span class="keyword">if</span>(esriGeometryType.esriGeometryPoint == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 添加经纬度坐标字段</span></span><br><span class="line">                addField(pFeatCls, <span class="string">"VS_X"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line">                addField(pFeatCls, <span class="string">"VS_Y"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 计算点，调用计算点的方法</span></span><br><span class="line">                calcXY(pFeatCls);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 添加字段的方法/////////////////////////////</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addField</span>(<span class="params">IFeatureClass pFeatCls, String fldName, esriFieldType fldType</span>) </span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// 判断需要新建的字段是否已经存在</span></span><br><span class="line">            <span class="keyword">if</span> (pFeatCls.FindField(fldName) != <span class="number">-1</span>) <span class="comment">// 字段已经存在</span></span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(<span class="string">"需要新建的字段已存在，将使用存在字段保存计算结果!"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">// 字段不存在</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 创建字段变量，并添加name与type</span></span><br><span class="line">                IFieldEdit pFieldEdit = <span class="keyword">new</span> FieldClass();</span><br><span class="line">                pFieldEdit.Name_2 = fldName;</span><br><span class="line">                pFieldEdit.Type_2 = fldType;</span><br><span class="line">                <span class="comment">// 添加字段</span></span><br><span class="line">                pFeatCls.AddField(pFieldEdit);</span><br><span class="line">            &#125;</span><br><span class="line">               </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算面积的方法////////////////////////////////</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calcArea</span>(<span class="params">IFeatureClass pFeatCls</span>) </span></span><br><span class="line"><span class="function"></span>        &#123; </span><br><span class="line">            <span class="comment">// 面积字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idAreaFld = pFeatCls.FindField(<span class="string">"VS_area"</span>);</span><br><span class="line">            <span class="comment">// NAME字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idNameFld = pFeatCls.FindField(<span class="string">"NAME"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取游标</span></span><br><span class="line">            IFeatureCursor pCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            IPolygon pPlg;</span><br><span class="line">            IArea pArea;</span><br><span class="line">            <span class="keyword">string</span> s = <span class="string">""</span>; <span class="comment">// 计算结果字符串</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取表中要素</span></span><br><span class="line">            IFeature pFeat = pCur.NextFeature();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(pFeat != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pPlg = pFeat.Shape <span class="keyword">as</span> IPolygon;</span><br><span class="line">                pArea = pPlg <span class="keyword">as</span> IArea; <span class="comment">//QI</span></span><br><span class="line"></span><br><span class="line">                s = s + <span class="string">"NAME:"</span> + pFeat.get_Value(idNameFld) + <span class="string">" 面积:"</span> </span><br><span class="line">                    + Convert.ToString(pArea.Area) + <span class="string">"\n"</span>;   <span class="comment">// 计算结果保存为字符串</span></span><br><span class="line"></span><br><span class="line">                pFeat.set_Value(idAreaFld, pArea.Area); <span class="comment">// 面积赋值给字段</span></span><br><span class="line"></span><br><span class="line">                pCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line"></span><br><span class="line">                pFeat = pCur.NextFeature(); <span class="comment">// 循环变量</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            MessageBox.Show(s);</span><br><span class="line">            MessageBox.Show(<span class="string">"计算面积成功！"</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 线图层计算线长方法//////////////////////////</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calcLine</span>(<span class="params">IFeatureClass pFeatCls</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 获取游标</span></span><br><span class="line">            IFeatureCursor pFeatCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="comment">// 获取feature</span></span><br><span class="line">            IFeature pFeat = pFeatCur.NextFeature();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取线长字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idLenFld = pFeatCls.FindField(<span class="string">"VS_length"</span>);</span><br><span class="line">            <span class="comment">// 获取弯曲度字段索引</span></span><br><span class="line">            <span class="comment">//int idWqdFld = pFeatCls.FindField("VS_WQD");</span></span><br><span class="line">            <span class="comment">// NAME字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idNameFld = pFeatCls.FindField(<span class="string">"NAME"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> s = <span class="string">""</span>; <span class="comment">// 结果字符串</span></span><br><span class="line"></span><br><span class="line">            IPolyline pPline;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(pFeat != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pPline = pFeat.Shape <span class="keyword">as</span> IPolyline;</span><br><span class="line"></span><br><span class="line">                pFeat.set_Value(idLenFld, pPline.Length); <span class="comment">// 给长度字段赋值</span></span><br><span class="line"></span><br><span class="line">                s = s + <span class="string">"NAME:"</span> + pFeat.get_Value(idNameFld) + <span class="string">" 长度:"</span> </span><br><span class="line">                    + Convert.ToString(pPline.Length) + <span class="string">"\n"</span>;</span><br><span class="line">                </span><br><span class="line">                pFeatCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line"></span><br><span class="line">                pFeat = pFeatCur.NextFeature(); <span class="comment">// 循环字段</span></span><br><span class="line">            &#125;</span><br><span class="line">            MessageBox.Show(s);</span><br><span class="line">            MessageBox.Show(<span class="string">"计算线长成功!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算点经纬度坐标的方法 ///////////////////////////////</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">calcXY</span>(<span class="params">IFeatureClass pFeatCls</span>) </span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// 获取游标</span></span><br><span class="line">            IFeatureCursor pFeatCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="comment">// 获取feature</span></span><br><span class="line">            IFeature pFeat = pFeatCur.NextFeature();</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 获取经纬度坐标字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idXFld = pFeatCls.FindField(<span class="string">"VS_X"</span>);</span><br><span class="line">            <span class="keyword">int</span> idYFld = pFeatCls.FindField(<span class="string">"VS_Y"</span>);</span><br><span class="line">            <span class="comment">// NAME字段索引</span></span><br><span class="line">            <span class="keyword">int</span> idNameFld = pFeatCls.FindField(<span class="string">"NAME"</span>);</span><br><span class="line"></span><br><span class="line">            IPoint pPnt;</span><br><span class="line">            <span class="keyword">string</span> s = <span class="string">""</span>; <span class="comment">// 打印结果字符串</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(pFeat != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pPnt = pFeat.Shape <span class="keyword">as</span> IPoint;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 给经纬度坐标字段赋值</span></span><br><span class="line">                pFeat.set_Value(idXFld, pPnt.X);</span><br><span class="line">                pFeat.set_Value(idYFld, pPnt.Y);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 结果字符串赋值</span></span><br><span class="line">                s = s + <span class="string">"NAME:"</span> + pFeat.get_Value(idNameFld) + <span class="string">" X:"</span></span><br><span class="line">                    + Convert.ToString(pPnt.X) + <span class="string">" Y:"</span> + Convert.ToString(pPnt.Y) + <span class="string">"\n"</span>; </span><br><span class="line"></span><br><span class="line">                pFeatCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line">                pFeat = pFeatCur.NextFeature(); <span class="comment">// 循环字段</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            MessageBox.Show(s);</span><br><span class="line">            MessageBox.Show(<span class="string">"计算点坐标成功!"</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine VS</tag>
      </tags>
  </entry>
  <entry>
    <title>arcEngine 计算点坐标、线长、面积</title>
    <url>/2019-09-23-cshape-arcengine-addin.html</url>
    <content><![CDATA[<ul>
<li>VS新建addin</li>
</ul>
<p>功能：</p>
<ul>
<li>C# 获取当前文档地图图层</li>
<li>添加字段, 计算面图层的面积</li>
<li>添加字段，计算线图层的长度</li>
<li>添加字段，计算点图层的经纬度</li>
</ul>
<a id="more"></a>

<h3><span id="addin-xxxcs文件">addin         xxx.cs文件</span></h3><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Geodatabase;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Carto;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.ArcMapUI;</span><br><span class="line"><span class="keyword">using</span> ESRI.ArcGIS.Geometry;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">calcArea</span></span><br><span class="line">&#123;</span><br><span class="line">    public class calcArea : ESRI.ArcGIS.Desktop.AddIns.Button</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 在C#中类有三种，</span></span><br><span class="line">        <span class="comment">// 抽象类(无构造函数，不能创建新的对象，用于创建新的类、</span></span><br><span class="line">        <span class="comment">// com类(组件类) 用于创建新的对象的类，可用new生成，所以必须有构造函数</span></span><br><span class="line">        <span class="comment">// 第三种是普通类，不是抽象类，不能用new创建，是由其他类生成的</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">calcArea</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// FeatureClass是不可创建对象的普通类</span></span><br><span class="line">            <span class="comment">// IFeatureLayer pFeatLyr = new FeatureLayer(); //是可创建的com类，利用new关键字生成新的矢量图层，</span></span><br><span class="line">                                                        <span class="comment">//  是一个对象，用接口操作</span></span><br><span class="line">                   </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">funAddField</span>(<span class="params">IFeatureClass pFeatCls, <span class="keyword">string</span> fldName, esriFieldType fldType</span>) </span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// 添加字段函数 //</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 判断字段是否存在</span></span><br><span class="line">            <span class="keyword">if</span> (pFeatCls.FindField(fldName) != <span class="number">-1</span>) <span class="comment">// 字段已存在</span></span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(<span class="string">"欲创建的字段已存在，使用存在字段计算！！"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">// 字段不存在，创建</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// IFields pFlds = pFeatCls.Fields;</span></span><br><span class="line">                IFieldEdit pFieldEdit = <span class="keyword">new</span> FieldClass();</span><br><span class="line">                pFieldEdit.Name_2 = fldName;</span><br><span class="line">                pFieldEdit.Type_2 = fldType;</span><br><span class="line">                pFieldEdit.Editable_2 = <span class="literal">true</span>;</span><br><span class="line">                pFeatCls.AddField(pFieldEdit); <span class="comment">// 添加字段</span></span><br><span class="line">            &#125;</span><br><span class="line">                       </span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnClick</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">//  <span class="doctag">TODO:</span> Sample code showing how to access button host</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            ArcMap.Application.CurrentTool = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">         功能：计算面图层面积，线图层长度，点图层经纬度坐标</span></span><br><span class="line"><span class="comment">         作者：1985857412@qq.com</span></span><br><span class="line"><span class="comment">         说明：添加字段，计算计算面图层面积，线图层长度，点图层经纬度坐标</span></span><br><span class="line"><span class="comment">         * 操作的是地图文档中第一个图层</span></span><br><span class="line"><span class="comment">         日期：2019/9/23</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">            <span class="comment">// 获取当前地图文档</span></span><br><span class="line">            IMxDocument pDoc = ArcMap.Application.Document <span class="keyword">as</span> IMxDocument;</span><br><span class="line">            IMap pMap = pDoc.ActivatedView.FocusMap; <span class="comment">// 获取地图</span></span><br><span class="line">            ILayer pLyr = pMap.get_Layer(<span class="number">0</span>); <span class="comment">// 获取地图第一个图层</span></span><br><span class="line">            IFeatureLayer pFeatLyr = pLyr <span class="keyword">as</span> IFeatureLayer; <span class="comment">//QI</span></span><br><span class="line">            <span class="comment">//MessageBox.Show(pFeatLyr.Name); 测试打印要素名称</span></span><br><span class="line">            IFeatureClass pFeatCls = pFeatLyr.FeatureClass;</span><br><span class="line"></span><br><span class="line">            IFeatureCursor pFeatCur; <span class="comment">// 游标</span></span><br><span class="line">            IFeature pFeat; <span class="comment">// feature</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> s = <span class="string">""</span>; <span class="comment">// 存储打印字符串</span></span><br><span class="line">                      </span><br><span class="line">            <span class="comment">// 面图层计算面积</span></span><br><span class="line">            <span class="keyword">if</span> (esriGeometryType.esriGeometryPolygon == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 调用函数，添加字段</span></span><br><span class="line">                funAddField(pFeatCls, <span class="string">"addin_area"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                pFeatCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>); <span class="comment">// 获取游标</span></span><br><span class="line">                pFeat = pFeatCur.NextFeature(); <span class="comment">// 获取feature</span></span><br><span class="line">                IPolygon pPlg;  <span class="comment">// polygon对象</span></span><br><span class="line">                IArea pArea;    <span class="comment">// area对象</span></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> nameId = pFeatCls.FindField(<span class="string">"NAME"</span>); <span class="comment">// NAME字段索引</span></span><br><span class="line">                <span class="keyword">int</span> areaId = pFeatCls.FindField(<span class="string">"addin_area"</span>); <span class="comment">// addin_area字段索引</span></span><br><span class="line">                                </span><br><span class="line">                <span class="keyword">while</span> (pFeat != <span class="literal">null</span>) </span><br><span class="line">                &#123;</span><br><span class="line">                    pPlg = pFeat.Shape <span class="keyword">as</span> IPolygon;  <span class="comment">// 赋值</span></span><br><span class="line">                    pArea = pPlg <span class="keyword">as</span> IArea;</span><br><span class="line"></span><br><span class="line">                    pFeat.set_Value(areaId, pArea.Area); <span class="comment">// 面积字段赋值</span></span><br><span class="line"></span><br><span class="line">                    s = s + pFeat.get_Value(nameId) + Convert.ToString(pArea.Area) + <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line">                    pFeatCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line"></span><br><span class="line">                    pFeat = pFeatCur.NextFeature();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                MessageBox.Show(s);</span><br><span class="line">                MessageBox.Show(<span class="string">"计算面积与赋值字段：ok"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 线图层计算长度</span></span><br><span class="line">            <span class="keyword">if</span>(esriGeometryType.esriGeometryPolyline == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 调用函数，添加字段</span></span><br><span class="line">                funAddField(pFeatCls, <span class="string">"addin_len"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                pFeatCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>); <span class="comment">// 获取游标</span></span><br><span class="line">                pFeat = pFeatCur.NextFeature(); <span class="comment">// 获取feature</span></span><br><span class="line"></span><br><span class="line">                IPolyline pPline;  <span class="comment">// 线对象</span></span><br><span class="line">                <span class="keyword">int</span> nameId = pFeatCls.FindField(<span class="string">"NAME"</span>); <span class="comment">// NAME字段索引</span></span><br><span class="line">                <span class="keyword">int</span> lenId = pFeatCls.FindField(<span class="string">"addin_len"</span>); <span class="comment">// addin_len字段索引</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (pFeat != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    pPline = pFeat.Shape <span class="keyword">as</span> IPolyline;  <span class="comment">// 赋值</span></span><br><span class="line">                   </span><br><span class="line"></span><br><span class="line">                    pFeat.set_Value(lenId, pPline.Length); <span class="comment">// 长度字段赋值</span></span><br><span class="line"></span><br><span class="line">                    s = s + pFeat.get_Value(nameId) + Convert.ToString(pPline.Length) + <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line">                    pFeatCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line"></span><br><span class="line">                    pFeat = pFeatCur.NextFeature();</span><br><span class="line">                &#125;</span><br><span class="line">                MessageBox.Show(s);</span><br><span class="line">                MessageBox.Show(<span class="string">"计算长度与赋值字段：ok"</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 点图层计算经纬度坐标</span></span><br><span class="line">            <span class="keyword">if</span> (esriGeometryType.esriGeometryPoint == pFeatCls.ShapeType)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 调用函数，添加x,y字段</span></span><br><span class="line">                funAddField(pFeatCls, <span class="string">"addin_x"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line">                funAddField(pFeatCls, <span class="string">"addin_y"</span>, esriFieldType.esriFieldTypeDouble);</span><br><span class="line"></span><br><span class="line">                pFeatCur = pFeatCls.Update(<span class="literal">null</span>, <span class="literal">false</span>); <span class="comment">// 获取游标</span></span><br><span class="line">                pFeat = pFeatCur.NextFeature(); <span class="comment">// 获取feature</span></span><br><span class="line"></span><br><span class="line">                IPoint pPnt;  <span class="comment">// 点对象</span></span><br><span class="line">                <span class="keyword">int</span> nameId = pFeatCls.FindField(<span class="string">"NAME"</span>); <span class="comment">// NAME字段索引</span></span><br><span class="line">                <span class="keyword">int</span> xId = pFeatCls.FindField(<span class="string">"addin_x"</span>); <span class="comment">// x字段索引</span></span><br><span class="line">                <span class="keyword">int</span> yId = pFeatCls.FindField(<span class="string">"addin_y"</span>); <span class="comment">// y字段索引</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (pFeat != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    pPnt = pFeat.Shape <span class="keyword">as</span> IPoint;  <span class="comment">// 赋值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    pFeat.set_Value(xId, pPnt.X); <span class="comment">// x字段赋值</span></span><br><span class="line">                    pFeat.set_Value(yId, pPnt.Y); <span class="comment">// y字段赋值</span></span><br><span class="line"></span><br><span class="line">                    s = s + pFeat.get_Value(nameId) + <span class="string">"x:"</span> + Convert.ToString(pPnt.X) + <span class="string">" y:"</span> + </span><br><span class="line">                        Convert.ToString(pPnt.Y) + <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line">                    pFeatCur.UpdateFeature(pFeat); <span class="comment">// 更新</span></span><br><span class="line"></span><br><span class="line">                    pFeat = pFeatCur.NextFeature();</span><br><span class="line">                &#125;</span><br><span class="line">                MessageBox.Show(s);</span><br><span class="line">                MessageBox.Show(<span class="string">"计算经纬度与赋值字段：ok"</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">            <span class="comment">//MessageBox.Show("I am hua");</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnUpdate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Enabled = ArcMap.Application != <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>ArcMapEngine VS addin</tag>
      </tags>
  </entry>
  <entry>
    <title>Python 计算面的周长</title>
    <url>/2019-09-19-python-arcpy-ji-suan-mian-de-zhou-chang.html</url>
    <content><![CDATA[<ul>
<li>arcpy</li>
<li>计算面图层周长</li>
</ul>
<a id="more"></a>

<h3><span id="脚本">脚本</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 功能：计算面图层周长</span></span><br><span class="line"><span class="comment"># 作者：inno</span></span><br><span class="line"><span class="comment"># 说明：新建字段，计算面图层的周长</span></span><br><span class="line"><span class="comment"># 日期：2019/9/19</span></span><br><span class="line"><span class="keyword">import</span> arcpy <span class="keyword">as</span> ap</span><br><span class="line"><span class="keyword">import</span> arcpy.mapping <span class="keyword">as</span> mp</span><br><span class="line">mxd = mp.MapDocument(<span class="string">'current'</span>)</span><br><span class="line">df = mp.ListDataFrames(mxd)[<span class="number">0</span>]</span><br><span class="line">lyr = mp.ListLayers(df)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">ap.AddField_management(lyr, <span class="string">"Perimeter1"</span>, <span class="string">"DOUBLE"</span>) <span class="comment"># 新建字段</span></span><br><span class="line">ap.CalculateField_management(lyr, <span class="string">"Perimeter1"</span>, <span class="string">"!shape.length!"</span>, <span class="string">"PYTHON"</span>)</span><br></pre></td></tr></table></figure>

<h3><span id="工具脚本">工具脚本</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 功能：计算面图层周长</span></span><br><span class="line"><span class="comment"># 作者：inno</span></span><br><span class="line"><span class="comment"># 说明：工具脚本，新建字段，计算面图层的周长</span></span><br><span class="line"><span class="comment"># 日期：2019/9/19</span></span><br><span class="line"><span class="keyword">import</span> arcpy <span class="keyword">as</span> ap</span><br><span class="line"><span class="keyword">import</span> arcpy.mapping <span class="keyword">as</span> mp</span><br><span class="line"><span class="comment"># 获取输入</span></span><br><span class="line">lyr = ap.GetParameterAsText(<span class="number">0</span>)</span><br><span class="line">fld = ap.GetParameterAsText(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ap.AddField_management(lyr, fld, <span class="string">"DOUBLE"</span>) <span class="comment"># 新建字段</span></span><br><span class="line"><span class="comment"># 计算周长</span></span><br><span class="line">ap.CalculateField_management(lyr, fld, <span class="string">"!shape.length!"</span>, <span class="string">"PYTHON"</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine arcpy</tag>
      </tags>
  </entry>
  <entry>
    <title>vba ArcMap UI控件  计算要素图层面积</title>
    <url>/2019-09-18-vba-arcmap-ui-kong-jian-ji-suan-dian-zuo-biao.html</url>
    <content><![CDATA[<ul>
<li>计算点坐标</li>
<li>添加两个字段，X和Y，X为经度，Y为纬度</li>
</ul>
<a id="more"></a>

<h3><span id="代码">代码</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Private Sub UIButtonControl3_Click()</span><br><span class="line">&#39;功能：计算点坐标</span><br><span class="line">&#39;作者：inno</span><br><span class="line">&#39;说明：代码实现新建两个字段，X和Y，X为经度，Y为纬度</span><br><span class="line">&#39;日期：2019&#x2F;9&#x2F;18</span><br><span class="line"></span><br><span class="line">&#39;IApplicatin开始</span><br><span class="line">Dim pApp As IApplication</span><br><span class="line">Set pApp &#x3D; Application</span><br><span class="line"></span><br><span class="line">&#39;获取文档 MxDocument</span><br><span class="line">Dim pMxDoc As IMxDocument</span><br><span class="line">Set pMxDoc &#x3D; pApp.Document</span><br><span class="line"></span><br><span class="line">&#39;获取当前地图 IMap</span><br><span class="line">Dim pMap As IMap</span><br><span class="line">Set pMap &#x3D; pMxDoc.FocusMap</span><br><span class="line"></span><br><span class="line">&#39;获取点图层 ILayer</span><br><span class="line">Dim pLayer As ILayer</span><br><span class="line">Set pLayer &#x3D; pMap.Layer(2) &#39;点图层在第三个位置</span><br><span class="line"></span><br><span class="line">&#39;判断图层是否为矢量</span><br><span class="line">If Not TypeOf pLayer Is IFeatureLayer Then</span><br><span class="line">    MsgBox &quot;图层不是矢量，已退出&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39;获取矢量图层 IFeatureLayer</span><br><span class="line">Dim pFeatLyr As IFeatureLayer</span><br><span class="line">Set pFeatLyr &#x3D; pLayer</span><br><span class="line"></span><br><span class="line">&#39;获取表 IFeatureClass</span><br><span class="line">Dim pFeatCls As IFeatureClass</span><br><span class="line">Set pFeatCls &#x3D; pFeatLyr.FeatureClass</span><br><span class="line"></span><br><span class="line">&#39;定义添加的字段名</span><br><span class="line">Dim sXField As String</span><br><span class="line">Dim sYField As String</span><br><span class="line">sXField &#x3D; &quot;X&quot;</span><br><span class="line">sYField &#x3D; &quot;Y&quot;</span><br><span class="line">&#39;判断属性表中是否存在需要创建的字段</span><br><span class="line">If pFeatCls.FindField(sXField) &lt;&gt; -1 Or pFeatCls.FindField(sYField) &lt;&gt; -1 Then</span><br><span class="line">    MsgBox &quot;需要创建的字段已存在，请重试&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line">&#39;创建字段并添加字段属性</span><br><span class="line">Dim xField As IFieldEdit</span><br><span class="line">Dim yField As IFieldEdit</span><br><span class="line">Set xField &#x3D; New Field</span><br><span class="line">Set yField &#x3D; New Field</span><br><span class="line">xField.Name &#x3D; sXField</span><br><span class="line">yField.Name &#x3D; sYField</span><br><span class="line">xField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line">yField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line"></span><br><span class="line">&#39;将字段添加到属性表</span><br><span class="line">pFeatCls.AddField xField &#39;加括号报错</span><br><span class="line">pFeatCls.AddField yField</span><br><span class="line"></span><br><span class="line">&#39;获取cursor IFeatureCursor</span><br><span class="line">Dim pFeatCur As IFeatureCursor</span><br><span class="line">Set pFeatCur &#x3D; pFeatCls.Update(Nothing, False)</span><br><span class="line"></span><br><span class="line">&#39;获取要素 IFeature</span><br><span class="line">Dim pFeat As IFeature</span><br><span class="line">Set pFeat &#x3D; pFeatCur.NextFeature</span><br><span class="line"></span><br><span class="line">Dim pnt As IPoint &#39;IPoint 存储点</span><br><span class="line">Dim s As String &#39;字符串，用于打印</span><br><span class="line">Dim idX As Integer &#39;X字段索引</span><br><span class="line">Dim idY As Integer &#39;Y字段索引</span><br><span class="line">Dim idName As Integer &#39;NAME 字段索引</span><br><span class="line"></span><br><span class="line">&#39;给索引赋值</span><br><span class="line">idX &#x3D; pFeatCls.FindField(sXField)</span><br><span class="line">idY &#x3D; pFeatCls.FindField(sYField)</span><br><span class="line">idName &#x3D; pFeatCls.FindField(&quot;NAME&quot;)</span><br><span class="line"></span><br><span class="line">&#39;循环赋值</span><br><span class="line">Do While Not pFeat Is Nothing</span><br><span class="line">    Set pnt &#x3D; pFeat.Shape</span><br><span class="line">    &#39;为字段赋值</span><br><span class="line">    pFeat.Value(idX) &#x3D; pnt.X</span><br><span class="line">    pFeat.Value(idY) &#x3D; pnt.Y</span><br><span class="line">    pFeatCur.UpdateFeature pFeat &#39;更新每一行</span><br><span class="line">    </span><br><span class="line">    s &#x3D; s + pFeat.Value(idName) + &quot;: X &quot; + Str(pnt.X) + &quot; Y &quot; + Str(pnt.Y) + vbNewLine</span><br><span class="line">    </span><br><span class="line">    Set pFeat &#x3D; pFeatCur.NextFeature &#39;循环</span><br><span class="line">Loop</span><br><span class="line"></span><br><span class="line">MsgBox s</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine vba</tag>
      </tags>
  </entry>
  <entry>
    <title>Python arcpy 计算曲线长度与弯曲度</title>
    <url>/2019-09-18-python-arcpy-ji-suan-qu-xian-chang-du-yu-wan-qu-du.html</url>
    <content><![CDATA[<ul>
<li>arcpy</li>
<li>获取线图层，新建两个字段，将计算得到的曲线长度与弯曲度保存在字段</li>
</ul>
<a id="more"></a>

<h3><span id="脚本">脚本</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 功能：计算曲线长度与弯曲度</span></span><br><span class="line"><span class="comment"># 作者：inno</span></span><br><span class="line"><span class="comment"># 说明：获取线图层，新建两个字段，将计算得到的曲线长度与弯曲度保存在字段</span></span><br><span class="line"><span class="comment"># 日期：2019/9/18</span></span><br><span class="line"><span class="keyword">import</span> arcpy <span class="keyword">as</span> ap</span><br><span class="line"><span class="keyword">import</span> arcpy.mapping <span class="keyword">as</span> mp</span><br><span class="line">mxd = mp.MapDocument(<span class="string">'current'</span>)</span><br><span class="line">df = mp.ListDataFrames(mxd)[<span class="number">0</span>]</span><br><span class="line">lyr = mp.ListLayers(df)[<span class="number">1</span>] <span class="comment"># 此文档线图层在第二个位置 #</span></span><br><span class="line"><span class="comment"># 添加两个字段</span></span><br><span class="line">ap.AddField_management(lyr, <span class="string">"pyLength"</span>, <span class="string">"DOUBLE"</span>)</span><br><span class="line">ap.AddField_management(lyr, <span class="string">"pyWqd"</span>, <span class="string">"DOUBLE"</span>)</span><br><span class="line"><span class="comment"># 获取游标</span></span><br><span class="line">cursor = ap.UpdateCursor(lyr)</span><br><span class="line"><span class="comment"># 遍历表中每一行的要素，并计算赋值</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    line = row.shape <span class="comment"># 获取要素形状</span></span><br><span class="line">    row.setValue(<span class="string">"pyLength"</span>, line.length) <span class="comment"># 曲线长度赋值</span></span><br><span class="line">    fPnt = ap.PointGeometry(line.firstPoint)</span><br><span class="line">    lPnt = ap.PointGeometry(line.lastPoint) <span class="comment"># 获取曲线首末点</span></span><br><span class="line">    dis = fPnt.distanceTo(lPnt) <span class="comment"># 计算两点之间直线距离</span></span><br><span class="line">    row.setValue(<span class="string">"pyWqd"</span>, dis/line.length) <span class="comment"># 弯曲度赋值</span></span><br><span class="line">    cursor.updateRow(row) <span class="comment"># 更新行</span></span><br></pre></td></tr></table></figure>

<h3><span id="工具脚本">工具脚本</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 功能：计算曲线长度与弯曲度</span></span><br><span class="line"><span class="comment"># 作者：inno</span></span><br><span class="line"><span class="comment"># 说明：工具脚本，获取线图层，新建两个字段，将计算得到的曲线长度与弯曲度保存在字段</span></span><br><span class="line"><span class="comment"># 日期：2019/9/18</span></span><br><span class="line"><span class="keyword">import</span> arcpy <span class="keyword">as</span> ap</span><br><span class="line"><span class="keyword">import</span> arcpy.mapping <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">lyr = ap.GetParameterAsText(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 获取要创建的字段名称</span></span><br><span class="line">fldLen = ap.GetParameterAsText(<span class="number">1</span>) </span><br><span class="line">fldWqd = ap.GetParameterAsText(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加两个字段</span></span><br><span class="line">ap.AddField_management(lyr, fldLen, <span class="string">"DOUBLE"</span>)</span><br><span class="line">ap.AddField_management(lyr, fldWqd, <span class="string">"DOUBLE"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取游标</span></span><br><span class="line">cursor = ap.UpdateCursor(lyr)</span><br><span class="line"><span class="comment"># 遍历表中每一行的要素，并计算赋值</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    line = row.shape <span class="comment"># 获取要素形状</span></span><br><span class="line">    row.setValue(fldLen, line.length) <span class="comment"># 曲线长度赋值</span></span><br><span class="line">    fPnt = ap.PointGeometry(line.firstPoint)</span><br><span class="line">    lPnt = ap.PointGeometry(line.lastPoint) <span class="comment"># 获取曲线首末点</span></span><br><span class="line">    dis = fPnt.distanceTo(lPnt) <span class="comment"># 计算两点之间直线距离</span></span><br><span class="line">    row.setValue(fldWqd, dis/line.length) <span class="comment"># 弯曲度赋值</span></span><br><span class="line">    cursor.updateRow(row) <span class="comment"># 更新行</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine arcpy</tag>
      </tags>
  </entry>
  <entry>
    <title>Python arcpy 计算点经纬度坐标</title>
    <url>/2019-09-18-python-arcpy-ji-suan-dian-jing-wei-du-zuo-biao.html</url>
    <content><![CDATA[<ul>
<li>arcpy</li>
</ul>
<a id="more"></a>

<h3><span id="脚本">脚本</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 功能：添加两个字段，计算点的经纬度坐标</span><br><span class="line"># 作者：inno</span><br><span class="line"># 说明：添加两个字段，计算点的经纬度坐标</span><br><span class="line"># 日期：2019&#x2F;9&#x2F;18</span><br><span class="line">import arcpy as ap</span><br><span class="line">import arcpy.mapping as mp</span><br><span class="line">mxd &#x3D; mp.MapDocument(&#39;current&#39;)</span><br><span class="line"></span><br><span class="line">df &#x3D; mp.ListDataFrames(mxd)[0]</span><br><span class="line">lyr &#x3D; mp.ListLayers(df)[2] # 此文档点图层在第三个位置</span><br><span class="line"># 添加两个字段</span><br><span class="line">ap.AddField_management(lyr, &quot;pyX&quot;, &quot;DOUBLE&quot;)</span><br><span class="line">ap.AddField_management(lyr, &quot;pyY&quot;, &quot;DOUBLE&quot;)</span><br><span class="line"># 使用arcpy.da.UpdateCursor() &quot;shape@XY&quot;几何令牌获取经纬度坐标x,y</span><br><span class="line"># [&quot;shape@XY&quot;, &quot;pyX&quot;, &quot;pyY&quot;] 后两个参数是传入的字段</span><br><span class="line">with ap.da.UpdateCursor(lyr, [&quot;shape@XY&quot;, &quot;pyX&quot;, &quot;pyY&quot;]) as cur:</span><br><span class="line">    for row in cur:</span><br><span class="line">        x, y &#x3D; row[0] </span><br><span class="line">        row[1] &#x3D; x        </span><br><span class="line">        row[2] &#x3D; y</span><br><span class="line">        cur.updateRow(row)</span><br></pre></td></tr></table></figure>

<h3><span id="工具脚本">工具脚本</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 功能：添加两个字段，计算点的经纬度坐标</span><br><span class="line"># 作者：inno</span><br><span class="line"># 说明：工具脚本，添加两个字段，计算点的经纬度坐标</span><br><span class="line"># 日期：2019&#x2F;9&#x2F;18</span><br><span class="line">import arcpy as ap</span><br><span class="line">import arcpy.mapping as mp</span><br><span class="line"></span><br><span class="line"># 获取参数</span><br><span class="line">lyr &#x3D; ap.GetParameterAsText(0)</span><br><span class="line">fldX &#x3D; ap.GetParameterAsText(1)</span><br><span class="line">fldY &#x3D; ap.GetParameterAsText(2)</span><br><span class="line"></span><br><span class="line"># 添加两个字段</span><br><span class="line">ap.AddField_management(lyr, fldX, &quot;DOUBLE&quot;)</span><br><span class="line">ap.AddField_management(lyr, fldY, &quot;DOUBLE&quot;)</span><br><span class="line"># 使用arcpy.da.UpdateCursor() &quot;shape@XY&quot;几何令牌获取经纬度坐标x,y</span><br><span class="line"># [&quot;shape@XY&quot;, &quot;pyX&quot;, &quot;pyY&quot;] 后两个参数是传入的字段</span><br><span class="line">with ap.da.UpdateCursor(lyr, [&quot;shape@XY&quot;, fldX, fldY]) as cur:</span><br><span class="line">    for row in cur:</span><br><span class="line">        x, y &#x3D; row[0] </span><br><span class="line">        row[1] &#x3D; x        </span><br><span class="line">        row[2] &#x3D; y</span><br><span class="line">        cur.updateRow(row)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine arcpy</tag>
      </tags>
  </entry>
  <entry>
    <title>Python 计算要素图层面积</title>
    <url>/2019-09-18-py-tian-jia-zi-duan-ji-suan-mian-ji.html</url>
    <content><![CDATA[<ul>
<li>arcpy</li>
<li>获取矢量面图层，添加字段，实现面积的计算</li>
</ul>
<a id="more"></a>

<h3><span id="脚本">脚本</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 功能：计算矢量图层面积</span><br><span class="line"># 作者：inno</span><br><span class="line"># 说明：获取矢量面图层，添加字段，实现面积的计算</span><br><span class="line"># 日期：2019&#x2F;9&#x2F;18</span><br><span class="line">import arcpy as ap</span><br><span class="line">import arcpy.mapping as mp</span><br><span class="line">mxd &#x3D; mp.MapDocument(&#39;current&#39;) # 获取当前地图文档</span><br><span class="line">df &#x3D; mp.ListDataFrames(mxd)[0] # 获取第一个数据框</span><br><span class="line">lyr &#x3D; mp.ListLayers(df)[0] # 获取第一个图层</span><br><span class="line">ap.AddField_management(lyr, &quot;pyArea&quot;, &quot;DOUBLE&quot;) # 添加字段</span><br><span class="line"># 计算字段-计算面积</span><br><span class="line">ap.CalculateField_management(lyr, &quot;pyArea&quot;, &quot;!shape.area!&quot;, &quot;PYTHON&quot;)</span><br></pre></td></tr></table></figure>

<h3><span id="工具脚本">工具脚本</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 功能：计算矢量图层面积</span><br><span class="line"># 作者：inno</span><br><span class="line"># 说明：在工具中，获取矢量面图层，添加字段，实现面积的计算</span><br><span class="line"># 日期：2019&#x2F;9&#x2F;18</span><br><span class="line">import arcpy as ap</span><br><span class="line">import arcpy.mapping as mp</span><br><span class="line"></span><br><span class="line"># 获取工具中输入的参数</span><br><span class="line">lyr &#x3D; ap.GetParameterAsText(0)</span><br><span class="line">fld &#x3D; ap.GetParameterAsText(1)</span><br><span class="line"></span><br><span class="line">ap.AddField_management(lyr, fld, &quot;DOUBLE&quot;) # 添加字段</span><br><span class="line"></span><br><span class="line"># 计算字段-计算面积</span><br><span class="line">ap.CalculateField_management(lyr, fld, &quot;!shape.area!&quot;, &quot;PYTHON&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine arcpy</tag>
      </tags>
  </entry>
  <entry>
    <title>vba ArcMap UI控件  计算要素图层面积</title>
    <url>/2019-09-16-vba-arcmap-ui-kong-jian-ji-suan-yao-su-tu-ceng-mian-ji.html</url>
    <content><![CDATA[<p>计算面图层</p>
<ul>
<li>添加字段</li>
<li>计算面积</li>
</ul>
<a id="more"></a>

<h3><span id="vba代码">vba代码</span></h3><h4><span id="版本一">版本一</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Private Sub UIButtonControl1_Click()</span><br><span class="line">&#39; 功能：计算图层面积</span><br><span class="line">&#39; 作者：inno</span><br><span class="line">&#39; 说明：代码实现了：对矢量面图层，新建一个字段，并计算面积赋值给此字段</span><br><span class="line">&#39; 日期：2019&#x2F;9&#x2F;16</span><br><span class="line"></span><br><span class="line">&#39;IApplication开始</span><br><span class="line">Dim pApp As IApplication</span><br><span class="line">Set pApp &#x3D; Application</span><br><span class="line"></span><br><span class="line">&#39;MxDocument 获取文档</span><br><span class="line">Dim pMxDoc As IMxDocument</span><br><span class="line">Set pMxDoc &#x3D; pApp.Document</span><br><span class="line"></span><br><span class="line">&#39;IMap 获取地图</span><br><span class="line">Dim pMap As IMap</span><br><span class="line">Set pMap &#x3D; pMxDoc.FocusMap &#39;获取当前地图</span><br><span class="line"></span><br><span class="line">&#39;ILayer 获取图层</span><br><span class="line">Dim pLayer As ILayer</span><br><span class="line">Set pLayer &#x3D; pMap.Layer(0) &#39;第一个图层</span><br><span class="line"></span><br><span class="line">&#39;判断图层是否为矢量图层</span><br><span class="line">If Not TypeOf pLayer Is IFeatureLayer Then</span><br><span class="line">    MsgBox &quot;不是矢量图层&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39;IFeatureLayer 获取矢量图层</span><br><span class="line">Dim pFeatLyr As IFeatureLayer</span><br><span class="line">Set pFeatLyr &#x3D; pLayer</span><br><span class="line"></span><br><span class="line">&#39;IFeatureClass 获取表</span><br><span class="line">Dim pFeatCls As IFeatureClass</span><br><span class="line">Set pFeatCls &#x3D; pFeatLyr.FeatureClass</span><br><span class="line"></span><br><span class="line">&#39;判断是否为面</span><br><span class="line">If pFeatCls.ShapeType &lt;&gt; esriGeometryPolygon Then</span><br><span class="line">    MsgBox &quot;不是面元素，不能计算面积&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39;添加一个面积字段</span><br><span class="line">Dim id_area2 As Integer</span><br><span class="line">Dim area2 As String</span><br><span class="line">area2 &#x3D; &quot;AREA2&quot;</span><br><span class="line">id_area2 &#x3D; pFeatCls.FindField(area2) &#39;字段索引</span><br><span class="line">&#39;判断面积字段是否存在,若不存在，area2&#x3D;-1</span><br><span class="line">If id_area2 &lt;&gt; -1 Then</span><br><span class="line">   MsgBox &quot;字段已存在，请重新添加字段&quot;</span><br><span class="line">   Exit Sub</span><br><span class="line">End If</span><br><span class="line">&#39;声明可编辑字段类型</span><br><span class="line">Dim areaField As IFieldEdit</span><br><span class="line">Set areaField &#x3D; New Field</span><br><span class="line">&#39;字段名与类型</span><br><span class="line">areaField.Name &#x3D; area2</span><br><span class="line">areaField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line"></span><br><span class="line">pFeatCls.AddField areaField &#39;添加面积字段</span><br><span class="line"></span><br><span class="line">&#39;FeatureCursor 获取指针</span><br><span class="line">Dim pFeatCur As IFeatureCursor</span><br><span class="line">Set pFeatCur &#x3D; pFeatCls.Update(Nothing, False)</span><br><span class="line"></span><br><span class="line">Dim pFeat As IFeature</span><br><span class="line">Set pFeat &#x3D; pFeatCur.NextFeature</span><br><span class="line"></span><br><span class="line">Dim plg As IPolygon &#39;面</span><br><span class="line">Dim pArea As IArea &#39;面积</span><br><span class="line">Dim s As String &#39;字符串存表中name字符</span><br><span class="line">Dim s_id As Integer &#39;整型id</span><br><span class="line">Dim s_area As Integer &#39;面积字段的索引</span><br><span class="line"></span><br><span class="line">s_id &#x3D; pFeatCls.FindField(&quot;NAME&quot;)  &#39;NAME字段所在的索引号</span><br><span class="line">s_area &#x3D; pFeatCls.FindField(area2) &#39;面积字段的索引</span><br><span class="line">&#39;MsgBox s_area</span><br><span class="line"></span><br><span class="line">&#39;循环 计算面积 存放在特定字段</span><br><span class="line">Do While Not pFeat Is Nothing</span><br><span class="line">    Set plg &#x3D; pFeat.Shape</span><br><span class="line">    &#39;计算面积</span><br><span class="line">    Set pArea &#x3D; plg</span><br><span class="line">    pFeat.Value(s_area) &#x3D; pArea.Area</span><br><span class="line">    pFeatCur.UpdateFeature pFeat &#39;将面积添加到字段中后，更新要素</span><br><span class="line">    </span><br><span class="line">    &#39;字符串</span><br><span class="line">    s &#x3D; s + pFeat.Value(s_id) + Str(pArea.Area) + vbNewLine</span><br><span class="line">    Set pFeat &#x3D; pFeatCur.NextFeature &#39; 循环，不加就死循环</span><br><span class="line">    </span><br><span class="line">Loop</span><br><span class="line"></span><br><span class="line">MsgBox s</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h4><span id="版本二">版本二</span></h4><ul>
<li>添加字段时，判断字段是否存在</li>
<li>不存在则添加</li>
<li>存在则不添加，后续计算结果赋值给存在字段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Private Sub UIButtonControl1_Click()</span><br><span class="line">&#39; 功能：计算家乡图层面积</span><br><span class="line">&#39; 作者：1985857412@qq.com</span><br><span class="line">&#39; 说明：代码实现了：对矢量面图层，新建一个字段，并计算面积赋值给此字段</span><br><span class="line">&#39; 日期：2019&#x2F;9&#x2F;16</span><br><span class="line"></span><br><span class="line">&#39;IApplication开始</span><br><span class="line">Dim pApp As IApplication</span><br><span class="line">Set pApp &#x3D; Application</span><br><span class="line"></span><br><span class="line">&#39;MxDocument 获取文档</span><br><span class="line">Dim pMxDoc As IMxDocument</span><br><span class="line">Set pMxDoc &#x3D; pApp.Document</span><br><span class="line"></span><br><span class="line">&#39;IMap 获取地图</span><br><span class="line">Dim pMap As IMap</span><br><span class="line">Set pMap &#x3D; pMxDoc.FocusMap &#39;获取当前地图</span><br><span class="line"></span><br><span class="line">&#39;ILayer 获取图层</span><br><span class="line">Dim pLayer As ILayer</span><br><span class="line">Set pLayer &#x3D; pMap.Layer(0) &#39;第一个图层</span><br><span class="line"></span><br><span class="line">&#39;判断图层是否为矢量图层</span><br><span class="line">If Not TypeOf pLayer Is IFeatureLayer Then</span><br><span class="line">    MsgBox &quot;不是矢量图层&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39;IFeatureLayer 获取矢量图层</span><br><span class="line">Dim pFeatLyr As IFeatureLayer</span><br><span class="line">Set pFeatLyr &#x3D; pLayer</span><br><span class="line"></span><br><span class="line">&#39;IFeatureClass 获取表</span><br><span class="line">Dim pFeatCls As IFeatureClass</span><br><span class="line">Set pFeatCls &#x3D; pFeatLyr.FeatureClass</span><br><span class="line"></span><br><span class="line">&#39;判断是否为面</span><br><span class="line">If pFeatCls.ShapeType &lt;&gt; esriGeometryPolygon Then</span><br><span class="line">    MsgBox &quot;不是面元素，不能计算面积&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39;添加一个面积字段</span><br><span class="line">Dim id_area2 As Integer</span><br><span class="line">Dim area2 As String</span><br><span class="line">area2 &#x3D; &quot;AREA2&quot;</span><br><span class="line">id_area2 &#x3D; pFeatCls.FindField(area2) &#39;字段索引</span><br><span class="line">&#39;判断面积字段是否存在,不存在时，area2&#x3D;-1</span><br><span class="line">If id_area2 &lt;&gt; -1 Then</span><br><span class="line">   MsgBox &quot;字段AREA2已存在，将使用存在字段进行计算&quot;</span><br><span class="line"></span><br><span class="line">Else &#39;字段不存在时，新建</span><br><span class="line">    </span><br><span class="line">    &#39;声明可编辑字段类型</span><br><span class="line">    Dim areaField As IFieldEdit</span><br><span class="line">    Set areaField &#x3D; New Field</span><br><span class="line">    &#39;字段名与类型</span><br><span class="line">    areaField.Name &#x3D; area2</span><br><span class="line">    areaField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line"></span><br><span class="line">    pFeatCls.AddField areaField &#39;添加面积字段</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#39;FeatureCursor 获取指针</span><br><span class="line">Dim pFeatCur As IFeatureCursor</span><br><span class="line">Set pFeatCur &#x3D; pFeatCls.Update(Nothing, False)</span><br><span class="line"></span><br><span class="line">Dim pFeat As IFeature</span><br><span class="line">Set pFeat &#x3D; pFeatCur.NextFeature</span><br><span class="line"></span><br><span class="line">Dim plg As IPolygon &#39;面</span><br><span class="line">Dim pArea As IArea &#39;面积</span><br><span class="line">Dim s As String &#39;字符串存表中name字符</span><br><span class="line">Dim s_id As Integer &#39;整型id</span><br><span class="line">Dim s_area As Integer &#39;面积字段的索引</span><br><span class="line"></span><br><span class="line">s_id &#x3D; pFeatCls.FindField(&quot;NAME&quot;)  &#39;NAME字段所在的索引号</span><br><span class="line">s_area &#x3D; pFeatCls.FindField(area2) &#39;面积字段的索引</span><br><span class="line">&#39;MsgBox s_area</span><br><span class="line"></span><br><span class="line">&#39;循环 计算面积 存放在特定字段</span><br><span class="line">Do While Not pFeat Is Nothing</span><br><span class="line">    Set plg &#x3D; pFeat.Shape</span><br><span class="line">    &#39;计算面积</span><br><span class="line">    Set pArea &#x3D; plg</span><br><span class="line">    pFeat.Value(s_area) &#x3D; pArea.Area</span><br><span class="line">    pFeatCur.UpdateFeature pFeat &#39;将面积添加到字段中后，更新要素</span><br><span class="line">    </span><br><span class="line">    &#39;字符串</span><br><span class="line">    s &#x3D; s + pFeat.Value(s_id) + Str(pArea.Area) + vbNewLine</span><br><span class="line">    Set pFeat &#x3D; pFeatCur.NextFeature &#39; 循环，不加就死循环</span><br><span class="line">    </span><br><span class="line">Loop</span><br><span class="line"></span><br><span class="line">MsgBox s</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine vba</tag>
      </tags>
  </entry>
  <entry>
    <title>vba ArcMap UI控件 线图层-线长与弯曲度</title>
    <url>/2019-09-16-vba-xian-tu-ceng-xian-chang-yu-wan-qu-du.html</url>
    <content><![CDATA[<p>计算线图层</p>
<ul>
<li>添加字段</li>
<li>计算线长</li>
<li>计算弯曲度</li>
<li>弯曲度=线长/曲线首末直线距离</li>
</ul>
<a id="more"></a>

<h3><span id="代码">代码</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Private Sub UIButtonControl2_Click()</span><br><span class="line">&#39;功能：计算家乡线图层，线长与弯曲度</span><br><span class="line">&#39;作者：inno</span><br><span class="line">&#39;说明：利用vb代码实现：自动添加两个字段lineLength和wqd，计算出结果、保存在字段</span><br><span class="line">&#39;打印出计算结果</span><br><span class="line">&#39;日期:2019&#x2F;9&#x2F;17</span><br><span class="line"></span><br><span class="line">&#39; IApplication开始</span><br><span class="line">Dim pApp As IApplication</span><br><span class="line">Set pApp &#x3D; Application</span><br><span class="line"></span><br><span class="line">&#39; 获取文档 IMxDocument</span><br><span class="line">Dim pMxDoc As IMxDocument</span><br><span class="line">Set pMxDoc &#x3D; pApp.Document</span><br><span class="line"></span><br><span class="line">&#39;获取当前地图 IMap</span><br><span class="line">Dim pMap As IMap</span><br><span class="line">Set pMap &#x3D; pMxDoc.FocusMap</span><br><span class="line"></span><br><span class="line">&#39;获取图层 ILayer</span><br><span class="line">Dim pLayer As ILayer</span><br><span class="line">Set pLayer &#x3D; pMap.Layer(1) &#39;此文档线图层在第二个位置</span><br><span class="line"></span><br><span class="line">&#39;判断图层是否为矢量图层</span><br><span class="line">If Not TypeOf pLayer Is IFeatureLayer Then</span><br><span class="line">    MsgBox &quot;图层不是矢量图层，无法计算&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#39; 获取矢量图层 IFeatureLayer</span><br><span class="line">Dim pFeatLyr As IFeatureLayer</span><br><span class="line">Set pFeatLyr &#x3D; pLayer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#39;获取表 IFeatureClass</span><br><span class="line">Dim pFeatCls As IFeatureClass</span><br><span class="line">Set pFeatCls &#x3D; pFeatLyr.FeatureClass</span><br><span class="line"></span><br><span class="line">&#39;判断需要创建的字段是否已经存在</span><br><span class="line">Dim sLenField As String</span><br><span class="line">Dim sWqdField As String</span><br><span class="line">sLenField &#x3D; &quot;lineLength&quot;</span><br><span class="line">sWqdField &#x3D; &quot;wqd&quot;</span><br><span class="line">If pFeatCls.FindField(sLenField) &lt;&gt; -1 Or pFeatCls.FindField(sWqdField) &lt;&gt; -1 Then</span><br><span class="line">    MsgBox &quot;字段已经存在，请检查&quot;</span><br><span class="line">    Exit Sub</span><br><span class="line">End If</span><br><span class="line">&#39;创建字段</span><br><span class="line">Dim lenField As IFieldEdit</span><br><span class="line">Dim wqdField As IFieldEdit</span><br><span class="line">Set lenField &#x3D; New Field</span><br><span class="line">Set wqdField &#x3D; New Field</span><br><span class="line">&#39;设置字段名称与类型</span><br><span class="line">lenField.Name &#x3D; sLenField</span><br><span class="line">wqdField.Name &#x3D; sWqdField</span><br><span class="line">lenField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line">wqdField.Type &#x3D; esriFieldTypeDouble</span><br><span class="line">&#39;添加字段</span><br><span class="line">pFeatCls.AddField lenField</span><br><span class="line">pFeatCls.AddField wqdField</span><br><span class="line"></span><br><span class="line">&#39;获取IFeatureCursor</span><br><span class="line">Dim pFeatCur As IFeatureCursor</span><br><span class="line">Set pFeatCur &#x3D; pFeatCls.Update(Nothing, False)</span><br><span class="line"></span><br><span class="line">&#39;获取 IFeature</span><br><span class="line">Dim pFeat As IFeature</span><br><span class="line">Set pFeat &#x3D; pFeatCur.NextFeature</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dim s As String &#39;打印的文本字符串</span><br><span class="line">Dim line As IPolyline &#39;ILine</span><br><span class="line"></span><br><span class="line">Dim idLen As Integer &#39;长度字段的索引</span><br><span class="line">Dim idWqd As Integer &#39;弯曲度字段的索引</span><br><span class="line">Dim idName As Integer &#39;NAME字段的索引</span><br><span class="line">&#39; 索引赋值</span><br><span class="line">idLen &#x3D; pFeatCls.FindField(sLenField)</span><br><span class="line">idWqd &#x3D; pFeatCls.FindField(sWqdField)</span><br><span class="line">idName &#x3D; pFeatCls.FindField(&quot;NAME&quot;)</span><br><span class="line"></span><br><span class="line">Dim fPoint As IPoint &#39;线段首点</span><br><span class="line">Dim lPoint As IPoint &#39;线段末点</span><br><span class="line">Dim dis As Double &#39;首末点直线长度</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Do While Not pFeat Is Nothing</span><br><span class="line">    Set line &#x3D; pFeat.Shape  &#39;线</span><br><span class="line">    pFeat.Value(idLen) &#x3D; line.Length  &#39;给长度字段赋值</span><br><span class="line">    </span><br><span class="line">    &#39;首末点直线长度计算</span><br><span class="line">    Set fPoint &#x3D; line.FromPoint</span><br><span class="line">    Set lPoint &#x3D; line.ToPoint</span><br><span class="line">    dis &#x3D; ((fPoint.X - lPoint.X) ^ 2 + (fPoint.Y - lPoint.Y) ^ 2) ^ (1 &#x2F; 2)</span><br><span class="line">    pFeat.Value(idWqd) &#x3D; dis &#x2F; line.Length &#39;弯曲度赋值到字段中</span><br><span class="line">    </span><br><span class="line">    s &#x3D; s + pFeat.Value(idName) + Str(line.Length) + sWqdField + Str(dis &#x2F; line.Length) + vbNewLine    &#39;输出字符串</span><br><span class="line">    pFeatCur.UpdateFeature pFeat &#39;更新要素</span><br><span class="line">    </span><br><span class="line">    Set pFeat &#x3D; pFeatCur.NextFeature &#39;不加是死循环</span><br><span class="line">Loop</span><br><span class="line"></span><br><span class="line">MsgBox s</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ArcMapEngine vba</tag>
      </tags>
  </entry>
  <entry>
    <title>jQuery实现带下拉框导航栏</title>
    <url>/2019-08-15-jquery-shi-xian-dai-xia-la-kuang-dao-hang-lan.html</url>
    <content><![CDATA[<h2><span id="jquery实例1-带下拉框导航栏">jQuery实例(1)-带下拉框导航栏</span></h2><p>实现功能:</p>
<ul>
<li>当鼠标悬停时自动出现下拉框(hover)</li>
<li>下拉框的淡入淡出(slide)</li>
<li>设置动画延时(setTimeout)</li>
<li>导航栏随滚轮悬浮在顶部</li>
</ul>
<p>文件目录</p>
<ul>
<li>header.html</li>
<li>header.css</li>
<li>header.js  float.js</li>
</ul>
<a id="more"></a>

<h3><span id="1-headerhtml文件">1. header.html文件</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;jquery-3.3.1.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;header.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;float.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;header.css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot;&gt;首页&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;accordion&quot;&gt;</span><br><span class="line">            &lt;a href&#x3D;&quot;#&quot;&gt;游戏&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;accordion-contents&quot;&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;暗夜基地&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;回路区&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;accordion&quot;&gt;</span><br><span class="line">            &lt;a href&#x3D;&quot;#&quot;&gt;加入&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;accordion-contents&quot;&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;野狼副本&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;精灵祭坛&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;荒原星际&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;accordion&quot;&gt;</span><br><span class="line">            &lt;a href&#x3D;&quot;#&quot;&gt;关于&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;accordion-contents&quot;&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;世界观&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;魔导石&lt;&#x2F;a&gt;</span><br><span class="line">                &lt;a href&#x3D;&quot;#&quot;&gt;空吟术&lt;&#x2F;a&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="2-headercss-文件">2. header.css 文件</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">*&#123;  margin: 0;padding: 0;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*容器*&#x2F;</span><br><span class="line">.container&#123;</span><br><span class="line">    font-family: &#39;Trebuchet MS&#39;, &#39;Lucida Sans Unicode&#39;, &#39;Lucida Grande&#39;, &#39;Lucida Sans&#39;, Arial, sans-serif;</span><br><span class="line">    font-size: 1em;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 40px;</span><br><span class="line">    background-color: rgba(127,255,212,0.5); &#x2F;*rgba()0.5设置背景不透明度，而文字不透明*&#x2F;</span><br><span class="line">    &#x2F;* overflow: hidden; 超出容器元素会被隐藏 *&#x2F;  &#x2F;*此句在导航栏悬浮会出现下拉菜单消失的bug*&#x2F;</span><br><span class="line">    text-align: center;</span><br><span class="line">    margin: 0 auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container a&#123;</span><br><span class="line">    float: left;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    font-size: 1em;</span><br><span class="line">    color: black;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    width: 100px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.accordion&#123;</span><br><span class="line">    float: left;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*下拉元素不会遮住此处*&#x2F;</span><br><span class="line">.accordion a&#123;</span><br><span class="line">    float: none;</span><br><span class="line">    display: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.accordion-contents&#123;</span><br><span class="line">    display: none;</span><br><span class="line">    position: absolute;</span><br><span class="line">    background-color: aliceblue;</span><br><span class="line">    box-shadow: 0 8px 12px 0 rgba(0, 0, 0, 0.2);</span><br><span class="line">    z-index: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 让下拉元素在下部 *&#x2F;</span><br><span class="line">.accordion-contents a&#123;</span><br><span class="line">    float: none;</span><br><span class="line">    display: block;</span><br><span class="line">    text-align: center;</span><br><span class="line">    text-decoration: none; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a:hover&#123;</span><br><span class="line">    color: white;</span><br><span class="line">    background-color: midnightblue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3><span id="3-headerjs-使用jquery实现下拉动画">3. header.js 使用jQuery实现下拉动画</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line">    &#x2F;&#x2F; jQuery实现下拉菜单</span><br><span class="line">    $(&quot;.accordion&quot;).hover(</span><br><span class="line">        function()&#123; &#x2F;&#x2F;悬停在上</span><br><span class="line">            var _this &#x3D; $(this); &#x2F;&#x2F;setTimeout()中不能使用$(this)</span><br><span class="line">            trigger &#x3D; setTimeout(function()&#123;  &#x2F;&#x2F;设置延时处理</span><br><span class="line">                _this.children().slideDown(&quot;fast&quot;);</span><br><span class="line">            &#125;, 300);</span><br><span class="line">            </span><br><span class="line">        &#125;,</span><br><span class="line">        function()&#123; &#x2F;&#x2F;悬停离开</span><br><span class="line">            clearTimeout(trigger); &#x2F;&#x2F;清除延时</span><br><span class="line">            $(&quot;.accordion-contents&quot;).slideUp(&quot;fast&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3><span id="4-floatjs-文件实现导航栏随滚轮悬浮在顶部">4. float.js 文件实现导航栏随滚轮悬浮在顶部</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line">    &#x2F;&#x2F; jQuery实现导航栏随滚轮悬浮</span><br><span class="line">    &#x2F;&#x2F; 首先获取导航栏距离顶部高度</span><br><span class="line">    var top &#x3D; $(&quot;.container&quot;).offset().top;</span><br><span class="line">    &#x2F;&#x2F; 开始监控滚动栏scroll</span><br><span class="line">    $(document).scroll(function()&#123;</span><br><span class="line">        &#x2F;&#x2F; 获取当前滚动栏高度</span><br><span class="line">        var scrTop &#x3D; $(window).scrollTop();</span><br><span class="line">        &#x2F;&#x2F; 判断:滚动栏高度大于等于导航栏距离顶部的高度时，悬浮</span><br><span class="line">        if(scrTop &gt;&#x3D; top)&#123;</span><br><span class="line">            $(&quot;.container&quot;).css(&#123;&#39;position&#39;:&#39;fixed&#39;,&#39;top&#39;:&#39;0&#39;&#125;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            $(&quot;.container&quot;).css(&#123;&#39;position&#39;:&#39;&#39;,&#39;top&#39;:&#39;&#39;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title>Python-ArcGIS学习功能索引</title>
    <url>/2019-08-06-python-arcgis-xue-xi-gong-neng-suo-yin.html</url>
    <content><![CDATA[<h2><span id="python-arcgis学习功能索引">Python-ArcGIS学习功能索引</span></h2><p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p><b>功能索引</b></p>
<h3><span id="学习日志-1">学习日志 1:</span></h3><ul>
<li>arcpy库  </li>
<li>引用mxd文档、数据框、图层  </li>
<li>改变地图范围  </li>
<li>添加图层文件到数据框  </li>
<li>插入一个图层到某个位置</li>
</ul>
<a id="more"></a>

<h3><span id="学习日志-2">学习日志 2:</span></h3><ul>
<li>利用图层更新其他图层属性  </li>
<li>操作数据框中启用时间属性的图层  </li>
<li>查找地图文档和图层文件中丢失的数据源  </li>
<li>使用MapDocument.findAndReplaceWorkplacePaths()修复丢失的数据源  </li>
<li>使用MapDocument.replaceWorkspaces()方法修复丢失的数据源</li>
</ul>
<h3><span id="学习日志-3">学习日志 3</span></h3><ul>
<li>使用replaceDataSource()修复单个图层和表对象  </li>
<li>查找文件夹中所有地图文档内丢失数据源的图层 </li>
</ul>
<h3><span id="学习日志-4">学习日志 4</span></h3><ul>
<li>打印文档中的所有布局元素</li>
<li>打印布局元素，限制为图例元素</li>
<li>更新布局元素属性</li>
<li>获取可用的打印机列表</li>
<li>使用PrintMap()打印地图</li>
<li>导出地图为PDF文件</li>
<li>导出地图为图像文件</li>
<li>导出图层报表</li>
<li>使用数据驱动页面和arcpy.mapping模块构建地图册</li>
<li>将地图文档发布为ArcGIS Server服务</li>
</ul>
<h3><span id="学习日志-5">学习日志 5</span></h3><ul>
<li>使用脚本执行地理处理工具-Clip_analysis为例</li>
<li>将一个工具的输出作为一个工具的输入</li>
</ul>
<h3><span id="学习日志-6">学习日志 6</span></h3><ul>
<li>创建自定义地理处理工具</li>
<li>创建Python工具箱</li>
</ul>
<h3><span id="学习日志7-查询和选择数据">学习日志7     查询和选择数据</span></h3><ul>
<li>查询前，创建要素类或表视图的内存副本</li>
<li>测试 按属性查询</li>
<li>按位置选择图层</li>
<li>结合 按属性选择与按位置选择</li>
</ul>
<h3><span id="学习日志8-在要素类和表中使用arcpy">学习日志8 在要素类和表中使用Arcpy</span></h3><ul>
<li>使用SearchCursor检索要素类中的要素</li>
<li>使用几何令牌参数的SearchCursor()</li>
<li>使用InsertCursor(),从文本文件读取数据给要素添加记录</li>
<li>UpdateCursor()创建对象,updateRow()方法更新表中每一行</li>
<li>UpdateCursor()对象的deleteRow(),删除特定记录</li>
<li>在编辑会话中插入和更新行</li>
<li>读取要素类中的几何信息</li>
<li>使用Walk()遍历目录</li>
</ul>
<h3><span id="学习日志9-获取gis数据列表和描述">学习日志9 获取GIS数据列表和描述</span></h3><ul>
<li>获取工作空间要素类列表</li>
<li>获取要素中的字段列表</li>
<li>使用Describe()函数返回要素类的描述性信息</li>
<li>实用Describe()函数返回栅格图像的描述性信息</li>
</ul>
<h3><span id="学习日志10-使用add-in定制arcgis界面">学习日志10 使用add-in定制Arcgis界面</span></h3><blockquote>
<p>Python Add-in Wizard 下载,解压运行/bin/..exe</p>
</blockquote>
<blockquote>
<p><a href="http://www.arcgis.com/home/item.html?id=5f3aefe77f6b4f61ad3e4c62f30bff3b" target="_blank" rel="noopener external nofollow noreferrer">http://www.arcgis.com/home/item.html?id=5f3aefe77f6b4f61ad3e4c62f30bff3b</a></p>
</blockquote>
<blockquote>
<p>Python Add-in Wizard是一个可视化界面工具,用于创建桌面Arcgis加载项</p>
</blockquote>
<ul>
<li>创建按钮加载项和使用Python加载项</li>
<li>安装测试加载项</li>
<li>创建工具加载项</li>
</ul>
<h3><span id="学习日志11-异常识别和错误处理">学习日志11 异常识别和错误处理</span></h3><ul>
<li>Python异常处理结构(try/except/else/finally)</li>
<li>使用arcpy.GetMessages()捕获详细的消息信息</li>
<li>根据严重性级别筛选消息</li>
<li>测试和响应特定错误消息</li>
</ul>
<h3><span id="学习日志12-使用python实现arcgis的高级功能">学习日志12 使用Python实现ArcGis的高级功能</span></h3><ul>
<li>使用Python构建HTTP响应请求并解析响应</li>
<li>使用ArcGis REST API和Python获取图层信息</li>
<li>使用ArcGis REST API和Python导出地图</li>
<li>使用ArcGis REST API和Python查询地图服务</li>
<li>使用Esri World Geocoding Service进行地理编码</li>
<li>使用FieldMappings和FieldMap,实现几个要素类的合并(Merge)</li>
<li>使用ValueTable讲多值输入到工具中作为参数</li>
</ul>
<h3><span id="学习日志附录-gis程序员不可不知的python功能">学习日志(附录) GIS程序员不可不知的Python功能</span></h3><ul>
<li>发送带附件电子邮件</li>
<li>连接FTP服务并操作文件</li>
<li>使用zipfile模块压缩文件</li>
<li>读取xml文档</li>
</ul>
]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript应用实例-下拉框</title>
    <url>/2019-08-06-javascript-ying-yong-shi-li-3-shou-feng-qin-xia-la-kuang.html</url>
    <content><![CDATA[<h2><span id="javascript应用实例3-手风琴下拉框">JavaScript应用实例(3)-手风琴下拉框</span></h2><p>参考：<a href="https://c.runoob.com/codedemo/3158" target="_blank" rel="noopener external nofollow noreferrer"> JS/CSS 带图标手风琴动画效果</a></p>
<ul>
<li>html</li>
<li>css</li>
<li>javascript</li>
</ul>
<a id="more"></a>

<h3><span id="1-html-javascript">1. html javascript</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  	&lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">	&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">	&lt;link type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;accordion.css&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- 带图标手风琴动画效果 --&gt;</span><br><span class="line">&lt;button class&#x3D;&quot;accordion&quot;&gt;选项 1&lt;&#x2F;button&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;panel&quot;&gt;</span><br><span class="line">  &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;button class&#x3D;&quot;accordion&quot;&gt;选项 2&lt;&#x2F;button&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;panel&quot;&gt;</span><br><span class="line">  &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">	</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var acc &#x3D; document.getElementsByClassName(&quot;accordion&quot;);</span><br><span class="line">var i;</span><br><span class="line"></span><br><span class="line">for (i &#x3D; 0; i &lt; acc.length; i++) &#123;</span><br><span class="line">  acc[i].onclick &#x3D; function() &#123;</span><br><span class="line">    this.classList.toggle(&quot;active&quot;);</span><br><span class="line">    var panel &#x3D; this.nextElementSibling;</span><br><span class="line">    if (panel.style.maxHeight)&#123;</span><br><span class="line">      panel.style.maxHeight &#x3D; null;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      panel.style.maxHeight &#x3D; panel.scrollHeight + &quot;px&quot;;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="2-css">2. css</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">button.accordion &#123;</span><br><span class="line">    background-color: aqua;</span><br><span class="line">    color: rgb(8, 8, 8);</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    padding: 18px;</span><br><span class="line">    width: 20%;</span><br><span class="line">    border: none;</span><br><span class="line">    text-align: left;</span><br><span class="line">    outline: none;</span><br><span class="line">    font-size: 15px;</span><br><span class="line">    transition: 0.4s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button.accordion.active, button.accordion:hover &#123;</span><br><span class="line">    background-color: rgb(191, 197, 204);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button.accordion:after &#123;</span><br><span class="line">    content: &#39;\002B&#39;;</span><br><span class="line">    color: rgb(29, 27, 27);</span><br><span class="line">    font-weight: bold;</span><br><span class="line">    float: right;</span><br><span class="line">    margin-left: 5px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button.accordion.active:after &#123;</span><br><span class="line">    content: &quot;\2212&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div.panel &#123;</span><br><span class="line">    width: 20%;</span><br><span class="line">    padding: 0 18px;</span><br><span class="line">    background-color: aquamarine;</span><br><span class="line">    max-height: 0;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    transition: max-height 0.2s ease-out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript应用实例-自动、手动播放图片</title>
    <url>/2019-08-05-zi-dong-shou-dong-bo-fang-tu-pian-javascript.html</url>
    <content><![CDATA[<h2><span id="javascript应用实例1">JavaScript应用实例(1)</span></h2><p>参考：<a href="http://www.runoob.com/js/js-examples.html" target="_blank" rel="noopener external nofollow noreferrer">菜鸟教程</a></p>
<p>环境:</p>
<ul>
<li>html</li>
<li>代码为主要部分</li>
</ul>
<p>内容包括:</p>
<ul>
<li>自动、手动播放图片</li>
</ul>
<a id="more"></a>

<h3><span id="1-自动-手动播放图片">1. 自动、手动播放图片</span></h3><ul>
<li>html</li>
<li>CSS</li>
<li>javascript</li>
<li>存放三张图片</li>
<li>初始状态图片不显示</li>
<li>调用JS显示图片</li>
<li>每隔4s图片自动滑动</li>
<li>可手动点击切换图片</li>
</ul>
<h4><span id="1-html页面">1. html页面</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;title&gt;JavaScript测试&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;link type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;slidePic.css&quot;&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;slidePic.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;    </span><br><span class="line">    &lt;div class&#x3D;&quot;slideshow-container&quot;&gt;</span><br><span class="line">        &lt;!-- 三个&lt;div&gt;&lt;&#x2F;div&gt;存放三张图片 --&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div id&#x3D;&quot;pic&quot; class&#x3D;&quot;mySlides fade&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;numbertext&quot;&gt;1 &#x2F; 3&lt;&#x2F;div&gt;</span><br><span class="line">          &lt;img src&#x3D;&quot;&#x2F;php&#x2F;images&#x2F;1.png&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;text&quot;&gt;手 机 端 app&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;div id&#x3D;&quot;pic&quot; class&#x3D;&quot;mySlides fade&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;numbertext&quot;&gt;2 &#x2F; 3&lt;&#x2F;div&gt;</span><br><span class="line">          &lt;img src&#x3D;&quot;&#x2F;php&#x2F;images&#x2F;2.png&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;text&quot;&gt;航 拍 系 统&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;div id&#x3D;&quot;pic&quot; class&#x3D;&quot;mySlides fade&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;numbertext&quot;&gt;3 &#x2F; 3&lt;&#x2F;div&gt;</span><br><span class="line">          &lt;img src&#x3D;&quot;&#x2F;php&#x2F;images&#x2F;3.png&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;text&quot;&gt;航 线 设 置&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;!-- 图片左右滑动链接 --&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;prev&quot; onclick&#x3D;&quot;plusSlides(-1)&quot;&gt;❮&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;a class&#x3D;&quot;next&quot; onclick&#x3D;&quot;plusSlides(1)&quot;&gt;❯&lt;&#x2F;a&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;br&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;!-- 底部符号 --&gt;</span><br><span class="line">      &lt;div style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">        &lt;span class&#x3D;&quot;dot&quot; onclick&#x3D;&quot;currentSlide(1)&quot;&gt;&lt;&#x2F;span&gt; </span><br><span class="line">        &lt;span class&#x3D;&quot;dot&quot; onclick&#x3D;&quot;currentSlide(2)&quot;&gt;&lt;&#x2F;span&gt; </span><br><span class="line">        &lt;span class&#x3D;&quot;dot&quot; onclick&#x3D;&quot;currentSlide(3)&quot;&gt;&lt;&#x2F;span&gt; </span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;script&gt;auto_showSlides();&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="2-css页面slidepiccss">2. CSS页面；slidePic.css</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* &#123;box-sizing:border-box&#125;</span><br><span class="line">body &#123;font-family: Verdana,sans-serif;&#125;</span><br><span class="line">.mySlides &#123;display:none&#125;</span><br><span class="line">&#x2F;* 幻灯片容器 *&#x2F;</span><br><span class="line">.slideshow-container &#123;</span><br><span class="line">  max-width: 800px;</span><br><span class="line">  max-height: 400px;</span><br><span class="line">  position: relative;</span><br><span class="line">  margin: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 图片大小 *&#x2F;</span><br><span class="line">#pic&#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    width: 800px;</span><br><span class="line">    height: 400px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">img&#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 下一张 &amp; 上一张 按钮 *&#x2F;</span><br><span class="line">.prev, .next &#123;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 50%;</span><br><span class="line">  width: auto;</span><br><span class="line">  margin-top: -22px;</span><br><span class="line">  padding: 16px;</span><br><span class="line">  color: black;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  transition: 0.6s ease;</span><br><span class="line">  border-radius: 0 3px 3px 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 定位 &quot;下一张&quot; 按钮靠右 *&#x2F;</span><br><span class="line">.next &#123;</span><br><span class="line">  right: 0;</span><br><span class="line">  border-radius: 3px 0 0 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* On hover, add a black background color with a little bit see-through *&#x2F;</span><br><span class="line">.prev:hover, .next:hover &#123;</span><br><span class="line">  background-color: rgba(0,0,0,0.8);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 标题文本 *&#x2F;</span><br><span class="line">.text &#123;</span><br><span class="line">  color: blue;</span><br><span class="line">  font-size: 1.25em;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  padding: 8px 12px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  bottom: 8px;</span><br><span class="line">  width: 100%;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 数字文本 (1&#x2F;3 等) *&#x2F;</span><br><span class="line">.numbertext &#123;</span><br><span class="line">  color: #302c2c;</span><br><span class="line">  font-size: 1em;</span><br><span class="line">  padding: 8px 12px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 标记符号 *&#x2F;</span><br><span class="line">.dot &#123;</span><br><span class="line">  cursor:pointer;</span><br><span class="line">  height: 13px;</span><br><span class="line">  width: 13px;</span><br><span class="line">  margin: 0 2px;</span><br><span class="line">  background-color: #bbb;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  transition: background-color 0.6s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.active, .dot:hover &#123;</span><br><span class="line">  background-color: #717171;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 淡出动画 *&#x2F;</span><br><span class="line">.fade &#123;</span><br><span class="line">  -webkit-animation-name: fade;</span><br><span class="line">  -webkit-animation-duration: 1.5s;</span><br><span class="line">  animation-name: fade;</span><br><span class="line">  animation-duration: 1.5s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@-webkit-keyframes fade &#123;</span><br><span class="line">  from &#123;opacity: .4&#125; </span><br><span class="line">  to &#123;opacity: 1&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes fade &#123;</span><br><span class="line">  from &#123;opacity: .4&#125; </span><br><span class="line">  to &#123;opacity: 1&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4><span id="3-js-slidepicjs">3. JS; slidePic.js</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var slideIndex &#x3D; 1; &#x2F;&#x2F; 索引页码</span><br><span class="line">showSlides(slideIndex);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 控制左右翻页</span><br><span class="line">function plusSlides(n) &#123;</span><br><span class="line">  showSlides(slideIndex +&#x3D; n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 控制点翻页</span><br><span class="line">function currentSlide(n) &#123;</span><br><span class="line">  showSlides(slideIndex &#x3D; n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 手动翻页函数</span><br><span class="line">function showSlides(n) &#123;</span><br><span class="line">  var i;</span><br><span class="line">  var slides &#x3D; document.getElementsByClassName(&quot;mySlides&quot;);</span><br><span class="line">  var dots &#x3D; document.getElementsByClassName(&quot;dot&quot;);</span><br><span class="line">  if (n &gt; slides.length) &#123;slideIndex &#x3D; 1&#125; </span><br><span class="line">  if (n &lt; 1) &#123;slideIndex &#x3D; slides.length&#125;</span><br><span class="line">  for (i &#x3D; 0; i &lt; slides.length; i++) &#123;</span><br><span class="line">      slides[i].style.display &#x3D; &quot;none&quot;; </span><br><span class="line">  &#125;</span><br><span class="line">  for (i &#x3D; 0; i &lt; dots.length; i++) &#123;</span><br><span class="line">      dots[i].className &#x3D; dots[i].className.replace(&quot; active&quot;, &quot;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  slides[slideIndex-1].style.display &#x3D; &quot;block&quot;; </span><br><span class="line">  dots[slideIndex-1].className +&#x3D; &quot; active&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 自动翻页函数, 在html页面调用了</span><br><span class="line">function auto_showSlides() &#123;</span><br><span class="line">  var i;</span><br><span class="line">  var slides &#x3D; document.getElementsByClassName(&quot;mySlides&quot;);</span><br><span class="line">  var dots &#x3D; document.getElementsByClassName(&quot;dot&quot;);</span><br><span class="line">  for (i &#x3D; 0; i &lt; slides.length; i++) &#123;</span><br><span class="line">     slides[i].style.display &#x3D; &quot;none&quot;;  </span><br><span class="line">  &#125;</span><br><span class="line">  slideIndex++;</span><br><span class="line">  if (slideIndex &gt; slides.length) &#123;slideIndex &#x3D; 1&#125;    </span><br><span class="line">  for (i &#x3D; 0; i &lt; dots.length; i++) &#123;</span><br><span class="line">      dots[i].className &#x3D; dots[i].className.replace(&quot; active&quot;, &quot;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  slides[slideIndex-1].style.display &#x3D; &quot;block&quot;;  </span><br><span class="line">  dots[slideIndex-1].className +&#x3D; &quot; active&quot;;</span><br><span class="line">  setTimeout(auto_showSlides, 4000); &#x2F;&#x2F; 切换时间为 4 秒</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript学习实例(3)</title>
    <url>/2019-08-05-javascript-xue-xi-shi-li-3.html</url>
    <content><![CDATA[<h2><span id="高级javascript实例">高级JavaScript实例</span></h2><p>参考：<a href="http://www.runoob.com/js/js-examples.html" target="_blank" rel="noopener external nofollow noreferrer">菜鸟教程</a></p>
<p>环境:</p>
<ul>
<li>html</li>
<li>代码为主要部分</li>
</ul>
<p>内容包括:</p>
<ul>
<li>Cookie保存用户信息</li>
<li>简单的计时</li>
<li>无限循环的计时</li>
<li>创建用于对象的模版</li>
</ul>
<a id="more"></a>

<h3><span id="1-cookie保存用户信息">1.  Cookie保存用户信息</span></h3><ul>
<li>首次刷新网页时,prompt()提示框输入名字</li>
<li>之后刷新网页, alert()弹出欢迎字样</li>
<li>apache本地环境</li>
<li><a href="http://www.runoob.com/js/js-cookies.html" target="_blank" rel="noopener external nofollow noreferrer">参考</a></li>
<li>Cookie格式: document.cookie=”username=John Doe; expires=Thu, 18 Dec 2043 12:00:00 GMT”;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;title&gt;JavaScript测试&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">                &#x2F;&#x2F; Cookie保存用户信息</span><br><span class="line">                &#x2F;&#x2F; 设置Cookie</span><br><span class="line">                function setcookie(cname, cvalue, exdays)&#123;</span><br><span class="line">                   var d &#x3D; new Date(); &#x2F;&#x2F; 定义时间变量</span><br><span class="line">                    d.setTime(d.getTime() + (exdays*24*60*60*1000));</span><br><span class="line">                    var expires &#x3D; &quot;expires&#x3D;&quot; + d.toGMTString();</span><br><span class="line">                    document.cookie &#x3D; cname + &quot;&#x3D;&quot; + cvalue + &quot;; &quot; + expires;</span><br><span class="line">    </span><br><span class="line">                &#125;</span><br><span class="line">                &#x2F;&#x2F; 获取Cookie</span><br><span class="line">                function getcookie(cname)&#123;</span><br><span class="line">                    var name &#x3D; cname + &quot;&#x3D;&quot;; &#x2F;&#x2F; name &#x3D; &quot;username&#x3D;&quot;</span><br><span class="line">                    var ca &#x3D; document.cookie.split(&quot;;&quot;) &#x2F;&#x2F; 分割cookie</span><br><span class="line">                    for(var i&#x3D;0; i&lt;ca.length; i++)&#123; &#x2F;&#x2F; 遍历分割的数组</span><br><span class="line">                        var c &#x3D; ca[i].trim(); &#x2F;&#x2F; 去除前后空格</span><br><span class="line">                        if(c.indexOf(name)&#x3D;&#x3D;0)&#123; &#x2F;&#x2F; 如果字串name索引位置为0</span><br><span class="line">                            return c.substring(name.length, c.length); &#x2F;&#x2F; 返回Cookie的username的值</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    return &quot;&quot;; &#x2F;&#x2F; 没有Cookie返回空</span><br><span class="line">                &#125;</span><br><span class="line">                &#x2F;&#x2F; 检查Cookie</span><br><span class="line">                function checkcookie()&#123;</span><br><span class="line">                    var user &#x3D; getcookie(&quot;username&quot;); &#x2F;&#x2F; user存储Cookie的username值</span><br><span class="line">                    if(user !&#x3D; &quot;&quot;)&#123; &#x2F;&#x2F; 存在Cookie</span><br><span class="line">                        alert(&quot;欢迎&quot; + user + &quot;再次访问&quot;);</span><br><span class="line">                    &#125;else&#123; &#x2F;&#x2F; 不存在cookie</span><br><span class="line">                        user &#x3D; prompt(&quot;你的名字:&quot;, &quot;&quot;); &#x2F;&#x2F; 提示框输入名字</span><br><span class="line">                        if(user !&#x3D; &quot;&quot; &amp;&amp; user !&#x3D; null)&#123;</span><br><span class="line">                            setcookie(&quot;username&quot;, user, 30); &#x2F;&#x2F; 设置保存30天的cookie</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body onload&#x3D;&quot;checkcookie()&quot;&gt;    </span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="2-简单的计时">2. 简单的计时</span></h3><ul>
<li>setTimeout(para , time)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;    </span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; onclick&#x3D;&quot;fun()&quot;&gt;点击2秒后显示&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function fun()&#123;</span><br><span class="line">            setTimeout(function()&#123;alert(&quot;2秒过去了&quot;)&#125;, 2000);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="3-无限循环的计时">3. 无限循环的计时</span></h3><ul>
<li>setTimeout(“timer()”, 1000)</li>
<li>clearTimeout(t)清除计时</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;    </span><br><span class="line">    </span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var timer_on &#x3D; 0; &#x2F;&#x2F; 计时器状态</span><br><span class="line">        var t &#x3D; 0; &#x2F;&#x2F; 初始值</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 计时器函数</span><br><span class="line">        function timer()&#123;</span><br><span class="line">            t &#x3D; t + 1;</span><br><span class="line">            document.getElementById(&quot;time_text&quot;).value&#x3D;t;</span><br><span class="line">            setTimeout(&quot;timer()&quot;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 判断计时器状态函数</span><br><span class="line">        function timer_status()&#123;</span><br><span class="line">            if(!timer_on)&#123;</span><br><span class="line">                timer_on &#x3D; 1;</span><br><span class="line">                timer();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type&#x3D;&quot;button&quot; value&#x3D;&quot;点击计时开始&quot; onclick&#x3D;&quot;timer_status()&quot; &#x2F;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;time_text&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="4-创建用于对象的模版">4. 创建用于对象的模版</span></h3><ul>
<li>对象:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">person &#123;</span><br><span class="line">    firstname:&quot;xx&quot;,</span><br><span class="line">    lastname:&quot;yy&quot;,</span><br><span class="line">    age:16,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;    </span><br><span class="line">    </span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function person(firstname, lastname, age)&#123;</span><br><span class="line">            this.firstname &#x3D; firstname;</span><br><span class="line">            this.lastname &#x3D; lastname;</span><br><span class="line">            this.age &#x3D; age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        the_person &#x3D; new person(&quot;Aye&quot;, &quot;T_T&quot;, &quot;17&quot;);</span><br><span class="line">        document.write(the_person.firstname + &quot; is&quot; + the_person.age)</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS图片居中</title>
    <url>/2019-08-05-tu-pian-ju-zhong-css.html</url>
    <content><![CDATA[<h2><span id="css-图片居中方式">CSS-图片居中方式</span></h2><h3><span id="html">html</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;pic&quot;&gt;</span><br><span class="line">    &lt;img src&#x3D;&quot;&#x2F;php&#x2F;images&#x2F;1.png&quot;&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>控制父级元素高、宽;</li>
<li>设置img占满父级元素</li>
</ul>
<a id="more"></a>

<h3><span id="css">css</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#pic&#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    width: 800px;</span><br><span class="line">    height: 400px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">img&#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript应用实例-下拉框</title>
    <url>/2019-08-05-xia-la-kuang-javascript.html</url>
    <content><![CDATA[<h2><span id="javascript应用实例2-下拉菜单">JavaScript应用实例(2)-下拉菜单</span></h2><p>参考：<a href="https://blog.csdn.net/u014175572/article/details/50325929" target="_blank" rel="noopener external nofollow noreferrer">js实现简单的下拉菜单</a></p>
<ul>
<li>html</li>
<li>css</li>
<li>javascript</li>
</ul>
<p>效果:</p>
<p><img src="/assets/images/blog/subMenu.png" alt="image"></p>
<a id="more"></a>

<h3><span id="html">html</span></h3><ul>
<li>使用结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;&lt;li&gt;</span><br><span class="line">        &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;&#x2F;li&gt;</span><br><span class="line">    </span><br><span class="line">        &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a&gt;&lt;&#x2F;a&gt;&lt;li&gt;</span><br><span class="line">        &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  	&lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">  	&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">  </span><br><span class="line">  	&lt;link type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;xiala.css&quot;&gt; </span><br><span class="line">	&lt;script src&#x3D;&quot;xiala.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;nav&quot;&gt;</span><br><span class="line">		&lt;ul&gt;</span><br><span class="line">			&lt;li&gt;</span><br><span class="line">				&lt;a href&#x3D;&quot;#&quot;&gt;一部分&lt;&#x2F;a&gt;</span><br><span class="line">			&lt;&#x2F;li&gt;</span><br><span class="line"></span><br><span class="line">			&lt;li onmouseover&#x3D;&quot;displaySubMenu(this)&quot; onmouseout&#x3D;&quot;hideSubMenu(this)&quot;&gt;</span><br><span class="line">				&lt;a href&#x3D;&quot;#&quot;&gt;二部分&lt;&#x2F;a&gt;</span><br><span class="line">				&lt;ul&gt;</span><br><span class="line">					&lt;li&gt;&lt;a href&#x3D;&quot;#&quot;&gt;2.1部分&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">					&lt;li&gt;&lt;a href&#x3D;&quot;#&quot;&gt;2.2部分&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">				&lt;&#x2F;ul&gt;</span><br><span class="line">			&lt;&#x2F;li&gt;</span><br><span class="line"></span><br><span class="line">			&lt;li onmouseover&#x3D;&quot;displaySubMenu(this)&quot; onmouseout&#x3D;&quot;hideSubMenu(this)&quot;&gt;</span><br><span class="line">				&lt;a href&#x3D;&quot;#&quot;&gt;三部分&lt;&#x2F;a&gt;</span><br><span class="line">				&lt;ul&gt;</span><br><span class="line">					&lt;li&gt;&lt;a href&#x3D;&quot;#&quot;&gt;3.1部分&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">					&lt;li&gt;&lt;a href&#x3D;&quot;#&quot;&gt;3.2部分&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">				&lt;&#x2F;ul&gt;</span><br><span class="line">			&lt;&#x2F;li&gt;</span><br><span class="line">		&lt;&#x2F;ul&gt;</span><br><span class="line"></span><br><span class="line">	&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="css">css</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">*&#123; margin:0px; padding:0px;&#125;</span><br><span class="line">body&#123;</span><br><span class="line">    font-family: &#39;Gill Sans&#39;, &#39;Gill Sans MT&#39;, Calibri, &#39;Trebuchet MS&#39;, sans-serif;</span><br><span class="line">    font-size: 1em;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav&#123;</span><br><span class="line">    width: 600px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    background-color: blanchedalmond;</span><br><span class="line">    text-align: center;</span><br><span class="line">    margin: 0 auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* 列表前的点消失 *&#x2F;</span><br><span class="line">ul&#123;</span><br><span class="line">    list-style: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ul li&#123;</span><br><span class="line">    float: left;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    width: 100px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* a去下划线 *&#x2F;</span><br><span class="line">a&#123;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    color: black;</span><br><span class="line">    display: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a:hover&#123;</span><br><span class="line">    color: aqua;</span><br><span class="line">    background-color: azure;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ul li ul li&#123;</span><br><span class="line">    float: none;</span><br><span class="line">    text-align: center;</span><br><span class="line">    background-color: bisque;</span><br><span class="line">    margin: 2px 0;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ul li ul&#123;</span><br><span class="line">    &#x2F;* 下拉部分消失 *&#x2F;</span><br><span class="line">    display: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3><span id="3-js">3. js</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function displaySubMenu(li)&#123;</span><br><span class="line">    var subMenu &#x3D; li.getElementsByTagName(&quot;ul&quot;)[0];</span><br><span class="line">    subMenu.style.display &#x3D; &quot;block&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function hideSubMenu(li)&#123;</span><br><span class="line">    var subMenu &#x3D; li.getElementsByTagName(&quot;ul&quot;)[0];</span><br><span class="line">    subMenu.style.display &#x3D; &quot;none&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript学习实例(2)</title>
    <url>/2019-08-04-javascript-xue-xi-shi-li-2.html</url>
    <content><![CDATA[<h2><span id="javascript学习实例2">JavaScript学习实例(2)</span></h2><p>参考：<a href="http://www.runoob.com/" target="_blank" rel="noopener external nofollow noreferrer">菜鸟教程</a></p>
<p>环境:</p>
<ul>
<li>html</li>
<li>代码为主要部分</li>
</ul>
<p>内容包括:</p>
<ul>
<li>JS函数、闭包,计数器</li>
<li>for (… in …){}遍历</li>
<li>onmouse事件</li>
<li>try{}catch(err){}捕获异常</li>
</ul>
<a id="more"></a>

<h3><span id="1-js函数-闭包">1. JS函数、闭包</span></h3><ul>
<li>点击按钮，调用计数器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; onclick&#x3D;&quot;fun()&quot;&gt;点击计数&lt;&#x2F;button&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;p id&#x3D;&quot;text&quot;&gt;0&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var add &#x3D; (function()&#123;</span><br><span class="line">            var counter &#x3D; 0;</span><br><span class="line">            return function () &#123;return counter +&#x3D; 1;&#125;</span><br><span class="line">        &#125;)();</span><br><span class="line"></span><br><span class="line">        function fun()&#123;</span><br><span class="line">            document.getElementById(&quot;text&quot;).innerHTML&#x3D;add();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="2-for-in-遍历">2. for (… in …){}遍历</span></h3><ul>
<li>遍历一个对象</li>
<li>输出属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; onclick&#x3D;&quot;fun()&quot;&gt;点击运行&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;p id&#x3D;&quot;text&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var txt &#x3D; &quot;&quot;;</span><br><span class="line">        var person &#x3D; &#123;</span><br><span class="line">            fname:&quot;C&quot;,</span><br><span class="line">            lname:&quot;xk&quot;,</span><br><span class="line">            like:&quot;sing, jump, rap and basketaball&quot;,</span><br><span class="line">        &#125;;</span><br><span class="line">        &#x2F;&#x2F; for (... in ...)遍历</span><br><span class="line">        function fun () &#123;</span><br><span class="line">            for (x in person) &#123;</span><br><span class="line">                txt &#x3D; txt + person[x];</span><br><span class="line">            &#125;</span><br><span class="line">            document.getElementById(&quot;text&quot;).innerHTML&#x3D;txt;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="3-onmouse事件">3. onmouse事件</span></h3><ul>
<li>onmouseover()</li>
<li>onmouseout()</li>
<li>…</li>
<li>鼠标移动到此区域和移出此区域的不同显示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;title&gt;JavaScript测试&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    #block1&#123;</span><br><span class="line">        width: 50px;</span><br><span class="line">        height: 50px;</span><br><span class="line">        background-color: green;</span><br><span class="line">        color: aliceblue;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">    #block2&#123;</span><br><span class="line">        </span><br><span class="line">        width: 50px;</span><br><span class="line">        height: 50px;</span><br><span class="line">        background-color: aqua;</span><br><span class="line">        color: black;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">    </span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;block1&quot; onmouseover&#x3D;&quot;Mover(this)&quot; onmouseout&#x3D;&quot;Mout(this)&quot;&gt;区域1&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">            function Mover (Obj) &#123;</span><br><span class="line">                Obj.innerHTML&#x3D;&quot;鼠标在上&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            function Mout (Obj) &#123;</span><br><span class="line">                Obj.innerHTML&#x3D;&quot;鼠标不在上&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="4-trycatcherr捕获异常">4. try{}catch(err){}捕获异常</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button id&#x3D;&quot;text&quot; onclick&#x3D;&quot;fun()&quot;&gt;点击显示错误信息&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">            function fun()&#123;</span><br><span class="line">                try&#123;</span><br><span class="line">                    allert(&quot;错误语句&quot;);</span><br><span class="line">                &#125;catch(err)&#123;</span><br><span class="line">                    alert(err.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript学习实例(1)</title>
    <url>/2019-08-03-javascript-xue-xi-shi-li-1.html</url>
    <content><![CDATA[<h2><span id="javascript学习实例1">JavaScript学习实例(1)</span></h2><p>环境:</p>
<ul>
<li>html</li>
<li>代码为主要部分</li>
</ul>
<p>内容包括:</p>
<ul>
<li>基础JavaScript实例</li>
</ul>
<ol>
<li>文本输出</li>
<li>用JavaScript改变HTML元素</li>
<li>html引用外部JavaScript</li>
<li>实例: 点击按钮改变html</li>
</ol>
<ul>
<li>JavaScript变量 与 if…else</li>
</ul>
<ol start="5">
<li>实例: 为html创建一个随机的链接</li>
</ol>
<ul>
<li>JavaScript 弹出框</li>
</ul>
<ol start="6">
<li>警告框</li>
<li>确认框</li>
<li>提示框</li>
</ol>
<a id="more"></a>

<h3><span id="基础javascript实例">基础JavaScript实例</span></h3><h4><span id="1-文本输出">1. 文本输出</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        document.write(Date());</span><br><span class="line">        document.write(&quot;测试&quot;)    </span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="2-用javascript改变html元素">2. 用JavaScript改变HTML元素</span></h4><ul>
<li>获取 id 的标签</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;h3 id&#x3D;&quot;text&quot;&gt;h3&lt;&#x2F;h3&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">        document.getElementById(&quot;text&quot;).innerHTML&#x3D;&quot;CCC&quot;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="3-html引用外部javascript">3. html引用外部JavaScript</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;file.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="4-实例-点击按钮改变html">4. 实例: 点击按钮改变html</span></h4><ul>
<li>构造js函数</li>
<li>button中onclick=”fun()”调用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;title&gt;JavaScript&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function fun()&#123;</span><br><span class="line">            document.getElementById(&quot;text&quot;).innerHTML&#x3D;&quot;改变&quot;;</span><br><span class="line">            document.write(&quot;&lt;p&gt;&lt;b&gt;加粗&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3 id&#x3D;&quot;text&quot;&gt;标题:h3&lt;&#x2F;h3&gt;</span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; onclick&#x3D;&quot;fun()&quot;&gt;点击改变&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="javascript变量-与-ifelse">JavaScript变量 与 if…else</span></h3><h4><span id="5-实例-为html创建一个随机的链接">5. 实例: 为html创建一个随机的链接</span></h4><ul>
<li>var x = Math.random();定义随机数变量 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;title&gt;JavaScript&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;p id&#x3D;&quot;text&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var x &#x3D; Math.random();</span><br><span class="line">        var r &#x3D; document.getElementById(&quot;text&quot;);</span><br><span class="line">        if (x &gt; 0.5) &#123;</span><br><span class="line">            r.innerHTML&#x3D;&quot;&lt;a href&#x3D;&#39;http:&#x2F;&#x2F;www.baidu.com&#39;&gt;百度&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            r.innerHTML&#x3D;&quot;&lt;a href&#x3D;&#39;http:&#x2F;&#x2F;www.google.com&#39;&gt;谷歌&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="javascript-弹出框">JavaScript 弹出框</span></h3><h4><span id="6-警告框">6. 警告框</span></h4><ul>
<li>alert()</li>
<li>\n 换行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;button onclick&#x3D;&quot;fun()&quot;&gt;点击&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function fun()&#123;</span><br><span class="line">            alert(&quot;警告框\n换行&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="7-确认框">7. 确认框</span></h4><ul>
<li>confirm()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button onclick&#x3D;&quot;fun()&quot;&gt;点击&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;p id&#x3D;&quot;text&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function fun()&#123;</span><br><span class="line">            var x &#x3D; confirm(&quot;点击确认&quot;);</span><br><span class="line">            if (x&#x3D;&#x3D;true) &#123;</span><br><span class="line">                document.getElementById(&quot;text&quot;).innerHTML&#x3D;&quot;点击了确认&quot;;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                document.getElementById(&quot;text&quot;).innerHTML&#x3D;&quot;点击了取消&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<h4><span id="8-提示框">8. 提示框</span></h4><ul>
<li>prompt()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button onclick&#x3D;&quot;fun()&quot;&gt;点击&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;p id&#x3D;&quot;text&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var t;</span><br><span class="line">        function fun()&#123;</span><br><span class="line">            var x &#x3D; prompt(&quot;输入名字&quot;, &quot;inno&quot;);</span><br><span class="line">            if (x !&#x3D; null &amp;&amp; x !&#x3D; &quot;&quot;) &#123;</span><br><span class="line">                t &#x3D; &quot;你好&quot; + x;</span><br><span class="line">            &#125;</span><br><span class="line">            document.getElementById(&quot;text&quot;).innerHTML&#x3D;t;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>php+Apache+mysql用户登录系统(1)</title>
    <url>/2019-08-01-php-apache-mysql-uls-1-yong-hu-deng-lu-xi-tong.html</url>
    <content><![CDATA[<p>php+Apache+mysql用户登录系统</p>
<p>说明:</p>
<ul>
<li>php7.0</li>
<li>apache2</li>
<li>数据库设计主键id为自动递增，插入数据时才能不手动插入id主键</li>
</ul>
<p>文件树:</p>
<ul>
<li>register.html注册</li>
<li>register.php</li>
<li>login.html登陆</li>
<li>login.php</li>
</ul>
<p>下篇文章:</p>
<p><a href="https://inno-hua.xyz/2019/07/31/php-password_hash().html" target="_blank" rel="noopener external nofollow noreferrer">PHP中password_hash()密码加密</a></p>
<a id="more"></a>

<h3><span id="简单版用户登陆系统">简单版用户登陆系统</span></h3><p>实现:</p>
<ul>
<li>简单注册登陆</li>
</ul>
<p>未考虑:</p>
<ul>
<li>验证方式</li>
<li>安全性等等</li>
</ul>
<h3><span id="1创建数据库及添加表">1.创建数据库及添加表</span></h3><p>以前文章：</p>
<p><a href="https://inno-hua.xyz/2019-07-31-ubuntu-php-mysql.html" target="_blank" rel="noopener external nofollow noreferrer">PHP新建用户数据库和表</a></p>
<h3><span id="2注册页面registerhtml">2.注册页面register.html</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;用户注册页面&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;p&gt;---------^-^注册啦^_^----------&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;form action&#x3D;&quot;register.php&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">            &lt;p&gt;用户名:&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">            &lt;p&gt;密  码: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;password&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;注册&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="3注册registerphp">3.注册register.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	header(&quot;Content-Type: text&#x2F;html; charset&#x3D;utf8&quot;);</span><br><span class="line">	&#x2F;&#x2F; 判断是否有submit操作</span><br><span class="line">	if(!isset($_POST[&#39;submit&#39;]))&#123;</span><br><span class="line">		exit(&quot;错误&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	$servername &#x3D; &quot;localhost&quot;;</span><br><span class="line">	$user &#x3D; &quot;root&quot;;</span><br><span class="line">	$password &#x3D; &quot;&quot;;</span><br><span class="line">	$dbname &#x3D; &quot;users&quot;;</span><br><span class="line">	&#x2F;&#x2F; 连接</span><br><span class="line">	$conn &#x3D; new mysqli($servername, $user, $password, $dbname);</span><br><span class="line">	if($conn-&gt;connect_error)&#123;</span><br><span class="line">		die(&quot;连接失败&quot; . $conn-&gt;connect_error);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	&#x2F;&#x2F; 注意varchar型变量加引号</span><br><span class="line"></span><br><span class="line">	&#x2F;&#x2F; 获取注册的name和password</span><br><span class="line">	$name &#x3D; $_POST[&#39;name&#39;];</span><br><span class="line">	$pwd &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line"></span><br><span class="line">	if($name &amp;&amp; $pwd)&#123;&#x2F;&#x2F; 如果用户名和密码都不为空</span><br><span class="line">		$sql &#x3D; &quot;INSERT INTO user(username, password) VALUES(&#39;$name&#39;, $pwd)&quot;;</span><br><span class="line">		$result &#x3D; $conn-&gt;query($sql);</span><br><span class="line">		if($result &#x3D;&#x3D;&#x3D; TRUE)&#123;</span><br><span class="line">			&#x2F;&#x2F;echo &quot;新纪录插入成功&quot;;</span><br><span class="line">			echo &quot;注册成功&quot;;</span><br><span class="line">			&#x2F;&#x2F; 跳去登录页面</span><br><span class="line">			&#x2F;&#x2F; 使用的是url</span><br><span class="line">			header(&quot;refresh:0;url&#x3D;&#39;login.html&#39;&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			echo &quot;注册失败&quot; . &quot;&lt;br&gt;&quot; . $conn-&gt;error;</span><br><span class="line">			&#x2F;&#x2F; 注册失败回到注册页面</span><br><span class="line">			echo &quot;&lt;script&gt;</span><br><span class="line">				window.location.href&#x3D;&#39;register.html&#39;</span><br><span class="line">			&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	$conn-&gt;close();</span><br><span class="line">	&#125;else&#123;&#x2F;&#x2F; 用户名或密码有空</span><br><span class="line">		echo &quot;&lt;script&gt;</span><br><span class="line">			alert(&#39;用户名或密码不能为空&#39;)</span><br><span class="line">			window.location.href&#x3D;&#39;register.html&#39;</span><br><span class="line">		&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="4登陆页面login">4.登陆页面login</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;用户登录页面&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;p&gt;-------:)登录吧(:-------&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;form action&#x3D;&quot;login.php&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">            &lt;p&gt;用户名:&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;name&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">            &lt;p&gt;密  码: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;password&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">            &lt;p&gt;&lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;登录&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3><span id="5登陆loginphp">5.登陆login.php</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	&#x2F;&#x2F; 判断是否提交submit</span><br><span class="line">	if(!isset($_POST[&#39;submit&#39;]))&#123;</span><br><span class="line">		exit(&quot;错误，未提交登录信息&quot;);</span><br><span class="line">	&#125; </span><br><span class="line">	$server &#x3D; &quot;localhost&quot;;</span><br><span class="line">	$user &#x3D; &quot;root&quot;;</span><br><span class="line">	$password &#x3D; &quot;&quot;;</span><br><span class="line">	$dbname &#x3D; &quot;users&quot;;</span><br><span class="line">	&#x2F;&#x2F; 连接数据库</span><br><span class="line">	$con &#x3D; new mysqli($server, $user, $password, $dbname);</span><br><span class="line">	if($con-&gt;connect_error)&#123;</span><br><span class="line">		die(&quot;连接数据库失败&quot; . $con-&gt;connect_error);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	&#x2F;&#x2F; 判断数据库中是否存在用户信息</span><br><span class="line">	$username &#x3D; $_POST[&#39;name&#39;];</span><br><span class="line">	$pwd &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line">	</span><br><span class="line">	&#x2F;&#x2F; 判断提交数据书否为空</span><br><span class="line">	if($username &amp;&amp; $pwd)&#123; &#x2F;&#x2F;如果用户名和密码都不为空</span><br><span class="line">		&#x2F;&#x2F; 查询语句</span><br><span class="line">		$sql &#x3D; &quot;SELECT * FROM user where username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$pwd&#39;&quot;;</span><br><span class="line">		&#x2F;&#x2F; 执行语句</span><br><span class="line">		$result &#x3D; $con-&gt;query($sql);</span><br><span class="line">		&#x2F;&#x2F; 获取返回的行数</span><br><span class="line">		$num_row &#x3D; $result-&gt;num_rows;</span><br><span class="line">		</span><br><span class="line">		if($num_row &#x3D;&#x3D; 1)&#123;&#x2F;&#x2F; 如果返回了一条数据</span><br><span class="line">			echo &quot;登录成功&quot;;</span><br><span class="line">			&#x2F;&#x2F; 跳转页面到wekcome.html</span><br><span class="line">			header(&quot;refresh:0; url&#x3D;welcome.html&quot;);</span><br><span class="line">		&#125;else &#123;</span><br><span class="line">			</span><br><span class="line">			echo &quot;&lt;script&gt;</span><br><span class="line">				alert(&#39;用户名或密码错误&#39;)</span><br><span class="line">				window.location.href &#x3D; &#39;login.html&#39;</span><br><span class="line">			&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;else&#123;&#x2F;&#x2F; 用户名或密码有空</span><br><span class="line">		echo &quot;&lt;script&gt;</span><br><span class="line">			alert(&#39;用户名或密码不能为空&#39;)</span><br><span class="line">			window.location.href&#x3D;&#39;login.html&#39;</span><br><span class="line">		&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>php apache mysql 用户登陆系统</tag>
      </tags>
  </entry>
  <entry>
    <title>ubuntu16.04, Apache+PHP+Mysql安装与卸载</title>
    <url>/2019-07-31-ubuntu-php-mysql.html</url>
    <content><![CDATA[<p>ubuntu16.04, Apache+PHP+Mysql的安装与卸载</p>
<p>说明:</p>
<ul>
<li>Apache2</li>
<li>php7.0</li>
<li>参考<a href="https://blog.csdn.net/wy_97/article/details/78045541" target="_blank" rel="noopener external nofollow noreferrer">阿里云ubuntu16.04实测配置【php+mysql+apache】</a></li>
<li>参考<a href="https://blog.csdn.net/heijinkuiba/article/details/78212728" target="_blank" rel="noopener external nofollow noreferrer">Ubuntu 16.04 下卸载 lnmp/lamp 方法</a></li>
</ul>
<p>注意事项:</p>
<ul>
<li>避免出现phpinfo();没有mysqli扩展</li>
</ul>
<a id="more"></a>

<h3><span id="安装">安装</span></h3><ol>
<li>更新apt</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get update</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>安装apache</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install apache2</span><br></pre></td></tr></table></figure>
<p>浏览器上输入localhost或服务器ip</p>
<p>出现apache首页</p>
<ol start="3">
<li>安装php7</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install php7.0</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>整合一下php和apache，安装插件</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install libapache2-mod-php7.0</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>安装MySQL</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get install mysql-server</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 检查端口是否为监听状态</span><br><span class="line">&#x2F;&#x2F; mysql 的socket处于 listen 状态则表示安装成功</span><br><span class="line">etstat -tap | grep mysql</span><br></pre></td></tr></table></figure>


<ol start="6">
<li><b>整合一下php和mysql</b></li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get install php7.0-mysql</span><br></pre></td></tr></table></figure>

<h3><span id="卸载">卸载</span></h3><ol>
<li>卸载apache2<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get --purge remove apache2*</span><br><span class="line">sudo apt-get autoremove apache2</span><br><span class="line">(--purge 是完全删除并且不保留配置文件）</span><br></pre></td></tr></table></figure></li>
<li>卸载php7.0</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get --purge remove php7.0*</span><br><span class="line">sudo apt-get autoremove php7.0*</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>卸载mysql</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get --purge remove mysql*</span><br><span class="line">sudo apt-get autoremove mysql*</span><br><span class="line"> </span><br><span class="line">## 最后清理残留文件：</span><br><span class="line">dpkg -l |grep ^rc|awk ’&#123;print $2&#125;’ |sudo xargs dpkg -P</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ubuntu-php-mysql ubuntu php mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP中password_hash()密码加密</title>
    <url>/2019-07-31-php-password-hash.html</url>
    <content><![CDATA[<h2><span id="php对登陆密码加密的方法">PHP对登陆密码加密的方法</span></h2><p>环境说明：</p>
<ul>
<li>php7.0</li>
<li>apache2</li>
<li><?php 代码 ?>

</li>
</ul>
<p>加密方法:</p>
<blockquote>
<ul>
<li>password_hash ($password, PASSWORD_BCRYPT, $options)</li>
<li>$password 需要加密的密码</li>
<li>PASSWORD_BCRYPT 加密方式</li>
<li>$options 可用于设置cost值和 salt值</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;例:</span><br><span class="line">$options &#x3D; [</span><br><span class="line">        &#39;cost&#39; &#x3D;&gt; 11,</span><br><span class="line">    ];</span><br></pre></td></tr></table></figure>

<p>验证哈希值与密码是否匹配</p>
<ul>
<li>password_verify($password, $hash)</li>
<li>参数为密码和加密后的哈希值</li>
</ul>
<a id="more"></a>

<h3><span id="1-查看服务器在不拖慢速度的最高cost值">1. 查看服务器在不拖慢速度的最高cost值</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;测试机器能够达到的最高cost</span><br><span class="line">	$time &#x3D; 0.1; &#x2F;&#x2F; 100毫秒</span><br><span class="line">	$cost &#x3D; 8;</span><br><span class="line">	do&#123;</span><br><span class="line">		$cost++;</span><br><span class="line">		$start &#x3D; microtime(true);</span><br><span class="line">		password_hash($password, PASSWORD_BCRYPT, [&#39;cost&#39; &#x3D;&gt; $cost]);</span><br><span class="line">		$end &#x3D; microtime(true);</span><br><span class="line"></span><br><span class="line">	&#125;while(($end - $start) &lt; $time);</span><br></pre></td></tr></table></figure>
<h3><span id="2-加密与验证加密后的哈希值与密码是否匹配">2. 加密与验证加密后的哈希值与密码是否匹配</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   &#x2F;&#x2F; 加密</span><br><span class="line">$hash &#x3D; password_hash($password, PASSWORD_BCRYPT, [&quot;cost&quot; &#x3D;&gt; 11]);</span><br><span class="line"></span><br><span class="line">echo &quot;$hash&quot; . &quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">&#x2F;&#x2F; 验证</span><br><span class="line">if(password_verify($password, $hash))&#123;</span><br><span class="line">	echo &quot;匹配&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	echo &quot;不匹配&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>php php密码加密</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP新建用户数据库和表</title>
    <url>/2019-07-31-php-mysql-create.html</url>
    <content><![CDATA[<p>环境说明: </p>
<ul>
<li>php7.0</li>
<li>apache2</li>
<li>以下代码均在<?php ?>标签中</li>
</ul>
<p>建库注意事项:</p>
<ul>
<li>数据库编码的设置</li>
<li>建表时引擎的设置</li>
</ul>
<a id="more"></a>

<h2><span id="1连接数据库">1.连接数据库</span></h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$server &#x3D; &quot;xxx.xx.xxx.xxx&quot;;</span><br><span class="line">	$user &#x3D; &quot;xx&quot;;</span><br><span class="line">	$password &#x3D; &quot;xxxxxxx&quot;;</span><br><span class="line">	&#x2F;&#x2F; 连接数据库服务</span><br><span class="line">	$con &#x3D; new mysqli($server, $user, $password);</span><br><span class="line">	&#x2F;&#x2F; 判断连接状态</span><br><span class="line">	if($con-&gt;connect_error)&#123;</span><br><span class="line">		die(&quot;数据库连接服务失败&quot; . $con-&gt;connect_error);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		echo &quot;数据库连接服务成功&quot;;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="2php新建数据库与表时设置编码">2.PHP新建数据库与表时设置编码</span></h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   &#x2F;&#x2F; 创建数据库</span><br><span class="line">$sqlCdb &#x3D; &quot;CREATE DATABASE users CHARACTER SET &#39;utf8&#39; COLLATE &#39;utf8_general_ci&#39;&quot;;</span><br><span class="line">&#x2F;&#x2F; 判断创建结果</span><br><span class="line">$resultCdb &#x3D;  $con-&gt;query($sqlCdb);</span><br><span class="line">if($resultCdb &#x3D;&#x3D;&#x3D; TRUE)&#123;</span><br><span class="line">	echo &quot;数据库创建成功&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	echo &quot;数据库创建失败&quot; . $con-&gt;error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 连接新建数据库</span><br><span class="line">$con-&gt;select_db(&#39;users&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 创建表</span><br><span class="line">$sqlCt &#x3D; &quot;CREATE TABLE user(</span><br><span class="line">	id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span><br><span class="line">	username VARCHAR(30) NOT NULL,</span><br><span class="line">	password VARCHAR(60) NOT NULL) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8&quot;;</span><br><span class="line">&#x2F;&#x2F; 判断建表结果</span><br><span class="line">$resultCt &#x3D; $con-&gt;query($sqlCt);</span><br><span class="line">if($resultCt &#x3D;&#x3D;&#x3D; TRUE)&#123;</span><br><span class="line">	echo &quot;&lt;br&gt;&quot; . &quot;建表成功&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	echo &quot;建表失败&quot; . $con-&gt;error;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>php连接mysql php mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(附录)</title>
    <url>/2019-07-26-arcgis-python-13.html</url>
    <content><![CDATA[<p>学习日志(附录) GIS程序员不可不知的Python功能</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>附录</b></p>
<ul>
<li>发送带附件电子邮件</li>
<li>连接FTP服务并操作文件</li>
<li>使用zipfile模块压缩文件</li>
<li>读取xml文档</li>
</ul>
<a id="more"></a>

<h3><span id="1发送带附件电子邮件">1.发送带附件电子邮件</span></h3><ul>
<li>smtplib</li>
<li>MIMEMultipart</li>
<li>MIMEText</li>
<li>MIMEApplication</li>
<li>qq邮箱需要设置打开SMTP，创建授权码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用qqmail发送带附件邮件</span><br><span class="line">定义函数实现</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">from smtplib import SMTP_SSL</span><br><span class="line">from email.mime.multipart import MIMEMultipart</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">from email.mime.application import MIMEApplication</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># 发送邮件的函数</span><br><span class="line">def mail(host_server, frm, pwd, to, subject, text, attach):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    host_server: 邮箱主机</span><br><span class="line">    Frm: 发送者邮箱</span><br><span class="line">    pwd: 密码</span><br><span class="line">    To: 接收邮箱</span><br><span class="line">    subject: 邮件主题</span><br><span class="line">    text: 邮件内容</span><br><span class="line">    attach: 附件</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # multipart多个部分的邮件</span><br><span class="line">    msg &#x3D; MIMEMultipart()</span><br><span class="line">    msg[&#39;Subject&#39;] &#x3D; subject</span><br><span class="line">    msg[&#39;From&#39;] &#x3D; frm</span><br><span class="line">    msg[&#39;To&#39;] &#x3D; to</span><br><span class="line"></span><br><span class="line">    # 文本部分</span><br><span class="line">    part &#x3D; MIMEText(text)</span><br><span class="line">    msg.attach(part)</span><br><span class="line"></span><br><span class="line">    # 附件部分</span><br><span class="line">    part &#x3D; MIMEApplication(open(attach, &#39;rb&#39;).read())</span><br><span class="line">    part.add_header(&#39;Content-Disposition&#39;, &#39;attachment&#39;, filename&#x3D;os.path.basename(attach))</span><br><span class="line">    msg.attach(part)</span><br><span class="line"></span><br><span class="line">    # 使用ssl连接邮箱服务器</span><br><span class="line">    print(&quot;连接服务器...&quot;)</span><br><span class="line">    smtp &#x3D; SMTP_SSL(host_server)</span><br><span class="line">    #set_debuglevel()是用来调试的。参数值为1表示开启调试模式，参数值为0关闭调试模式</span><br><span class="line">    #smtp.set_debuglevel(1)</span><br><span class="line">    smtp.ehlo(host_server)</span><br><span class="line">    # 登陆</span><br><span class="line">    #print(&quot;登陆...&quot;)</span><br><span class="line">    smtp.login(frm, pwd)</span><br><span class="line">    # 发送</span><br><span class="line">    smtp.sendmail(frm, to, msg.as_string())</span><br><span class="line">    print(&quot;发送成功&quot;)</span><br><span class="line">    smtp.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"># -----------参数-------------</span><br><span class="line"># 发送者邮箱、授权码</span><br><span class="line">user_send &#x3D; &#39;xxxxx@qq.com&#39;</span><br><span class="line">user_pwd &#x3D; &#39;xxxxxg&#39;</span><br><span class="line"></span><br><span class="line"># 接收邮箱</span><br><span class="line">receive &#x3D; &#39;1xxxxxx12@qq.com&#39;</span><br><span class="line"></span><br><span class="line"># 邮箱主机</span><br><span class="line">HOST &#x3D; &#39;smtp.qq.com&#39;</span><br><span class="line"># 主题</span><br><span class="line">sub &#x3D; &quot;Just a text&quot;</span><br><span class="line"># 内容</span><br><span class="line">txt &#x3D; &quot;Hello, This just a text with python SMTP&quot;</span><br><span class="line"># 附件</span><br><span class="line">_attach &#x3D; &quot;H:&#x2F;upUpStudy&#x2F;pythonGis&#x2F;text&#x2F;BrokenDataList.txt&quot;</span><br><span class="line"></span><br><span class="line">mail(HOST, user_send, user_pwd, receive, sub, txt, _attach)</span><br></pre></td></tr></table></figure>
<h3><span id="2-连接ftp服务并操作文件">2. 连接FTP服务并操作文件</span></h3><ul>
<li>ftplib模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">连接FTP服务并下载文件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import ftplib</span><br><span class="line">from ftplib import FTP</span><br><span class="line">import socket</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">ftp &#x3D; FTP()</span><br><span class="line">buffer_size &#x3D; 10000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 连接函数</span><br><span class="line">def connect_ftp(host, port, username, password):</span><br><span class="line">    try:</span><br><span class="line">        ftp.connect(host&#x3D;host, port&#x3D;port)</span><br><span class="line">        #ftp.set_pasv(False)</span><br><span class="line">        print((&quot;已连接到%s FTP服务&quot;).decode(&#39;utf-8&#39;) % host)</span><br><span class="line">        print(ftp.welcome)</span><br><span class="line">    except (socket.error, socket.gaierror), e:</span><br><span class="line">        print((&quot;无法访问%s FTP服务器&quot;).decode(&#39;utf-8&#39;) % host)</span><br><span class="line">        print(e)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        # 登陆</span><br><span class="line">        ftp.login(user&#x3D;username, passwd&#x3D;password)</span><br><span class="line">        print((&quot;登陆成功&quot;).decode(&#39;utf-8&#39;))</span><br><span class="line">    except (ftplib.error_perm), e:</span><br><span class="line">        print((&quot;登陆失败,%s&quot;).decode(&#39;utf-8&#39;) % e)</span><br><span class="line"></span><br><span class="line"># 中断连接</span><br><span class="line">def disconnect(ftp):</span><br><span class="line">    ftp.quit()</span><br><span class="line">    print(&quot;中断连接&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 获取目录</span><br><span class="line">def dir(ftp):</span><br><span class="line">    print((&quot;获取目录:&quot;).decode(&#39;utf-8&#39;))</span><br><span class="line">    ftp.dir()</span><br><span class="line"></span><br><span class="line"># 查找是否存在指定文件</span><br><span class="line">def find(ftp, filename):</span><br><span class="line">    print(&quot;查找...&quot;)</span><br><span class="line">    flist &#x3D; ftp.nlst()</span><br><span class="line">    if filename in flist:</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        return &quot;无此文件&quot;</span><br><span class="line"></span><br><span class="line">#上传文件</span><br><span class="line">def upload(ftp, filepath):</span><br><span class="line">    f &#x3D; open(filepath, &quot;rb&quot;)</span><br><span class="line">    file_name &#x3D; os.path.basename(filepath)</span><br><span class="line">    try:</span><br><span class="line">        ftp.storbinary(&#39;upload %s&#39; % file_name, f, buffer_size)</span><br><span class="line">        print(&#39;成功上传文件： &quot;%s&quot;&#39; % file_name)</span><br><span class="line">    except ftplib.error_perm:</span><br><span class="line">        return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"># 下载文件</span><br><span class="line">def download(ftp, filepath):</span><br><span class="line">    f &#x3D; open(filepath, &#39;wb&#39;).write</span><br><span class="line">    try:</span><br><span class="line">        ftp.retrbinary(&quot;RETR %s&quot; % filepath, f, buffer_size)</span><br><span class="line">        print(&quot;成功下载%s&quot; % filepath)</span><br><span class="line">    except ftp.error_perm:</span><br><span class="line">        return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    host &#x3D; &#39;xxx.xxx.xxx.239&#39;</span><br><span class="line">    port &#x3D; &#39;21&#39;</span><br><span class="line">    username &#x3D; &#39;xxxr&#39;</span><br><span class="line">    ftp_pwd &#x3D; &#39;xxxxx&#39;</span><br><span class="line">    filepath &#x3D; &quot;www&#x2F;htmx&#x2F;&quot;</span><br><span class="line">    # 连接登陆</span><br><span class="line">    connect_ftp(host, port, username, ftp_pwd)</span><br><span class="line"></span><br><span class="line">    #dir(ftp)</span><br><span class="line">    #find(ftp, &quot;www&#x2F;html&#x2F;zuahua&#x2F;index.html&quot;)</span><br><span class="line"></span><br><span class="line">    # 中断</span><br><span class="line">    disconnect(ftp)</span><br></pre></td></tr></table></figure>
<h3><span id="3使用zipfile模块压缩文件">3.使用zipfile模块压缩文件</span></h3><ul>
<li>zipfile模块</li>
<li>zipfile.ZIPFile()类</li>
<li>zipfile.ZIPFile().namelist()获取添加的文件</li>
<li>lst = os.listdir(path)获取路径下所有文件</li>
<li>string.endswith(‘xxx’) 以xxx结尾的string</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用zipfile模块压缩文件</span><br><span class="line">将路径下的以shp、dbf、shx结尾的文件添加到压缩文件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import zipfile</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># 压缩文件所在路径</span><br><span class="line">path &#x3D; &quot;H:&#x2F;ArcpyBook&#x2F;data&quot;</span><br><span class="line"></span><br><span class="line"># 创建压缩文件</span><br><span class="line">zfile &#x3D; zipfile.ZipFile(r&quot;H:\ArcpyBook\data\yasuo.zip&quot;, </span><br><span class="line">            &quot;w&quot;, zipfile.ZIP_DEFLATED)</span><br><span class="line"></span><br><span class="line"># 获取路径下所有文件</span><br><span class="line">files &#x3D; os.listdir(path)</span><br><span class="line"></span><br><span class="line"># 将以shp、dbf、shx结尾的文件写入压缩文件</span><br><span class="line">for f in files:</span><br><span class="line">    if f.endswith(&#39;shp&#39;) or f.endswith(&#39;dbf&#39;) or f.endswith(&#39;shx&#39;):</span><br><span class="line">        zfile.write(path + &quot;&#x2F;&quot; + f)</span><br><span class="line">    </span><br><span class="line"># 打印写入的文件</span><br><span class="line">for f in zfile.namelist():</span><br><span class="line">    print(&quot;added &quot; + f)</span><br><span class="line"></span><br><span class="line"># 关闭</span><br><span class="line">zfile.close()</span><br></pre></td></tr></table></figure>
<h3><span id="4读取xml文档">4.读取xml文档</span></h3><ul>
<li>from xml.dom import minidom</li>
<li>minidom.parse() 读取解析mxl文档</li>
<li>xmldoc.childNodes 获取所有子节点</li>
<li>getElementsByTagName()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">读取xml文档</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">from xml.dom import minidom</span><br><span class="line"></span><br><span class="line"># 读取解析mxl文档</span><br><span class="line">xmldoc &#x3D; minidom.parse(r&quot;H:\ArcpyBook\Appendix2\WitchFireResidenceDestroyed.xml&quot;)</span><br><span class="line"></span><br><span class="line"># 获取所有子节点</span><br><span class="line">childNodes &#x3D; xmldoc.childNodes</span><br><span class="line"></span><br><span class="line"># fire节点列表</span><br><span class="line">eList &#x3D; childNodes[0].getElementsByTagName(&quot;fire&quot;)</span><br><span class="line"></span><br><span class="line"># 遍历，判断&lt;fire&gt;节点中是否有address属性，输出</span><br><span class="line">for e in eList:</span><br><span class="line">    if e.hasAttribute(&quot;address&quot;):</span><br><span class="line">        print(e.getAttribute(&quot;address&quot;))</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(12)</title>
    <url>/2019-07-24-arcgis-python-12.html</url>
    <content><![CDATA[<p>学习日志12 使用Python实现ArcGis的高级功能</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第十二章</b></p>
<ul>
<li>使用Python构建HTTP响应请求并解析响应</li>
<li>使用ArcGis REST API和Python获取图层信息</li>
<li>使用ArcGis REST API和Python导出地图</li>
<li>使用ArcGis REST API和Python查询地图服务</li>
<li>使用Esri World Geocoding Service进行地理编码</li>
<li>使用FieldMappings和FieldMap,实现几个要素类的合并(Merge)</li>
<li>使用ValueTable讲多值输入到工具中作为参数</li>
</ul>
<a id="more"></a>

<h3><span id="1-使用python构建http响应请求并解析响应">1. 使用Python构建HTTP响应请求并解析响应</span></h3><ul>
<li>requests库</li>
<li>json库</li>
<li>requests.get(url)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- conding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">requests</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">gisurl &#x3D; &quot;http:&#x2F;&#x2F;server.arcgisonline.com&#x2F;arcgis&#x2F;rest&#x2F;services?f&#x3D;pjson&quot;</span><br><span class="line">#gisurl &#x3D; &quot;http:&#x2F;&#x2F;sampleserver1.arcgisonline.com&#x2F;ArcGIS&#x2F;rest&#x2F;services&#x2F;Demographics&#x2F;ESRI_Census_USA&#x2F;MapServer&#x2F;3&#x2F;query?text&#x3D;&amp;geometry&#x3D;&amp;geometryType&#x3D;esriGeometryPoint&amp;inSR&#x3D;&amp;spatialRel&#x3D;esriSpatialRelIntersects&amp;relationParam&#x3D;&amp;objectIds&#x3D;&amp;where&#x3D;STATE_FIPS%3D%2748%27+AND+CNTY_FIPS%3D%27021%27&amp;time&#x3D;&amp;returnCountOnly&#x3D;false&amp;returnIdsOnly&#x3D;false&amp;returnGeometry&#x3D;false&amp;maxAllowableOffset&#x3D;&amp;outSR&#x3D;&amp;outFields&#x3D;POP2000%2CPOP2007%2CBLKGRP&amp;f&#x3D;pjson&quot;</span><br><span class="line">r &#x3D; requests.get(gisurl)</span><br><span class="line">#print(r.text)</span><br><span class="line">decoded &#x3D; json.loads(r.text)</span><br><span class="line">print(decoded)</span><br></pre></td></tr></table></figure>
<h3><span id="2-使用arcgis-rest-api和python获取图层信息">2. 使用ArcGis REST API和Python获取图层信息</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用ArcGis REST API和Python获取图层信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">agisurl &#x3D; &quot;http:&#x2F;&#x2F;sampleserver1.arcgisonline.com&#x2F;ArcGIS&#x2F;rest&#x2F;services&#x2F;Demographics&#x2F;ESRI_Census_USA&#x2F;MapServer&#x2F;1&quot;</span><br><span class="line"># 参数</span><br><span class="line">payload &#x3D; &#123;&#39;where&#39;: &#39;STATE_FIPS &#x3D; \&#39;48\&#39; and CNTY_FIPS &#x3D; \&#39;021\&#39;&#39;, </span><br><span class="line">        &#39;returnCountyOnly&#39;: &#39;false&#39;, &#39;returnIdsOnly&#39;: &#39;false&#39;, &#39;returnGeometry&#39;: &#39;false&#39;, &#39;f&#39;: &#39;pjson&#39;&#125;</span><br><span class="line">r &#x3D; requests.get(agisurl, params&#x3D;payload)</span><br><span class="line"># r.text转为字典</span><br><span class="line">decoded &#x3D; json.loads(r.text)</span><br><span class="line"># 打印图层信息</span><br><span class="line">print(&quot;layer name is: &quot; + decoded[&#39;name&#39;])</span><br><span class="line">print(&quot;extent xmin: &quot; + str(decoded[&#39;extent&#39;][&#39;xmin&#39;]))</span><br><span class="line">print(&quot;extent ymin: &quot; + str(decoded[&#39;extent&#39;][&#39;ymin&#39;]))</span><br><span class="line">print(&quot;extent xmax: &quot; + str(decoded[&#39;extent&#39;][&#39;xmax&#39;]))</span><br><span class="line">print(&quot;extent ymax: &quot; + str(decoded[&#39;extent&#39;][&#39;ymax&#39;]))</span><br><span class="line">print(&quot;layer fields: &quot;)</span><br><span class="line">for field in decoded[&#39;fields&#39;]:</span><br><span class="line">    print(field[&#39;name&#39;])</span><br></pre></td></tr></table></figure>
<h3><span id="3使用arcgis-rest-api和python导出地图">3.使用ArcGis REST API和Python导出地图</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用ArcGis REST API和Python导出地图</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">gisurl &#x3D; &quot;http:&#x2F;&#x2F;sampleserver1.arcgisonline.com&#x2F;ArcGIS&#x2F;rest&#x2F;services&#x2F;Demographics&#x2F;ESRI_Census_USA&#x2F;MapServer&#x2F;export&quot;</span><br><span class="line"># 参数</span><br><span class="line">payload &#x3D; &#123;&#39;bbox&#39;: &#39;-115.8,30.4, 85.5,50.5&#39;,</span><br><span class="line">            &#39;size&#39;: &#39;800, 600&#39;,</span><br><span class="line">            &#39;imageSR&#39;: &#39;102004&#39;,</span><br><span class="line">            &#39;format&#39;: &#39;gif&#39;,</span><br><span class="line">            &#39;transparent&#39;: &#39;false&#39;,</span><br><span class="line">                &#39;f&#39;: &#39;pjson&#39;&#125;</span><br><span class="line">r &#x3D; requests.get(gisurl, params&#x3D;payload)</span><br><span class="line">print(r.text)</span><br><span class="line">print(json.loads(r.text))</span><br></pre></td></tr></table></figure>
<p>根据打印出的结果链接到浏览器中查看:</p>
<p><a href="http://sampleserver1b.arcgisonline.com/arcgisoutput/_ags_map0c93dc4727ad40e7b384668fd8a6c1bd.gif" target="_blank" rel="noopener external nofollow noreferrer">http://sampleserver1b.arcgisonline.com/arcgisoutput/_ags_map0c93dc4727ad40e7b384668fd8a6c1bd.gif</a></p>
<p><img src="/assets/images/blog/requests1.png" alt="image"></p>
<h3><span id="4-使用arcgis-rest-api和python查询地图服务">4. 使用ArcGis REST API和Python查询地图服务</span></h3><ul>
<li><a href="http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Census_USA/MapServer/1/query" target="_blank" rel="noopener external nofollow noreferrer">http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Demographics/ESRI_Census_USA/MapServer/1/query</a><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- codng:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用ArcGis REST API和Python查询地图服务</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">gisurl &#x3D; &quot;http:&#x2F;&#x2F;sampleserver1.arcgisonline.com&#x2F;ArcGIS&#x2F;rest&#x2F;services&#x2F;Demographics&#x2F;ESRI_Census_USA&#x2F;MapServer&#x2F;1&#x2F;query&quot;</span><br><span class="line"># 参数</span><br><span class="line">payload &#x3D; &#123;&#39;where&#39; : &#39;STATE_FIPS &#x3D; \&#39;48\&#39; and CNTY_FIPS &#x3D; \&#39;021\&#39;&#39;,</span><br><span class="line">            &#39;returnCountOnly&#39; : &#39;false&#39;,</span><br><span class="line">            &#39;returnIdsOnly&#39; : &#39;false&#39;,</span><br><span class="line">            &#39;returnGeometry&#39; : &#39;false&#39;,</span><br><span class="line">            &#39;outFields&#39; : &#39;POP2000, POP2007, BLKGRP&#39;,</span><br><span class="line">            &#39;f&#39; : &#39;pjson&#39;&#125;</span><br><span class="line">r &#x3D; requests.get(gisurl, params&#x3D;payload)</span><br><span class="line">print(r.text)</span><br><span class="line"># json转Python字典</span><br><span class="line">decoded &#x3D; json.loads(r.text)</span><br><span class="line"></span><br><span class="line"># 打印部分信息</span><br><span class="line">for rlst in decoded[&#39;features&#39;]:</span><br><span class="line">    print(&quot;Block Group: &quot; + str(rlst[&#39;attributes&#39;][&#39;BLKGRP&#39;]))</span><br><span class="line">    print(&quot;pop2000: &quot; + str(rlst[&#39;attributes&#39;][&#39;POP2000&#39;]))</span><br><span class="line">    print(&quot;pop2007: &quot; + str(rlst[&#39;attributes&#39;][&#39;POP2007&#39;]))</span><br></pre></td></tr></table></figure>
<h3><span id="5-使用esri-world-geocoding-service进行地理编码">5. 使用Esri World Geocoding Service进行地理编码</span></h3></li>
<li><a href="http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find" target="_blank" rel="noopener external nofollow noreferrer">http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用Esri World Geocoding Service进行地理编码</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">gisurl &#x3D; &quot;http:&#x2F;&#x2F;geocode.arcgis.com&#x2F;arcgis&#x2F;rest&#x2F;services&#x2F;World&#x2F;GeocodeServer&#x2F;find&quot;</span><br><span class="line">payload &#x3D; &#123;&#39;text&#39;: &#39;1202 Sand Wedge, San Antonio, TX, 78258&#39;,</span><br><span class="line">            &#39;f&#39;: &#39;pjson&#39;&#125;</span><br><span class="line">r &#x3D; requests.get(gisurl, params&#x3D;payload)</span><br><span class="line">print(r.text)</span><br><span class="line">decoded &#x3D; json.loads(r.text)</span><br><span class="line">print(&quot;the geocoded address: &quot; + decoded[&#39;locations&#39;][0][&#39;name&#39;])</span><br><span class="line">print(&quot;the longtitude: &quot; + str(decoded[&#39;locations&#39;][0][&#39;feature&#39;][&#39;geometry&#39;][&#39;x&#39;]))</span><br><span class="line">print(&quot;the longtitude: &quot; + str(decoded[&#39;locations&#39;][0][&#39;feature&#39;][&#39;geometry&#39;][&#39;y&#39;]))</span><br></pre></td></tr></table></figure>
<h3><span id="6-使用fieldmappings和fieldmap实现几个要素类的合并merge">6. 使用FieldMappings和FieldMap,实现几个要素类的合并(Merge)</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用FieldMappings和FieldMap</span><br><span class="line">实现几个要素类的合并(Merge)</span><br><span class="line">并将其中一个字段中的字符分割成三部分分别再创建字段存储保存</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data&quot;</span><br><span class="line">try:</span><br><span class="line">    # 输出要素类</span><br><span class="line">    outFeatureClass &#x3D; r&quot;H:\ArcpyBook\data\allTracts.shp&quot;</span><br><span class="line"></span><br><span class="line">    # 创建FieldMappings和FieldMap对象,FieldMap对象将用于存储州FIPS编码、县FIPS编码、人口普查区域字段的引用</span><br><span class="line">    fieldmappings &#x3D; arcpy.FieldMappings()</span><br><span class="line">    fldmap_STFIPS &#x3D; arcpy.FieldMap()</span><br><span class="line">    fldmap_CONFIPS &#x3D; arcpy.FieldMap()</span><br><span class="line">    fldmap_TRACT &#x3D; arcpy.FieldMap()</span><br><span class="line"></span><br><span class="line">    # 获取工作空间中县多边形要素列表</span><br><span class="line">    fclss &#x3D; arcpy.ListFeatureClasses(&quot;County*&quot;, &quot;Polygon&quot;)</span><br><span class="line"></span><br><span class="line">    # 创建ValueTable对象来存储需要合并的要素类,创建FieldMap输入字段，&quot;STFID&quot;包含州、县、人口普查</span><br><span class="line">    vTab &#x3D; arcpy.ValueTable()</span><br><span class="line">    for fc in fclss:</span><br><span class="line">        fieldmappings.addTable(fc) # 添加每个县的表</span><br><span class="line">        fldmap_STFIPS.addInputField(fc, &quot;STFID&quot;)</span><br><span class="line">        fldmap_CONFIPS.addInputField(fc, &quot;STFID&quot;)</span><br><span class="line">        fldmap_TRACT.addInputField(fc, &quot;STFID&quot;)</span><br><span class="line">        vTab.addRow(fc) # 添加行</span><br><span class="line"></span><br><span class="line">    # 处理输入的&quot;STFID&quot;字段，数字前两位是州FIPS编码，3-5个字符是县FIPS编码，6-13个字符是人口普查</span><br><span class="line">    for x in range(0, fldmap_STFIPS.inputFieldCount):</span><br><span class="line">        fldmap_STFIPS.setStartTextPosition(x, 0)</span><br><span class="line">        fldmap_STFIPS.setEndTextPosition(x, 1)</span><br><span class="line"></span><br><span class="line">    # 输出字段，并为name字段赋值</span><br><span class="line">    fld_STFIDS &#x3D; fldmap_STFIPS.outputField</span><br><span class="line">    fld_STFIDS.name &#x3D; &quot;STFIDS&quot;</span><br><span class="line">    fldmap_STFIPS.outputField &#x3D; fld_STFIDS</span><br><span class="line"></span><br><span class="line">    # COFIPS字段</span><br><span class="line">    for x in range(0, fldmap_CONFIPS.inputFieldCount):</span><br><span class="line">        fldmap_CONFIPS.setStartTextPosition(x, 2)</span><br><span class="line">        fldmap_CONFIPS.setEndTextPosition(x, 4)</span><br><span class="line">    fld_COFIDS &#x3D; fldmap_CONFIPS.outputField</span><br><span class="line">    fld_COFIDS.name &#x3D; &quot;COFIDS&quot;</span><br><span class="line">    fldmap_CONFIPS.outputField &#x3D; fld_COFIDS</span><br><span class="line"></span><br><span class="line">    # TRACT字段</span><br><span class="line">    for x in range(0, fldmap_TRACT.inputFieldCount):</span><br><span class="line">        fldmap_TRACT.setStartTextPosition(x, 5)</span><br><span class="line">        fldmap_TRACT.setEndTextPosition(x, 12)</span><br><span class="line">    fld_TRACT &#x3D; fldmap_TRACT.outputField</span><br><span class="line">    fld_TRACT.name &#x3D; &quot;TRACT&quot;</span><br><span class="line">    fldmap_TRACT.outputField &#x3D; fld_TRACT</span><br><span class="line"></span><br><span class="line">    # 将FieldMap对象添加到FieldMapping对象中</span><br><span class="line">    fieldmappings.addFieldMap(fldmap_STFIPS)</span><br><span class="line">    fieldmappings.addFieldMap(fldmap_CONFIPS)</span><br><span class="line">    fieldmappings.addFieldMap(fldmap_TRACT)</span><br><span class="line"></span><br><span class="line">    # 运行Merge工具，传入vTab、输出要素类和FieldMappings参数</span><br><span class="line">    arcpy.Merge_management(vTab, outFeatureClass, fieldmappings)</span><br><span class="line">    print(&quot;Merge completed&quot;)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="7-使用valuetable讲多值输入到工具中作为参数">7. 使用ValueTable讲多值输入到工具中作为参数</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*-coding:utf-8-*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用ValueTable讲多值输入到工具中</span><br><span class="line">这里以多环缓冲区工具为例</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data&quot;</span><br><span class="line"># 创建ValueTable对象</span><br><span class="line">vTab &#x3D; arcpy.ValueTable()</span><br><span class="line"></span><br><span class="line"># 设置三行，参数10,20,30</span><br><span class="line">vTab.setRow(0, &quot;10&quot;)</span><br><span class="line">vTab.setRow(1, &quot;20&quot;)</span><br><span class="line">vTab.setRow(2, &quot;30&quot;)</span><br><span class="line"></span><br><span class="line"># 单位</span><br><span class="line">bufferUnit &#x3D; &quot;meters&quot;</span><br><span class="line"></span><br><span class="line"># 输入要素与输出要素</span><br><span class="line">inFeature &#x3D; &quot;Hospitals.shp&quot;</span><br><span class="line">outFeature &#x3D; &quot;Hospitals_mulBuffer.shp&quot;</span><br><span class="line"></span><br><span class="line"># 距离参数ValueTable</span><br><span class="line">dist &#x3D; vTab</span><br><span class="line"></span><br><span class="line"># 调用多环缓冲区工具</span><br><span class="line">arcpy.MultipleRingBuffer_analysis(inFeature, outFeature, dist, bufferUnit, &#39;&#39;, &#39;ALL&#39;)</span><br><span class="line">print(&quot;multiple buffer completed&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(11)</title>
    <url>/2019-07-21-arcgis-python-11.html</url>
    <content><![CDATA[<p>学习日志11 异常识别和错误处理</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第十一章</b></p>
<ul>
<li>Python异常处理结构(try/except/else/finally)</li>
<li>使用arcpy.GetMessages()捕获详细的消息信息</li>
<li>根据严重性级别筛选消息</li>
<li>测试和响应特定错误消息</li>
</ul>
<a id="more"></a>

<h3><span id="1-python异常处理结构tryexceptelsefinally">1. Python异常处理结构(try/except/else/finally)</span></h3><ul>
<li>try语句中有错误时可在except语句中捕获具体的错误信息</li>
<li>else语句是在try语句没有错误时执行</li>
<li>finally语句无论try语句是否有错都会执行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">try&#x2F;except捕获错误信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data&quot;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    # 构建一个错误,缺少距离参数</span><br><span class="line">    arcpy.Buffer_analysis(&#39;Streams.shp&#39;, &#39;Streams_bf.shp&#39;)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br><span class="line"></span><br><span class="line"># 返回: ERROR 000735: 距离 [值或字段]: 值是必需的</span><br></pre></td></tr></table></figure>
<h3><span id="2-使用arcpygetmessages捕获详细的消息信息">2. 使用arcpy.GetMessages()捕获详细的消息信息</span></h3><ul>
<li>the function can’t really run in my PC.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">try&#x2F;except捕获错误信息</span><br><span class="line">使用arcpy.GetMessages()捕获详细的消息信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">try:</span><br><span class="line">    arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data&quot;</span><br><span class="line">    arcpy.Buffer_analysis(&quot;Streams.shp&quot;, &quot;streams_buffer.shp&quot;)</span><br><span class="line">except:</span><br><span class="line">    </span><br><span class="line">    print(arcpy.GetMessages())</span><br></pre></td></tr></table></figure>
<h3><span id="3-根据严重性级别筛选消息">3. 根据严重性级别筛选消息</span></h3><ul>
<li>arcpy.GetMessages(0/1/2)</li>
<li>0 :一般的消息</li>
<li>1 :警告</li>
<li>2 :错误</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">try:</span><br><span class="line">    arcpy.env.workspace &#x3D; &quot;c:&#x2F;ArcpyBook&#x2F;data&quot;</span><br><span class="line">    arcpy.Buffer_analysis(&quot;Streams.shp&quot;,&quot;Streams_Buff.shp&quot;)</span><br><span class="line">except:</span><br><span class="line">    print(arcpy.GetMessages(2))</span><br></pre></td></tr></table></figure>
<h3><span id="4-测试和响应特定错误消息">4. 测试和响应特定错误消息</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">try:</span><br><span class="line">    arcpy.env.workspace &#x3D; &quot;c:&#x2F;ArcpyBook&#x2F;data&quot;</span><br><span class="line">    arcpy.Buffer_analysis(&quot;Streams.shp&quot;, &quot;Streams_Buff.shp&quot;)</span><br><span class="line">except:</span><br><span class="line">    print(&quot;Error found in Buffer tool \n&quot;)</span><br><span class="line">    errCode &#x3D; arcpy.GetReturnCode(3)</span><br><span class="line">    if str(errCode) &#x3D;&#x3D; &quot;735&quot;:</span><br><span class="line">        print(&quot;Distance value not provided \n&quot;)</span><br><span class="line">        print(&quot;Running the buffer again with a default value \n&quot;)</span><br><span class="line">        defaultDistance &#x3D; &quot;100 Feet&quot;</span><br><span class="line">        arcpy.Buffer_analysis(&quot;Streams.shp&quot;, &quot;Streams_Buff&quot;, defaultDistance)</span><br><span class="line">        print(&quot;Buffer complete&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(10)</title>
    <url>/2019-07-21-arcgis-python-10.html</url>
    <content><![CDATA[<p>学习日志10 使用add-in定制Arcgis界面</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第十章</b></p>
<blockquote>
<p>Python Add-in Wizard 下载,解压运行/bin/..exe</p>
</blockquote>
<blockquote>
<p><a href="http://www.arcgis.com/home/item.html?id=5f3aefe77f6b4f61ad3e4c62f30bff3b" target="_blank" rel="noopener external nofollow noreferrer">http://www.arcgis.com/home/item.html?id=5f3aefe77f6b4f61ad3e4c62f30bff3b</a></p>
</blockquote>
<blockquote>
<p>Python Add-in Wizard是一个可视化界面工具,用于创建桌面Arcgis加载项</p>
</blockquote>
<ul>
<li>创建按钮加载项和使用Python加载项</li>
<li>安装测试加载项</li>
<li>创建工具加载项</li>
</ul>
<a id="more"></a>

<h3><span id="1创建按钮加载项和使用python加载项">1.创建按钮加载项和使用Python加载项</span></h3><p>本例创建一个按钮加载项,添加一些数据到数据框</p>
<ul>
<li>运行addin_assistant.exe</li>
</ul>
<p><img src="/assets/images/blog/pythonAddin1.png" alt="image"></p>
<p><img src="/assets/images/blog/pythonAddin2.png" alt="image"></p>
<p>添加按钮<br><img src="/assets/images/blog/pythonAddin3.png" alt="image"></p>
<p>保存文件/install中编辑addin-rootfile_addin.py</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">import pythonaddins</span><br><span class="line"></span><br><span class="line">class ButtonClassImportWildfires(object):</span><br><span class="line">    &quot;&quot;&quot;Implementation for addin-rootfile_addin.button (Button)&quot;&quot;&quot;</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.enabled &#x3D; True</span><br><span class="line">        self.checked &#x3D; False</span><br><span class="line">    def onClick(self):</span><br><span class="line">        layer_files &#x3D; pythonaddins.OpenDialog(&quot;Select layer to add&quot;, True, </span><br><span class="line">                r&quot;H:\ArcpyBook\data\Wildfires&quot;, &quot;Add&quot;)</span><br><span class="line">        mxd &#x3D; arcpy.mapping.MapDocument(&quot;current&quot;) # 获取mxd文档</span><br><span class="line">        df &#x3D; pythonaddins.GetSelectedTOCLayerOrDataFrame() # 获取数据框</span><br><span class="line">        if not isinstance(df, layer_files): # 判断类型是否相同</span><br><span class="line">            for layer_file in layer_files:</span><br><span class="line">                layer &#x3D; arcpy.mapping.Layer(layer_file)</span><br><span class="line">                # 往数据框添加layer</span><br><span class="line">                arcpy.mapping.AddLayer(df, layer)</span><br><span class="line">            else:</span><br><span class="line">                pythonaddins.MessageBox(&#39;Select a dataframe&#39;, &#39;info&#39;, 0)</span><br></pre></td></tr></table></figure>
<h3><span id="2-安装测试加载项">2. 安装测试加载项</span></h3><ol>
<li>打开加载项工作目录</li>
</ol>
<p><img src="/assets/images/blog/pythonAddin4.png" alt="image"></p>
<ol start="2">
<li>双击makeaddin.py以创建addin-rootfile.esriaddin</li>
<li>双击addin-rootfile.esriaddin</li>
</ol>
<p><img src="/assets/images/blog/pythonAddin5.png" alt="image"></p>
<p><img src="/assets/images/blog/pythonAddin6.png" alt="image"></p>
<p><img src="/assets/images/blog/pythonAddin7.png" alt="image"></p>
<ol start="4">
<li><b>注意</b><br>工具条出现<b>缺失</b>问题</li>
</ol>
<p><b>解决:将生成的xxxx.esriaddin文件放到C:\Users\username\Documents\ArcGIS\AddIns\Desktop10.6(对应版本下)</b></p>
<h3><span id="3-创建工具加载项">3. 创建工具加载项</span></h3><ul>
<li>功能: 在一个面要素内部创建随机点</li>
</ul>
<ol>
<li>同样使用Python Add-in工具</li>
<li>右击添加工具</li>
</ol>
<p><img src="/assets/images/blog/pythonAddin8.png" alt="image"></p>
<ol start="3">
<li>/install/下编辑Generate Random Point_addin.py文件，更改以下部分</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">import pythonaddins</span><br><span class="line"></span><br><span class="line">def __init__(self):</span><br><span class="line">  self.enabled &#x3D; True</span><br><span class="line">  self.cursor &#x3D; 3</span><br><span class="line">  self.shape &#x3D; &#39;Rectangle&#39;</span><br><span class="line"></span><br><span class="line">def onRectangle(self, rectangle_geometry):</span><br><span class="line">    extent &#x3D; rectangle_geometry</span><br><span class="line">    arcpy.env.workspace &#x3D; r&#39;c:\ArcpyBook\Ch10&#39;</span><br><span class="line">    if arcpy.Exists(&#39;randompts.shp&#39;):</span><br><span class="line">        arcpy.Delete_management(&#39;randompts.shp&#39;)</span><br><span class="line">        randompts &#x3D; arcpy.CreateRandomPoints_management(arcpy.env.workspace,&#39;randompts.shp&#39;,&quot;&quot;,rectangle_geometry)</span><br><span class="line">        arcpy.RefreshActiveView()</span><br><span class="line">    return randompts</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>运行makeaddin.py生成Generate Random Point.esriaddin</li>
<li>将Generate Random Point.esriaddin复制到C:\Users\username\Documents\ArcGIS\AddIns\Desktop10.6(对应版本下)</li>
<li>打开ArcMap10.6测试</li>
</ol>
]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(9)</title>
    <url>/2019-07-19-arcgis-python-9.html</url>
    <content><![CDATA[<p>学习日志9 获取GIS数据列表和描述</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第九章</b></p>
<ul>
<li>获取工作空间要素类列表</li>
<li>获取要素中的字段列表</li>
<li>使用Describe()函数返回要素类的描述性信息</li>
<li>实用Describe()函数返回栅格图像的描述性信息</li>
</ul>
<a id="more"></a>

<h3><span id="1-获取工作空间要素类列表">1. 获取工作空间要素类列表</span></h3><ul>
<li>arcpy.ListFeatureClasses({wild_card}, {feature_type}, {feature_dataset})</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">获取工作空间要素类列表</span><br><span class="line">arcpy.ListFeatureClasses(&#123;wild_card&#125;, &#123;feature_type&#125;, &#123;feature_dataset&#125;)</span><br><span class="line">三个可选参数,1:通配符,2:要素类型(点线面),3:数据集</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data\CityOfSanAntonio.gdb&quot;</span><br><span class="line">#　获取文件地理数据库中的要素类列表，限制以＂C＂开头</span><br><span class="line">fclist &#x3D; arcpy.ListFeatureClasses(&quot;C*&quot;)</span><br><span class="line"># 遍历输出</span><br><span class="line">for fc in fclist:</span><br><span class="line">    print(&quot;feature name:&#123;0&#125;&quot;.format(fc))</span><br></pre></td></tr></table></figure>
<h3><span id="2-获取要素中的字段列表">2. 获取要素中的字段列表</span></h3><ul>
<li>arcpy.ListFields(dataset, {wild_card}, {field_type})</li>
<li>必选参数: 输入要素</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">获取要素中的字段列表</span><br><span class="line">arcpy.ListFields(dataset, &#123;wild_card&#125;, &#123;field_type&#125;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data\CityOfSanAntonio.gdb&quot;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    # 获取要素的字段列表</span><br><span class="line">    fdlist &#x3D; arcpy.ListFields(&quot;BexarCountyBoundaries&quot;)</span><br><span class="line">    for fd in fdlist:</span><br><span class="line">        print(&quot;%s data type %s, data length: %i&quot; % (fd.name,</span><br><span class="line">                fd.type, fd.length))</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="3-使用describe函数返回要素类的描述性信息">3. 使用Describe()函数返回要素类的描述性信息</span></h3><ul>
<li>descFC = arcpy.Describe(“Burglary”)</li>
<li>Describe对象的属性很多，例:descFC.ShapeType, descFC.fields</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用Describe()函数返回要素类的描述性信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data\CityOfSanAntonio.gdb&quot;</span><br><span class="line"># 创建Describe()要素描述对象</span><br><span class="line">descFC &#x3D; arcpy.Describe(&quot;Burglary&quot;)</span><br><span class="line"># 打印对象信息</span><br><span class="line">print(&quot;the feature&#39;s shape type is &quot; + descFC.ShapeType)</span><br><span class="line"></span><br><span class="line"># 获取要素对象字段</span><br><span class="line">fcFields &#x3D; descFC.fields</span><br><span class="line">for field in fcFields:</span><br><span class="line">    print(&quot;name:&#123;0&#125;,datatype:&#123;1&#125;,length:&#123;2&#125;&quot;.format(field.name, field.type, str(field.length)))</span><br><span class="line"># 获取要素范围</span><br><span class="line">ext &#x3D; descFC.extent</span><br><span class="line">print(&quot;xmin:%s&quot; % ext.XMin)</span><br><span class="line">print(&quot;ymin:%s&quot; % ext.YMin)</span><br><span class="line">print(&quot;xmax:%s&quot; % ext.XMax)</span><br><span class="line">print(&quot;ymax:%s&quot; % ext.YMax)</span><br></pre></td></tr></table></figure>
<h3><span id="4-实用describe函数返回栅格图像的描述性信息">4. 实用Describe()函数返回栅格图像的描述性信息</span></h3><ul>
<li>descRaster = arcpy.Describe(“AUSTIN_EAST_NW.sid”)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- conding:uft-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">实用Describe()函数返回栅格图像的描述性信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data&quot;</span><br><span class="line">try:</span><br><span class="line">    # 创建描述性对象</span><br><span class="line">    descRaster &#x3D; arcpy.Describe(&quot;AUSTIN_EAST_NW.sid&quot;)</span><br><span class="line">    # 获取栅格对象的范围</span><br><span class="line">    ext &#x3D; descRaster.extent</span><br><span class="line">    print(&quot;xmin %f&quot; % ext.XMin)</span><br><span class="line">    print(&quot;ymin %f&quot; % ext.YMin)</span><br><span class="line">    print(&quot;xmax %f&quot; % ext.XMax)</span><br><span class="line">    print(&quot;ymax %f&quot; % ext.YMax)</span><br><span class="line">    # 获取栅格对象空间参考</span><br><span class="line">    sr &#x3D; descRaster.SpatialReference</span><br><span class="line">    print(sr.name) # 打印空间参考名</span><br><span class="line">    print(sr.type) # 打印空间类型名</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(8)</title>
    <url>/2019-07-18-arcgis-python-8.html</url>
    <content><![CDATA[<p>学习日志8     查询和选择数据</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第八章</b></p>
<ul>
<li>使用SearchCursor检索要素类中的要素</li>
<li>使用几何令牌参数的SearchCursor()</li>
<li>使用InsertCursor(),从文本文件读取数据给要素添加记录</li>
<li>UpdateCursor()创建对象,updateRow()方法更新表中每一行</li>
<li>UpdateCursor()对象的deleteRow(),删除特定记录</li>
<li>在编辑会话中插入和更新行</li>
<li>读取要素类中的几何信息</li>
<li>使用Walk()遍历目录</li>
</ul>
<a id="more"></a>

<h3><span id="1-使用searchcursor检索要素类中的要素">1. 使用SearchCursor检索要素类中的要素</span></h3><ul>
<li>arcpy.da.SearchCursor(“Schools.shp”, (“FACILITY”, “NAME”), ‘“FACILITY” = &#39;HIGH SCHOOL&#39;‘)</li>
</ul>
<p>参数1: 要素,表 </p>
<p>参数2: 返回哪些值字段</p>
<p>参数3: where子句,即限制条件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">arcpy.da.SearchCursor()</span><br><span class="line">查询要素类中的要素</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy.da</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8&quot;</span><br><span class="line"># 创建SearchCursor()</span><br><span class="line"></span><br><span class="line"># with arcpy.da.SearchCursor(&quot;Schools.shp&quot;, (&quot;FACILITY&quot;, &quot;NAME&quot;)) as cursor:</span><br><span class="line">#     for row in sorted(cursor):</span><br><span class="line"></span><br><span class="line">#         print(&quot;School facility and name:&quot; + row[0] + &quot; &quot; + row[1])</span><br><span class="line"></span><br><span class="line"># 创建SearchCursor() 并添加where子句</span><br><span class="line">with arcpy.da.SearchCursor(&quot;Schools.shp&quot;, (&quot;FACILITY&quot;, &quot;NAME&quot;), </span><br><span class="line">        &#39;&quot;FACILITY&quot; &#x3D; \&#39;HIGH SCHOOL\&#39;&#39;) as cursor:</span><br><span class="line">     for row in sorted(cursor):</span><br><span class="line">         print(&quot;name:&#123;0&#125;, facility:&#123;1&#125;&quot;.format(row[1], row[0]))</span><br></pre></td></tr></table></figure>
<h3><span id="2-使用几何令牌参数的searchcursor">2. 使用几何令牌参数的SearchCursor()</span></h3><ul>
<li>arcpy.da.SearchCursor(“coa_parcels.shp”, (“PY_FULL_OW”, “SHAPE@XY”))</li>
</ul>
<p>SHAPE@XY 返回 一组要素的质心 x,y 坐标。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用几何令牌</span><br><span class="line">SearchCursor()</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy.da</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8&quot;</span><br><span class="line">start &#x3D; time.clock() #　记录时间</span><br><span class="line"># 使用几何令牌进行游标搜索操作</span><br><span class="line"># SHAPE@XY 返回 一组要素的质心 x,y 坐标。</span><br><span class="line"></span><br><span class="line">with arcpy.da.SearchCursor(&quot;coa_parcels.shp&quot;, (&quot;PY_FULL_OW&quot;, &quot;SHAPE@XY&quot;)) as cursor:</span><br><span class="line">    for row in cursor:</span><br><span class="line">        print(&quot;PY_FULL_OW: &#123;0&#125;, Location: &#123;1&#125;&quot;.format(row[0], row[1]))</span><br><span class="line"></span><br><span class="line">elasped &#x3D; time.clock() - start</span><br><span class="line">print(&quot;\n用时: &quot; + str(elasped))</span><br></pre></td></tr></table></figure>
<h3><span id="3使用insertcursor从文本文件读取数据给要素添加记录">3.使用InsertCursor(),从文本文件读取数据给要素添加记录</span></h3><ul>
<li>arcpy.da.InsertCursor(“FireIncidents”, (“SHAPE@XY”, “CONFIDENCEVALUE”))</li>
<li>参数1：要素,表</li>
<li>参数2：Field字段, SHAPE@XY几何x,y坐标，”CONFIDENCEVALUE”字段名</li>
<li>cursor.insertRow([(latitude, longitude), confid]) 给InsertCursor对象插入行 </li>
<li>[(latitude, longitude), confid]对应(“SHAPE@XY”, “CONFIDENCEVALUE”)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用InsertCursor()</span><br><span class="line">从文本文件读取数据给要素添加记录</span><br><span class="line">文本文件为北美某地区荒地大火事件</span><br><span class="line">每行为纬度,经度,置信度</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">import arcpy.da</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb&quot;</span><br><span class="line"># 读取txt文件</span><br><span class="line">f &#x3D; open(r&quot;H:\ArcpyBook\Ch8\WildfireData\NorthAmericaWildfires_2007275.txt&quot;, &quot;r&quot;)</span><br><span class="line">lstfires &#x3D; f.readlines()</span><br><span class="line"># 创建InsertCursor()变量</span><br><span class="line">try:</span><br><span class="line">    with arcpy.da.InsertCursor(&quot;FireIncidents&quot;, (&quot;SHAPE@XY&quot;, &quot;CONFIDENCEVALUE&quot;)) as cursor:</span><br><span class="line">        cnt &#x3D; 1 # 计数</span><br><span class="line">        for lstRow in lstfires: # 遍历文件每一行</span><br><span class="line">            if &#39;Latitude&#39; in lstRow:</span><br><span class="line">                continue</span><br><span class="line">            vals &#x3D; lstRow.split(&#39;,&#39;) # 以 , 分割</span><br><span class="line">            latitude &#x3D; float(vals[0]) # 纬度</span><br><span class="line">            longitude &#x3D; float(vals[1]) # 经度</span><br><span class="line">            confid &#x3D; int(vals[2]) # 置信度</span><br><span class="line">            # 将要素每一行的插入数据保存</span><br><span class="line">            rowFire &#x3D; [(latitude, longitude), confid]</span><br><span class="line">            # 插入要素</span><br><span class="line">            cursor.insertRow(rowFire)</span><br><span class="line">            print(&quot;插入&#123;0&#125; 条记录&quot;.format(str(cnt)))</span><br><span class="line">            cnt &#x3D; cnt + 1</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br><span class="line">finally:</span><br><span class="line">    f.close() # 关闭文件</span><br></pre></td></tr></table></figure>
<h3><span id="4updatecursor创建对象updaterow方法更新表中每一行">4.UpdateCursor()创建对象,updateRow()方法更新表中每一行</span></h3><ul>
<li>arcpy.da.UpdateCursor(“FireIncidents”, (“CONFIDENCEVALUE”, “CONFID_RATING”))</li>
<li>参数1：要素,表</li>
<li>参数2：Field</li>
<li>AddField_management()  给表中添加字段:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">使用UpdateCursor()创建对象</span><br><span class="line">updateRow()方法更新表中每一行</span><br><span class="line">给表中添加字段: AddField_management()</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb&quot;</span><br><span class="line"># 添加字段</span><br><span class="line">arcpy.AddField_management(&quot;FireIncidents&quot;, &quot;CONFID_RATING&quot;, &quot;TEXT&quot;, &quot;10&quot;)</span><br><span class="line">print(&quot;添加字段CONFID_RATING成功&quot;)</span><br><span class="line">try:</span><br><span class="line">    # 创建UpdateCurSor()对象</span><br><span class="line">    with arcpy.da.UpdateCursor(&quot;FireIncidents&quot;, </span><br><span class="line">            (&quot;CONFIDENCEVALUE&quot;, &quot;CONFID_RATING&quot;)) as cursor:</span><br><span class="line">        cnt &#x3D; 1 # 计数</span><br><span class="line">        for row in cursor: # 遍历每一行</span><br><span class="line">            # 给新建字段CONFID_RATING赋值</span><br><span class="line">            if row[0] &lt;&#x3D; 40:</span><br><span class="line">                row[1] &#x3D; &#39;Poor&#39;</span><br><span class="line">            elif row[0] &gt; 40 and row[0] &lt;&#x3D; 60:</span><br><span class="line">                row[1] &#x3D; &#39;Fair&#39;</span><br><span class="line">            elif row[0] &gt; 60 and row[0] &lt;&#x3D; 85:</span><br><span class="line">                row[1] &#x3D; &#39;Good&#39;</span><br><span class="line">            else:</span><br><span class="line">                row[1] &#x3D; &#39;Excellent&#39;</span><br><span class="line">            # 调用updateRow()方法更新每一行</span><br><span class="line">            cursor.updateRow(row)</span><br><span class="line">            print(&quot;更新了&#123;0&#125;条记录&quot;.format(str(cnt)))</span><br><span class="line">            cnt &#x3D; cnt + 1</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="5-updatecursor对象的deleterow删除特定记录">5. UpdateCursor()对象的deleteRow(),删除特定记录</span></h3><ul>
<li>rcpy.da.UpdateCursor(“FireIncidents”, (“CONFID_RATING”), “[CONFID_RATING] = &#39;Poor&#39;“)</li>
<li>注意：个人地理数据库构建查询语句字段名使用[]括起来而不是””<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">UpdateCursor()对象的deleteRow()</span><br><span class="line">删除特定记录</span><br><span class="line">注意：个人地理数据库构建查询语句字段名使用[]括起来而不是&quot;&quot;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb&quot;</span><br><span class="line">try:</span><br><span class="line">    cnt &#x3D; 1 # 计数</span><br><span class="line">    # 构建UpdateCursor()对象</span><br><span class="line">    with arcpy.da.UpdateCursor(&quot;FireIncidents&quot;, (&quot;CONFID_RATING&quot;), </span><br><span class="line">            &quot;[CONFID_RATING] &#x3D; \&#39;Poor\&#39;&quot;) as cursor:</span><br><span class="line">        # 遍历返回的对象</span><br><span class="line">        for row in cursor:</span><br><span class="line">            cursor.deleteRow() # 删除当前行</span><br><span class="line">            print(&quot;删除&#123;0&#125;条记录&quot;.format(str(cnt)))</span><br><span class="line">            cnt &#x3D; cnt + 1</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="6在编辑会话中插入和更新行">6.在编辑会话中插入和更新行</span></h3></li>
<li>在编辑会话外的插入更新操作是不可更改的</li>
<li>在编辑会话中的操作是可以撤销的</li>
<li>edit = arcpy.da.Editor(r”H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb”)</li>
<li>edit.startEditing(True)</li>
<li>edit.stopEditing(True) 停止编辑,True表示保存操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">在编辑会话中使用插入和更新操作</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"></span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb&quot;</span><br><span class="line">try:</span><br><span class="line">    cnt &#x3D; 1 # 计数</span><br><span class="line">    # 构建编辑会话对象</span><br><span class="line">    edit &#x3D; arcpy.da.Editor(r&quot;H:\ArcpyBook\Ch8\WildfireData\WildlandFires.mdb&quot;)</span><br><span class="line">    edit.startEditing(True) # 开始编辑</span><br><span class="line">    with arcpy.da.UpdateCursor(&quot;FireIncidents&quot;, </span><br><span class="line">            (&quot;CONFIDENCEVALUE&quot;, &quot;CONFID_RATING&quot;)) as cursor:</span><br><span class="line">        for row in cursor: # 遍历</span><br><span class="line">            if row[0] &gt; 40 and row[0] &lt;&#x3D; 60:</span><br><span class="line">                row[1] &#x3D; &quot;GOOD&quot;</span><br><span class="line">            elif row[0] &gt; 60 and row[0] &lt;&#x3D; 80:</span><br><span class="line">                row[1] &#x3D; &quot;BETTER&quot;</span><br><span class="line">            else:</span><br><span class="line">                row[1] &#x3D; &quot;BEST&quot;</span><br><span class="line">            cursor.updateRow(row) # 更新操作</span><br><span class="line">            print(&quot;更新了&#123;0&#125;条记录&quot;.format(str(cnt)))</span><br><span class="line">            cnt &#x3D; cnt + 1</span><br><span class="line">    edit.stopEditing(True) # 停止编辑,True表示保存操作</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="7读取要素类中的几何信息">7.读取要素类中的几何信息</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">读取要素类的几何信息</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line"># 输入面要素</span><br><span class="line">infc &#x3D; r&quot;H:\ArcpyBook\data\CityOfSanAntonio.gdb\SchoolDistricts&quot;</span><br><span class="line"># 遍历要素的SearchCursor对象</span><br><span class="line">for row in arcpy.da.SearchCursor(infc, [&quot;OID@&quot;, &quot;SHAPE@&quot;]):</span><br><span class="line">    print(&quot;Object ID:&#123;0&#125;&quot;.format(row[0])) # 打印OID</span><br><span class="line">    partnum &#x3D; 0 # 计数</span><br><span class="line">    for part in row[1]: # 遍历几何信息的每一部分</span><br><span class="line">        print(&quot;partnum:&#123;0&#125;&quot;.format(partnum))</span><br><span class="line">        for pnt in part: # 遍历点</span><br><span class="line">            if pnt:</span><br><span class="line">                print(&quot;&#123;0&#125;,&#123;1&#125;&quot;.format(pnt.X, pnt.Y))</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;Interior Ring&quot;)</span><br><span class="line">        partnum &#x3D; partnum + 1</span><br></pre></td></tr></table></figure>
<h3><span id="8使用walk遍历目录">8.使用Walk()遍历目录</span></h3><ul>
<li>os.walk()返回文件目录树</li>
<li>arcpy.da.Walk()可以限制返回地理数据文件类型</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">arcpy.da.Walk()遍历目录树</span><br><span class="line">os.walk()返回一个三元组</span><br><span class="line">使用da.Walk()遍历目录树，限制输出要素类名</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy.da as da</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">f &#x3D; r&quot;H:\ArcpyBook\data&quot; </span><br><span class="line">print(&quot;os walk&quot;)</span><br><span class="line"># 使用os.walk()遍历目录树</span><br><span class="line">for root, dirs, names in os.walk(f):</span><br><span class="line">    for fname in names:</span><br><span class="line">        print(fname)</span><br><span class="line"></span><br><span class="line">print(&quot;&quot;)</span><br><span class="line">print(&quot;arcpy.da.Walk()&quot;)</span><br><span class="line"># 使用da.Walk()遍历目录树，限制输出要素类名</span><br><span class="line">for root, dirs, names in da.Walk(f, datatype&#x3D;&quot;FeatureClass&quot;):</span><br><span class="line">    for name in names:</span><br><span class="line">        fname &#x3D; os.path.join(root, name)</span><br><span class="line">        print(fname)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(7)</title>
    <url>/2019-07-16-arcgis-python-7.html</url>
    <content><![CDATA[<p>学习日志7     查询和选择数据</p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习<b>第七章</b></p>
<ul>
<li>查询前，创建要素类或表视图的内存副本</li>
<li>测试 按属性查询</li>
<li>按位置选择图层</li>
<li>结合 按属性选择与按位置选择</li>
</ul>
<a id="more"></a>

<h3><span id="1-查询前创建要素类或表视图的内存副本">1. 查询前，创建要素类或表视图的内存副本</span></h3><ul>
<li>arcpy.MakeFeatureLayer()</li>
<li>arcpy.MakeTableView()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line"># 设置工作空间</span><br><span class="line">arcpy.env.workspace &#x3D; &quot;H:&#x2F;ArcpyBook&#x2F;data&#x2F;CityOfSanAntonio.gdb&quot;</span><br><span class="line">try:</span><br><span class="line">    # 调用创建要素图层工具</span><br><span class="line">    #flayer &#x3D; arcpy.MakeFeatureLayer_management(&quot;Burglary&quot;, &quot;Burglary_layer&quot;)</span><br><span class="line"></span><br><span class="line">    # 创建表视图</span><br><span class="line">    fview &#x3D; arcpy.MakeTableView_management(&quot;Crime2009Table&quot;, &quot;Crime2009_Table&quot;)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="2测试-按属性查询">2.测试 按属性查询</span></h3><ul>
<li>arcpy.SelectLayerByAttribute_management()</li>
<li>arcpy.GetCount_management()  获取计数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">测试 按属性查询</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; &quot;H:&#x2F;ArcpyBook&#x2F;data&#x2F;CityOfSanAntonio.gdb&quot;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    # 查询语句</span><br><span class="line">    qry &#x3D; &#39;&quot;SVCAREA&quot; &#x3D; \&#39;North\&#39;&#39;</span><br><span class="line">    # 创建要素类的内存副本</span><br><span class="line">    flayer &#x3D; arcpy.MakeFeatureLayer_management(&quot;Burglary&quot;, &quot;Burglary_layer&quot;)</span><br><span class="line">    # 按属性查询</span><br><span class="line">    arcpy.SelectLayerByAttribute_management(flayer,&quot;NEW_SELECTION&quot;, qry)</span><br><span class="line">    # 获取结果数量</span><br><span class="line">    cnt &#x3D; arcpy.GetCount_management(flayer)</span><br><span class="line">    print(&quot;查询了&quot; + str(cnt) + &quot;条记录&quot;)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="3按位置选择图层">3.按位置选择图层</span></h3><ul>
<li>arcpy.SeletLayerByLocation()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">按位置选择图层</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import arcpy</span><br><span class="line">arcpy.env.workspace &#x3D; &quot;H:\\ArcpyBook\\data\\CityOfSanAntonio.gdb&quot;</span><br><span class="line">try:</span><br><span class="line">    # 创建Burglary的内存副本</span><br><span class="line">    flayer &#x3D; arcpy.MakeFeatureLayer_management(&quot;Burglary&quot;, &quot;Burglary_layer&quot;)</span><br><span class="line">    # 选择完全位于输入图层的Burglary元素</span><br><span class="line">    # arcpy.SelectLayerByLocation_management(flayer,&quot;COMPLETELY_WITHIN&quot;,</span><br><span class="line">    #     &quot;H:\\ArcpyBook\\Ch7\\EdgewoodSD.shp&quot;)</span><br><span class="line">    </span><br><span class="line">    # 按距离选择</span><br><span class="line">    arcpy.SelectLayerByLocation_management(flayer, &quot;WITHIN_A_DISTANCE&quot;,</span><br><span class="line">        &quot;H:\\ArcpyBook\\Ch7\\EdgewoodSD.shp&quot;, &quot;1 MILES&quot;)</span><br><span class="line"></span><br><span class="line">    # 打印出选择的数量</span><br><span class="line">    cnt &#x3D; arcpy.GetCount_management(flayer) # 获取计数</span><br><span class="line">    print(&quot;选择了&quot; + str(cnt) + &quot;个元素&quot;)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>
<h3><span id="4-结合-按属性选择与按位置选择">4. 结合 按属性选择与按位置选择</span></h3><p>结合 按属性选择与按位置选择</p>
<p><b>选出在Edgewood范围内的星期一的犯罪记录</b></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line"># 设置工作空间</span><br><span class="line">arcpy.env.workspace &#x3D; &quot;H:\\ArcpyBook\\data\\CityOfSanAntonio.gdb&quot;</span><br><span class="line">try:</span><br><span class="line">    # 创建犯罪记录图层副本</span><br><span class="line">    flayer &#x3D; arcpy.MakeFeatureLayer_management(&quot;Burglary&quot;,&quot;Burglary_layer&quot;)</span><br><span class="line">    # 按位置选择</span><br><span class="line">    arcpy.SelectLayerByLocation_management(flayer, &quot;COMPLETELY_WITHIN&quot;, </span><br><span class="line">        r&quot;H:\ArcpyBook\Ch7\EdgewoodSD.shp&quot;)</span><br><span class="line">    # 按属性选择</span><br><span class="line">    qry &#x3D; &#39;&quot;DOW&quot; &#x3D; \&#39;Mon\&#39;&#39;</span><br><span class="line">    arcpy.SelectLayerByAttribute_management(flayer, &quot;SUBSET_SELECTION&quot;, qry)</span><br><span class="line">    # 打印出选择出的数量</span><br><span class="line">    cnt &#x3D; arcpy.GetCount_management(flayer)</span><br><span class="line">    print(&quot;选择出了&quot; + str(cnt) + &quot;条记录&quot;)</span><br><span class="line"></span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(6)</title>
    <url>/2019-06-30-arcgis-python-6.html</url>
    <content><![CDATA[<p>学习日志 6    </p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习==第六章==</p>
<ul>
<li>创建自定义地理处理工具</li>
<li>创建Python工具箱</li>
</ul>
<p><strong>此章内容我未测试通过，发现就算使用书中所提供的代码也出现问题，有待解决</strong></p>
<a id="more"></a>

<h3><span id="1-创建自定义地理处理工具">1. 创建自定义地理处理工具</span></h3><p>描述：从文本文件读取数据，包括经度、纬度、属性值，文本文件以逗号分隔,如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Latitude,Longitude,Confidence</span><br><span class="line">18.102,-94.353,72</span><br><span class="line">19.3,-89.925,82</span><br><span class="line">19.31,-89.927,68</span><br></pre></td></tr></table></figure>
<p>将其读取出来保存为点要素类</p>
<p>新建工具箱步骤省略</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#Script to Import data to a feature class within a geodatabase</span><br><span class="line">import arcpy, os</span><br><span class="line">try:</span><br><span class="line">    outputFC &#x3D; arcpy.GetParameterAsText(0)</span><br><span class="line">    fClassTemplate &#x3D; arcpy.GetParameterAsText(1)</span><br><span class="line">    f &#x3D; open(arcpy.GetParameterAsText(2),&#39;r&#39;)</span><br><span class="line">    arcpy.CreateFeatureclass_management(os.path.dirname(outputFC), os.path.basename(outputFC),&quot;point&quot;,fClassTemplate)   </span><br><span class="line">    lstFires &#x3D; f.readlines()</span><br><span class="line">    with arcpy.da.InsertCursor(outputFC) as cur:</span><br><span class="line">        cntr &#x3D; 1</span><br><span class="line">        for fire in lstFires:</span><br><span class="line">            if &#39;Latitude&#39; in fire:</span><br><span class="line">                continue</span><br><span class="line">            vals &#x3D; fire.split(&quot;,&quot;)</span><br><span class="line">            latitude &#x3D; float(vals[0])</span><br><span class="line">            longitude &#x3D; float(vals[1])</span><br><span class="line">            confid &#x3D; int(vals[2])</span><br><span class="line">            pnt &#x3D; arcpy.Point(longitude, latitude)</span><br><span class="line">            feat &#x3D; cur.newRow()</span><br><span class="line">            feat.shape &#x3D; pnt</span><br><span class="line">            feat.setValue(&quot;CONFIDENCEVALUE&quot;, confid)</span><br><span class="line">            cur.insertRow(feat)</span><br><span class="line">            arcpy.AddMessage(&quot;Record number&quot; + str(cntr) + &quot;written to feature class&quot;)</span><br><span class="line">            cntr &#x3D; cntr + 1</span><br><span class="line">except:</span><br><span class="line">    print arcpy.GetMessages()</span><br><span class="line">finally:</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure>

<h3><span id="2-创建python工具箱">2. 创建Python工具箱</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">class Toolbox(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        &quot;&quot;&quot;Define the toolbox (the name of the toolbox is the name of the</span><br><span class="line">        .pyt file).&quot;&quot;&quot;</span><br><span class="line">        self.label &#x3D; &quot;Toolbox&quot;</span><br><span class="line">        self.alias &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">        # List of tool classes associated with this toolbox</span><br><span class="line">        self.tools &#x3D; [USGSDownload]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class USGSDownload(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        &quot;&quot;&quot;Define the tool (tool name is the name of the class).&quot;&quot;&quot;</span><br><span class="line">        self.label &#x3D; &quot;USGS Download&quot;</span><br><span class="line">        self.description &#x3D; &quot;Download from USGS ArcGIS Server instance&quot;</span><br><span class="line">        self.canRunInBackground &#x3D; False</span><br><span class="line"></span><br><span class="line">    def getParameterInfo(self):</span><br><span class="line"></span><br><span class="line">        &quot;&quot;&quot;Define parameter definitions&quot;&quot;&quot;</span><br><span class="line">        # First parameter</span><br><span class="line">        param0 &#x3D; arcpy.Parameter(</span><br><span class="line">            displayName&#x3D;&quot;ArcGIS Server Wildfire URL&quot;,</span><br><span class="line">            name&#x3D;&quot;url&quot;,</span><br><span class="line">            datatype&#x3D;&quot;GPString&quot;,</span><br><span class="line">            parameterType&#x3D;&quot;Required&quot;,</span><br><span class="line">            direction&#x3D;&quot;Input&quot;)</span><br><span class="line">        param0.value &#x3D; &quot;http:&#x2F;&#x2F;wildfire.cr.usgs.gov&#x2F;arcgis&#x2F;rest&#x2F;services&#x2F;geomac_dyn&#x2F;MapServer&#x2F;0&#x2F;query&quot;</span><br><span class="line"></span><br><span class="line">        # Second parameter</span><br><span class="line">        param1 &#x3D; arcpy.Parameter(</span><br><span class="line">            displayName&#x3D;&quot;Output Feature Class&quot;,</span><br><span class="line">            name&#x3D;&quot;out_fc&quot;,</span><br><span class="line">            datatype&#x3D;&quot;DEFeatureClass&quot;,</span><br><span class="line">            parameterType&#x3D;&quot;Required&quot;,</span><br><span class="line">            direction&#x3D;&quot;Input&quot;)</span><br><span class="line"></span><br><span class="line">        params &#x3D; [param0, param1]</span><br><span class="line">        return params</span><br><span class="line"></span><br><span class="line">    def isLicensed(self):</span><br><span class="line">        &quot;&quot;&quot;Set whether tool is licensed to execute.&quot;&quot;&quot;</span><br><span class="line">        return True</span><br><span class="line"></span><br><span class="line">    def updateParameters(self, parameters):</span><br><span class="line">        &quot;&quot;&quot;Modify the values and properties of parameters before internal</span><br><span class="line">        validation is performed.  This method is called whenever a parameter</span><br><span class="line">        has been changed.&quot;&quot;&quot;</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    def updateMessages(self, parameters):</span><br><span class="line">        &quot;&quot;&quot;Modify the messages created by internal validation for each tool</span><br><span class="line">        parameter.  This method is called after internal validation.&quot;&quot;&quot;</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    def execute(self, parameters, messages):</span><br><span class="line">        inFeatures &#x3D; parameters[0].valueAsText</span><br><span class="line">        outFeatureClass &#x3D; parameters[1].valueAsText</span><br><span class="line"></span><br><span class="line">        agisurl &#x3D; inFeatures</span><br><span class="line"></span><br><span class="line">        payload &#x3D; &#123; &#39;where&#39;: &#39;acres &gt; 5&#39;,&#39;f&#39;: &#39;pjson&#39;, &#39;outFields&#39;: &#39;latitude,longitude,fire_name,acres&#39;&#125;</span><br><span class="line"></span><br><span class="line">        r &#x3D; requests.get(inFeatures, params&#x3D;payload)</span><br><span class="line">        decoded &#x3D; json.loads(r.text)</span><br><span class="line"></span><br><span class="line">        with arcpy.da.InsertCursor(outFeatureClass, (&quot;SHAPE@XY&quot;, &quot;NAME&quot;, &quot;ACRES&quot;)) as cur:</span><br><span class="line">            cntr &#x3D; 1</span><br><span class="line">            for rslt in decoded[&#39;features&#39;]:</span><br><span class="line">                fireName &#x3D; rslt[&#39;attributes&#39;][&#39;fire_name&#39;]</span><br><span class="line">                latitude &#x3D; rslt[&#39;attributes&#39;][&#39;latitude&#39;]</span><br><span class="line">                longitude &#x3D; rslt[&#39;attributes&#39;][&#39;longitude&#39;]</span><br><span class="line">                acres &#x3D; rslt[&#39;attributes&#39;][&#39;acres&#39;]</span><br><span class="line">                cur.insertRow([(longitude,latitude),fireName, acres])</span><br><span class="line">                arcpy.AddMessage(&quot;Record number: &quot; + str(cntr) + &quot; written to feature class&quot;)</span><br><span class="line">                cntr &#x3D; cntr + 1</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(5)</title>
    <url>/2019-06-23-arcgis-python-5.html</url>
    <content><![CDATA[<p>学习日志 5    </p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习==第五章==   </p>
<ul>
<li>使用脚本执行地理处理工具-Clip_analysis为例</li>
<li>将一个工具的输出作为一个工具的输入</li>
</ul>
<a id="more"></a>

<h3><span id="1-使用脚本执行地理处理工具-clip_analysis为例">1. 使用脚本执行地理处理工具-Clip_analysis为例</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 使用工具箱工具</span><br><span class="line">import arcpy</span><br><span class="line"># 裁剪学区</span><br><span class="line"># 输入要素</span><br><span class="line">in_features &#x3D; r&quot;H:\ArcpyBook\data\CityOfSanAntonio.gdb\Burglary&quot;</span><br><span class="line"># 裁剪要素</span><br><span class="line">clip_features &#x3D; r&quot;H:\ArcpyBook\Ch5\EdgewoodSD.shp&quot;</span><br><span class="line"># 输出要素</span><br><span class="line">out_featuresClass &#x3D; r&quot;H:\ArcpyBook\Ch5\ClpBurglary&quot;</span><br><span class="line">arcpy.Clip_analysis(in_features, clip_features, out_featuresClass)</span><br></pre></td></tr></table></figure>
<h3><span id="2-将一个工具的输出作为一个工具的输入">2. 将一个工具的输出作为一个工具的输入</span></h3><p>思路: 通过buffer工具输出距溪流半英里的缓冲区</p>
<p>再使用SelectLayerByLocation_management()工具选出在缓冲区中的学校点</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line"># 设置工作空间</span><br><span class="line">arcpy.env.workspace &#x3D; r&quot;H:\ArcpyBook\data\TravisCounty&quot;</span><br><span class="line"># 使用try语句添加溪流、溪流缓冲区、距离、学校等变量</span><br><span class="line">try:</span><br><span class="line">    streams &#x3D; &quot;Streams.shp&quot; # 溪流</span><br><span class="line">    streamsBuffer &#x3D; &quot;StreamsBuffer.shp&quot; # 溪流缓冲区变量</span><br><span class="line">    distance &#x3D; &quot;2640 feet&quot; # 距离</span><br><span class="line">    schools &#x3D; &quot;Schools.shp&quot; # 学校</span><br><span class="line">    schoolsLyrFile &#x3D; &quot;SchoolsLyr&quot; # 用来存放临时学校图层</span><br><span class="line">    arcpy.Buffer_analysis(streams, streamsBuffer, distance, &quot;FULL&quot;, &quot;ROUND&quot;, &quot;ALL&quot;)</span><br><span class="line">    # 创建一个临时图层</span><br><span class="line">    arcpy.MakeFeatureLayer_management(schools, schoolsLyrFile)</span><br><span class="line">    # 按位置选择图层</span><br><span class="line">    arcpy.SelectLayerByLocation_management(schoolsLyrFile, &quot;INTERSECT&quot;, streamsBuffer)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(e.message)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>初恋-玉置浩二</title>
    <url>/2019-06-22-chu-lian-yu-zhi-hao-er.html</url>
    <content><![CDATA[<ul>
<li>歌名: 初恋</li>
<li>唱: 玉置浩二</li>
<li><a href="https://www.xiami.com/song/1773641047" target="_blank" rel="noopener external nofollow noreferrer">词源</a></li>
</ul>
<a id="more"></a>


<ul>
<li>五月雨は緑色 <blockquote>
<p>Sa mi da re wa mi do ri i ro</p>
<p>梅雨染上了绿色</p>
</blockquote>
</li>
<li>悲しくされたよ<blockquote>
<p>Ka na shi ku sa re ta yo</p>
<p>更平添了一份感伤</p>
</blockquote>
</li>
<li>一人の午後は <blockquote>
<p>hi to ri no go go wa</p>
<p>一个人的午后</p>
</blockquote>
</li>
<li>恋をして寂しくて <blockquote>
<p>Ko i wo shi te sa bi shi ku te</p>
<p>恋爱着 而寂寞着</p>
</blockquote>
</li>
<li>届かぬ想いを暖めていた <blockquote>
<p>To do ka nu o mo i wo a ta ta me te i ta</p>
<p>无法传达的思念被阳光暖化</p>
</blockquote>
</li>
<li>好きだよと言えずに　初恋は <blockquote>
<p>su ki da yo to i e zu ni ha tsu ko i wa</p>
<p>爱在心头口难开的初恋啊</p>
</blockquote>
</li>
<li>ふりこ細工の心 <blockquote>
<p>fu ri ko sai ku no ko ko ro</p>
<p>那是纤细而摇摆不定的心</p>
</blockquote>
</li>
<li>放課後の校庭を　走る君がいた <blockquote>
<p>hou ka go no kou tei wo ha shi ru ki mi ga i ta</p>
<p>放学后的操场上 是奔跑着的你</p>
</blockquote>
</li>
<li>遠くで僕はいつでも君を探してた <blockquote>
<p>too ku de boku wa itsu demo kimi wo saga shi teta</p>
<p>我总是远远地 寻觅着你的身影</p>
</blockquote>
</li>
<li>浅い夢だから　胸をはなれない <blockquote>
<p>a sai yume da kara mune wo hana re nai</p>
<p>只缘梦太浅 故而情难禁</p>
</blockquote>
</li>
<li>夕映えはあんず色 <blockquote>
<p>yuu bae wa an zu iro</p>
<p>夕阳映照下杏色的天空</p>
</blockquote>
</li>
<li>帰り道一人 口笛吹いて <blockquote>
<p>kae ri michi hi tori kuchi bue fu ite</p>
<p>回家的路上 是独自吹着口哨的你</p>
</blockquote>
</li>
<li>名前さえ呼べなくて <blockquote>
<p>na mae sae yobe naku te</p>
<p>连你的名字都叫不出口</p>
</blockquote>
</li>
<li>とらわれた心見つめていたよ <blockquote>
<p>tora ware ta kokoro mitsu mete ita yo </p>
<p>我远远地凝视着 那被你夺去的心</p>
</blockquote>
</li>
<li>好きだよと言えずに　初恋は <blockquote>
<p>su ki da yo to i e zu ni ha tsu ko i wa</p>
<p>爱在心头口难开的初恋啊</p>
</blockquote>
</li>
<li>ふりこ細工の心 <blockquote>
<p>fu ri ko sai ku no ko ko ro</p>
<p>那是纤细而摇摆不定的心</p>
</blockquote>
</li>
<li>風に舞った花びらが　水面を乱すように <blockquote>
<p>kaze ni matta hana bira ga mina mo wo mida su you ni</p>
<p>如随风舞落的花瓣 扰乱了水面般</p>
</blockquote>
</li>
<li>愛という字書いてみては <blockquote>
<p>ai to iu ji ka ite mite wa</p>
<p>就连试着在纸上写爱这个字</p>
</blockquote>
</li>
<li>ふるえてたあの頃 <blockquote>
<p>furu ete ta ano goro</p>
<p>都会不由颤抖的那个年纪</p>
</blockquote>
</li>
<li>浅い夢だから　胸をはなれない <blockquote>
<p>a sai yume da kara mune wo hana re nai</p>
<p>只缘梦太浅 故而情难禁</p>
</blockquote>
</li>
<li>放課後の校庭を　走る君がいた <blockquote>
<p>hou ka go no kou tei wo ha shi ru ki mi ga i ta</p>
<p>放学后的操场上 是奔跑着的你</p>
</blockquote>
</li>
<li>遠くで僕はいつでも君を探してた <blockquote>
<p>too ku de boku wa itsu demo kimi wo saga shi teta</p>
<p>我总是远远地 寻觅着你的身影</p>
</blockquote>
</li>
<li>浅い夢だから　胸をはなれない <blockquote>
<p>a sai yume da kara mune wo hana re nai</p>
<p>只缘梦太浅 故而情难禁</p>
</blockquote>
</li>
</ul>
]]></content>
      <tags>
        <tag>歌</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(4)</title>
    <url>/2019-06-21-arcgis-python-4.html</url>
    <content><![CDATA[<p>学习日志 4    </p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版); </p>
<p>学习==第四章==   </p>
<ul>
<li>打印文档中的所有布局元素</li>
<li>打印布局元素，限制为图例元素</li>
<li>更新布局元素属性</li>
<li>获取可用的打印机列表</li>
<li>使用PrintMap()打印地图</li>
<li>导出地图为PDF文件</li>
<li>导出地图为图像文件</li>
<li>导出图层报表</li>
<li>使用数据驱动页面和arcpy.mapping模块构建地图册</li>
<li>将地图文档发布为ArcGIS Server服务</li>
</ul>
<a id="more"></a>

<h3><span id="1-打印文档中的所有布局元素">1. 打印文档中的所有布局元素</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 打印文档中的所有布局元素</span><br><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 打印</span><br><span class="line">for el in mapping.ListLayoutElements(mxd):</span><br><span class="line">    if el !&#x3D; &#39;&#39;:</span><br><span class="line">        print(el.name)</span><br></pre></td></tr></table></figure>

<h3><span id="2-打印布局元素限制为图例元素">2. 打印布局元素，限制为图例元素</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">## 打印布局元素，限制为图例</span><br><span class="line">for el in mapping.ListLayoutElements(mxd, &quot;LEGEND_ELEMENT&quot;, &quot;*Crime*&quot;):</span><br><span class="line">    print(el.name)</span><br></pre></td></tr></table></figure>

<h3><span id="3-更新布局元素属性">3. 更新布局元素属性</span></h3><blockquote>
<ul>
<li>使用Legend对象的 title 属性程序化地更改Crime图例的标题</li>
<li>并获取部分图例的图层列表</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 获取文档中包含Crime的图例元素</span><br><span class="line">elLeg &#x3D; mapping.ListLayoutElements(mxd, &quot;LEGEND_ELEMENT&quot;, &quot;*Crime*&quot;)[0]</span><br><span class="line"># 更改图例标题名</span><br><span class="line">elLeg.title &#x3D; &quot;Crime by School District&quot;</span><br><span class="line"># 打印图例图层列表名</span><br><span class="line">for item in elLeg.listLegendItemLayers():</span><br><span class="line">    print(item.name)</span><br></pre></td></tr></table></figure>
<h3><span id="4-获取可用的打印机列表">4. 获取可用的打印机列表</span></h3><ul>
<li>arcpy.mapping.ListPrinterNames() 获取打印机列表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 打印获取的打印机列表</span><br><span class="line">for printName in mapping.ListPrinterNames():</span><br><span class="line">    print(printName)</span><br></pre></td></tr></table></figure>

<h3><span id="5-使用printmap打印地图">5. 使用PrintMap()打印地图</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 遍历数据框，打印指定数据框的图片(打印机打印)</span><br><span class="line">for df in mapping.ListDataFrames(mxd):</span><br><span class="line">    if df.name &#x3D;&#x3D; &quot;Test_Performance&quot;:</span><br><span class="line">        print(&quot;ok!!&quot;)</span><br><span class="line">        mapping.PrintMap(mxd, &quot;&quot;, df)</span><br></pre></td></tr></table></figure>
<h3><span id="6-导出地图为pdf文件">6. 导出地图为PDF文件</span></h3><ul>
<li>arcpy.mapping.ExportToPDF()</li>
</ul>
<p>默认导出页面布局；可传入参数导出指定数据框</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 导出布局视图为PDF</span><br><span class="line">mapping.ExportToPDF(mxd, r&quot;H:\upUpStudy\pythonGis\text\CrimeLayout_PDF.pdf&quot;)</span><br></pre></td></tr></table></figure>

<h4><span id="61-导出地图为pdf文件导出指定数据框">6.1 导出地图为PDF文件,导出指定数据框</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&#39;current&#39;)</span><br><span class="line"># 导出指定数据框的PDF</span><br><span class="line">for df in mapping.ListDataFrames(mxd):</span><br><span class="line">    if df.name &#x3D;&#x3D; &quot;Crime&quot;:</span><br><span class="line">        df.referenceScale &#x3D; df.scale</span><br><span class="line">        mapping.ExportToPDF(mxd, r&quot;H:\upUpStudy\pythonGis\text\CrimeDataFrame.pdf&quot;, df)</span><br></pre></td></tr></table></figure>
<h3><span id="7-导出地图为图像文件">7. 导出地图为图像文件</span></h3><ul>
<li>mapping.ExportToAI(mxd, pathfile, df)</li>
<li>mapping.ExportToBMP(mxd, pathfile, df)</li>
<li>mapping.ExportToEMF(mxd, pathfile, df)</li>
<li>mapping.ExportToEPS(mxd, pathfile, df)</li>
<li>mapping.ExportToGIF(mxd, pathfile, df)</li>
<li>mapping.ExportToJPEG(mxd, pathfile, df)</li>
<li>mapping.ExportToSVG(mxd, pathfile, df)</li>
<li>mapping.ExportToTIFF(mxd, pathfile, df)</li>
<li>…</li>
</ul>
<h3><span id="8-导出图层报表">8. 导出图层报表</span></h3><p>一些新的方法</p>
<ul>
<li>os.getcwd() 获取当前路径</li>
<li>os.remove(pdfPath) 移除pdfpath文件</li>
<li>arcpy.mapping.PDFDocumentCreate(pdfPath) 创建这个PDF文档</li>
<li>lyr.definitionQuery(whereClause) 图层根据属性查询</li>
<li>arcpy.SelectLayerByAttribute_management(lyr, “NEW_SELECTION”, whereClause) 根据属性查询语句选择</li>
<li>导出报表为PDF</li>
<li>arcpy.mapping.ExportReport(report_source=lyr, report_layout_file=path + r”\CrimeReport.rlf”, output_file=path + r”\temp” + str(pageCount) + “.pdf”, starting_page_number=pageCount)</li>
<li>PDFDocment.appendPages(path + r”\temp” + str(pageCount) + “.pdf”) 将报表pdf追加到创建的PDF文档中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">import os</span><br><span class="line"># 获取当前路径</span><br><span class="line">path &#x3D; os.getcwd()</span><br><span class="line"># 创建输出的PDF文件</span><br><span class="line">pdfPath &#x3D; path + r&quot;\CrimeReport.pdf&quot;</span><br><span class="line">print(pdfPath)#######测试</span><br><span class="line"># 如果存在此文件就移除</span><br><span class="line">if os.path.exists(pdfPath):</span><br><span class="line">    os.remove(pdfPath)</span><br><span class="line">    </span><br><span class="line"># 利用.PDFDocumentCreate()创建此文件</span><br><span class="line">pdfDoc &#x3D; arcpy.mapping.PDFDocumentCreate(pdfPath)</span><br><span class="line"># 创建学区列表，通过遍历列表为每个地区创建报表</span><br><span class="line">districtList &#x3D; [&quot;Harlandale&quot;, &quot;East Central&quot;, &quot;Edgewood&quot;,</span><br><span class="line">                &quot;Alamo Heights&quot;, &quot;South San Antonio&quot;, &quot;Southside&quot;,</span><br><span class="line">                &quot;Ft Sam Houston&quot;, &quot;North East&quot;, &quot;Northside&quot;, &quot;Lackland&quot;,</span><br><span class="line">                &quot;Southwest&quot;, &quot;Judson&quot;, &quot;San Antonio&quot;]</span><br><span class="line"># 引用地图文档及其相应数据框与图层</span><br><span class="line">mxd &#x3D; arcpy.mapping.MapDocument(r&quot;H:\ArcpyBook\Ch4\Crime_Ch4.mxd&quot;)</span><br><span class="line">df &#x3D; arcpy.mapping.ListDataFrames(mxd)[0]</span><br><span class="line">lyr &#x3D; arcpy.mapping.ListLayers(mxd, &quot;Crime Density by School District&quot;, df)[0]</span><br><span class="line"># 使用循环遍历学区，并在内部使用whereClause变量定义表达式来显示单个学区</span><br><span class="line">pageCount &#x3D; 1</span><br><span class="line">for district in districtList:</span><br><span class="line">    # 查询表达式</span><br><span class="line">    whereClause &#x3D; &quot;\&quot;NAME\&quot; &#x3D; &#39;&quot; + district + &quot; ISD&#39;&quot;</span><br><span class="line">    lyr.definitionQuery &#x3D; whereClause</span><br><span class="line">    # 选择显示的单个学区,将数据框的范围设置为学区范围，并清除选择集</span><br><span class="line">    arcpy.SelectLayerByAttribute_management(lyr, &quot;NEW_SELECTION&quot;, whereClause)</span><br><span class="line">    df.extent &#x3D; lyr.getSelectedExtent()</span><br><span class="line">    arcpy.SelectLayerByAttribute_management(lyr, &quot;CLEAR_SELECTION&quot;)</span><br><span class="line">    # 导出数据框为BMP文件</span><br><span class="line">    arcpy.mapping.ExportToBMP(mxd, path + r&quot;\DistrictPicture.bmp&quot;, df)</span><br><span class="line">    # 调用ExportReport()函数生成报表</span><br><span class="line">    print(&quot;Generate report for: &quot; + district + &quot; ISD&quot;)</span><br><span class="line">    arcpy.mapping.ExportReport(report_source&#x3D;lyr, report_layout_file&#x3D;path + r&quot;\CrimeReport.rlf&quot;, output_file&#x3D;path + r&quot;\temp&quot; + str(pageCount) + &quot;.pdf&quot;, starting_page_number&#x3D;pageCount)</span><br><span class="line">    #追加报表为PDF文件</span><br><span class="line">    print(&quot;Append page: &quot; + str(pageCount))</span><br><span class="line">    pdfDoc.appendPages(path + r&quot;\temp&quot; + str(pageCount) + &quot;.pdf&quot;)</span><br><span class="line">    # 删除临时的pdf报表</span><br><span class="line">    os.remove(path + r&quot;\temp&quot; + str(pageCount) + &quot;.pdf&quot;)</span><br><span class="line">    pageCount &#x3D; pageCount + 1</span><br><span class="line"></span><br><span class="line"># 保存pdf文档</span><br><span class="line">pdfDoc.saveAndClose()</span><br><span class="line">del mxd</span><br></pre></td></tr></table></figure>
<h3><span id="9-使用数据驱动页面和arcpymapping模块构建地图册">9. 使用数据驱动页面和arcpy.mapping模块构建地图册</span></h3><blockquote>
<p>待解决，未测试成功,可能由于mxd文档丢失数据源的问题</p>
<p>程序思路如下</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy</span><br><span class="line">import os</span><br><span class="line"># 创建一个输出目录变量</span><br><span class="line">outDir &#x3D; r&quot;H:\ArcpyBook\Ch4&quot;</span><br><span class="line">finalpdf_filename &#x3D; outDir + r&quot;\MapBook.pdf&quot;</span><br><span class="line">if os.path.exists(finalpdf_filename):</span><br><span class="line">    os.remove(finalpdf_filename)</span><br><span class="line">    </span><br><span class="line">finalPdf &#x3D; arcpy.mapping.PDFDocumentCreate(finalpdf_filename) # 创建PDF文档</span><br><span class="line">print(&quot;Append Title Page \n&quot;)</span><br><span class="line">finalPdf.appendPages(outDir + r&quot;\TitlePage.pdf&quot;)</span><br><span class="line"># 添加索引图到PDF</span><br><span class="line">print(&quot;Append Index Page \n&quot;)</span><br><span class="line">finalPdf.appendPages(outDir + r&quot;\MapIndex.pdf&quot;)</span><br><span class="line"># 先将数据驱动页面导出到临时的PDF中，然后将其添加到最终的PDF中</span><br><span class="line">mxdPath &#x3D; outDir + r&quot;\Topographic.mxd&quot;</span><br><span class="line">mxd &#x3D; arcpy.mapping.MapDocument(mxdPath)</span><br><span class="line">print(&quot;Create Data Driven Page \n&quot;)</span><br><span class="line">ddp &#x3D; mxd.dataDrivenPages</span><br><span class="line">temp_filename &#x3D; outDir + r&quot;\tempDDP.pdf&quot;</span><br><span class="line">if os.path.exists(temp_filename):</span><br><span class="line">    os.remove(temp_filename)</span><br><span class="line">    </span><br><span class="line">ddp.exportToPDF(temp_filename, &quot;ALL&quot;)</span><br><span class="line">print(&quot;Append the map series \n&quot;)</span><br><span class="line">finalPdf.appendPages(temp_filename)</span><br><span class="line"># 更新最终的PDF属性</span><br><span class="line">finalPdf.updateDocProperties(pdf_open_view&#x3D;&quot;USE_THUMBS&quot;, pdf_layout&#x3D;&quot;SINGLE_PAGE&quot;)</span><br><span class="line"># 保存PDF</span><br><span class="line">finalPdf.saveAndClose()</span><br><span class="line"># 删除临时的数据驱动页面文件</span><br><span class="line">if os.path.exists(temp_filename):</span><br><span class="line">    os.remove()</span><br></pre></td></tr></table></figure>

<h3><span id="10-将地图文档发布为arcgis-server服务">10. 将地图文档发布为ArcGIS Server服务</span></h3><p>在Python中将地图文档发布到ArcGIS Server需要三步:</p>
<blockquote>
<ol>
<li>调用arcpy.mapping中的CreateMapSDDraft()函数，将地图文档文件mxd转换为服务定义草稿文件(.sddraft)</li>
<li>调用StageService Tool(.sd，过渡服务工具，编译能成功发布GIS资源的所必要的信息)</li>
<li>使用Upload Service Definition Tool(上传服务定义工具)上传服务定义文件</li>
</ol>
</blockquote>
<blockquote>
<ul>
<li>待解决的问题：未上传</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">wrkspc &#x3D; r&quot;H:\ArcpyBook\Ch4&quot;</span><br><span class="line">mxd &#x3D; mapping.MapDocument(wrkspc + r&quot;\Crime.mxd&quot;)</span><br><span class="line"># 定义服务名称和服务定义草稿文件</span><br><span class="line">service &#x3D; &#39;Crime&#39;</span><br><span class="line">sddraft &#x3D; wrkspc + service + &quot;.sddraft&quot;</span><br><span class="line"># 创建服务定义草稿文件</span><br><span class="line">mapping.CreateMapSDDraft(mxd, sddraft, service)</span><br><span class="line"># 分析草稿文件</span><br><span class="line">analysis &#x3D; mapping.AnalyzeForSD(wrkspc + &quot;Crime.sddraft&quot;)</span><br><span class="line"># 创建循环结构，遍历所有潜在的一般信息类的消息、警告和错误，并输出所有信息</span><br><span class="line">for key in (&#39;messages&#39;, &#39;warnings&#39;, &#39;errors&#39;):</span><br><span class="line">    print(&quot;----&quot; + key.upper() + &quot;----&quot;)</span><br><span class="line">    vars &#x3D; analysis[key]</span><br><span class="line">    for ((message, code), layerlist) in vars.iteritems():</span><br><span class="line">        print(&quot;    &quot;, message, &quot;(CODE %i)&quot; % code)</span><br><span class="line">        print(&quot;    applies to:&quot;,)</span><br><span class="line">        for layer in layerlist:</span><br><span class="line">            print(layer.name)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>今日から思い出</title>
    <url>/2019-06-20-jin-ri-karasi-ichu.html</url>
    <content><![CDATA[<ul>
<li>热爱之所爱</li>
<li>学思之所学</li>
</ul>
<ul>
<li>今日から思い出</li>
<li>Aimer</li>
</ul>
<a id="more"></a>


<ul>
<li>今日から思い出<blockquote>
<p>kyou kara omoide</p>
<p>从今天开始的回忆</p>
</blockquote>
</li>
<li>素敌な思い出<blockquote>
<p>suteki na omoide</p>
<p>美好的回忆</p>
</blockquote>
</li>
<li>明日はもう一人だ<blockquote>
<p>ashita wa mou hitori da</p>
<p>明天开始就孤单一人了</p>
</blockquote>
</li>
<li>これから　一人だ<blockquote>
<p>kore kara hitori da</p>
<p>从今往后 独自一人</p>
</blockquote>
</li>
<li>すべては思い出<blockquote>
<p>subete wa omoide</p>
<p>一切都是回忆</p>
</blockquote>
</li>
<li>悲しい思い出<blockquote>
<p>kanashii omoide</p>
<p>伤感的回忆</p>
</blockquote>
</li>
<li>明日は そう どこかへ<blockquote>
<p>ashita wa sou dokokahe</p>
<p>明天也不知该去哪里</p>
</blockquote>
</li>
<li>どこかへ 远くへ<blockquote>
<p>dokokahe toukuhe</p>
<p>肯定是遥远的某个地方</p>
</blockquote>
</li>
<li>电话のむこう<blockquote>
<p>denwa no mukou</p>
<p>在电话的另一头</p>
</blockquote>
</li>
<li>ママが泣いてた<blockquote>
<p>mama ga naiteta</p>
<p>妈妈哭了起来</p>
</blockquote>
</li>
<li>「大丈夫？」って いった<blockquote>
<p>daijoubu tte itta</p>
<p>我问了一声「没事吧?」</p>
</blockquote>
</li>
<li>ズルイな 先に泣くから<blockquote>
<p>zuruina saki ni naku kara</p>
<p>好狡猾啊 因为你先哭了起来</p>
</blockquote>
</li>
<li>私はもう 泣けなくなるよ<blockquote>
<p>watashi wa mou nake naku naru yo</p>
<p>我就已经无法哭泣</p>
</blockquote>
</li>
<li>今 あなたの声を 闻くことできるなら<blockquote>
<p>ima anata no koe wo kiku koto dekiru nara</p>
<p>如果现在 能听到你的声音的话</p>
</blockquote>
</li>
<li>「爱してる」の一言を<blockquote>
<p>aishiteru no hitokoto wo</p>
<p>「我爱你」这一句话</p>
</blockquote>
</li>
<li>言ってほしい<blockquote>
<p>itte hoshii</p>
<p>希望你能说出来</p>
</blockquote>
</li>
<li>言ってほしい<blockquote>
<p>itte hoshii</p>
<p>希望你能说出来</p>
</blockquote>
</li>
<li>今 あなたに言叶 送ることできるなら<blockquote>
<p>ima anata ni kotoba okuru koto dekiru nara</p>
<p>如果现在 我说的话语还能传达给你</p>
</blockquote>
</li>
<li>「生まれ変わっても<blockquote>
<p>umare kawatte mo</p>
<p>「就算转世以后</p>
</blockquote>
</li>
<li>また一绪にいたい」<blockquote>
<p>mata isshyoni itai</p>
<p>我还是想和你在一起」</p>
</blockquote>
</li>
<li>もう会えないなんて…<blockquote>
<p>mou aenai nante …</p>
<p>不想相信再也无法见面什么的…</p>
</blockquote>
</li>
<li>今日から思い出<blockquote>
<p>kyou kara omoide</p>
<p>从今天起一切都是回忆</p>
</blockquote>
</li>
<li>それでも思い出<blockquote>
<p>sore demo omoide</p>
<p>尽管如此 也是回忆</p>
</blockquote>
</li>
<li>いつかは そう 一人だ<blockquote>
<p>itsuka wa sou hitori da</p>
<p>不知何时 只剩下我一个人</p>
</blockquote>
</li>
<li>それなら どうして<blockquote>
<p>sore nara doushite</p>
<p>如果是这样 那为什么</p>
</blockquote>
</li>
<li>窓のむこう  あなたが见えた<blockquote>
<p>mado no mukou anata ga mieta</p>
<p>在窗户的另一边 我看到了你</p>
</blockquote>
</li>
<li>「大丈夫？」って いうの？<blockquote>
<p>daijoubu tte iuno</p>
<p>是否在问我 「没事吧?」</p>
</blockquote>
</li>
<li>ヒドイな そう闻かれたら<blockquote>
<p>hidoi na sou kikare tara</p>
<p>好过分啊 如果被这样问的话</p>
</blockquote>
</li>
<li>私はもう 泣けなくなるよ<blockquote>
<p>watashi wa mou nake naku naru yo</p>
<p>我就无法哭泣了</p>
</blockquote>
</li>
<li>今 あなたの声を 闻くことできるなら<blockquote>
<p>ima anata no koe wo kiku koto dekiru nara</p>
<p>如果现在 能听到你的声音的话</p>
</blockquote>
</li>
<li>「爱してる」の一言を<blockquote>
<p>aishiteru no hitokoto wo</p>
<p>「我爱你」这一句话</p>
</blockquote>
</li>
<li>言ってほしい<blockquote>
<p>itte hoshii</p>
<p>希望你能说出来</p>
</blockquote>
</li>
<li>言ってほしい<blockquote>
<p>itte hoshii</p>
<p>希望你能说出来</p>
</blockquote>
</li>
<li>今 あなたに言叶 送ることできるなら<blockquote>
<p>ima anatani kotoba okuru koto dekiru nara</p>
<p>如果现在 我说的话语还能传达给你</p>
</blockquote>
</li>
<li>「生まれ変わっても<blockquote>
<p>umare kawatte mo</p>
<p>「就算转世以后</p>
</blockquote>
</li>
<li>また一绪にいたい」<blockquote>
<p>mata isshyoni itai</p>
<p>我还是想和你在一起」</p>
</blockquote>
</li>
<li>もう会えないなんて…<blockquote>
<p>mou aenai nante …</p>
<p>不想相信再也无法见面什么的…</p>
</blockquote>
</li>
<li>もう会えないなんて…<blockquote>
<p>mou aenai nante …</p>
<p>不想相信再也无法见面什么的 …</p>
</blockquote>
</li>
</ul>
]]></content>
      <tags>
        <tag>歌</tag>
      </tags>
  </entry>
  <entry>
    <title>lemon</title>
    <url>/2019-06-20-music-lemon.html</url>
    <content><![CDATA[<ul>
<li><p>热爱之所爱</p>
</li>
<li><p>学思之所学</p>
</li>
<li><p>lemon</p>
</li>
<li><p>米津玄師</p>
</li>
</ul>
<a id="more"></a>

<h2><span id="lemon">lemon</span></h2><ul>
<li><p>lemon</p>
</li>
<li><p>米津玄師</p>
</li>
<li><p><a href="https://www.youtube.com/watch?v=SX_ViT4Ra7k" target="_blank" rel="noopener external nofollow noreferrer">MV(youtube)</a></p>
</li>
<li><p>梦（ゆめ）ならばどれほどよかったでしょう</p>
<blockquote>
<p>yume naraba dore hodo yokatta deshou</p>
<p>如果这一切都是梦境该有多好</p>
</blockquote>
</li>
<li><p>未（いま）だにあなたのことを梦（ゆめ）にみる</p>
<blockquote>
<p>imada ni anata no koto wo yume ni miru</p>
<p>至今仍能与你在梦中相遇</p>
</blockquote>
</li>
<li><p>忘（わす）れた物（もの）を取（と）りに帰（かえ）るように</p>
<blockquote>
<p>wasureta mono wo tori ni kaeru youni</p>
<p>如同取回遗忘之物一般</p>
</blockquote>
</li>
<li><p>古（ふる）びた思（おも）い出（で）の埃（ほこり）を払（はら）う</p>
<blockquote>
<p>furubita omoide no hokori wo harau</p>
<p>细细拂去将回忆覆盖的尘埃</p>
</blockquote>
</li>
<li><p>戻（もど）らない幸（しあわ）せがあることを</p>
<blockquote>
<p>modora nai shiawase ga aru koto wo</p>
<p>这世间亦有无法挽回的幸福</p>
</blockquote>
</li>
<li><p>最後（さいご）にあなたが教（おし）えてくれた</p>
<blockquote>
<p>saigo ni anata ga oshiete kureta</p>
<p>最终是你让我懂得这一点</p>
</blockquote>
</li>
<li><p>言（い）えずに隠（かくし）してた昏（くら）い过去（かこ）も</p>
<blockquote>
<p>iezu ni kakushiteta kurai kako mo</p>
<p>那些未对他人提及过的黑暗往事</p>
</blockquote>
</li>
<li><p>あなたがいなきゃ永远（えいえん）に昏（くら）いまま</p>
<blockquote>
<p>anata ga inakya eien ni kurai mama</p>
<p>如果不曾有你的话 它们将永远沉睡在黑暗中</p>
</blockquote>
</li>
<li><p>きっともうこれ以上 伤（きず）つくことなど</p>
<blockquote>
<p>kitto mou kore ijou kizu tsuku koto nado</p>
<p>比这更令人难过的事情</p>
</blockquote>
</li>
<li><p>ありはしないとわかっている</p>
<blockquote>
<p>ari wa shinai to wakatte iru</p>
<p>我知道不可能存在</p>
</blockquote>
</li>
<li><p>あの日（ひ）の悲（かな）しみさえ</p>
<blockquote>
<p>ano hi no kanashimi sae</p>
<p>那日的悲伤</p>
</blockquote>
</li>
<li><p>あの日（ひ）の苦（くる）しみさえ</p>
<blockquote>
<p>ano hi no kurushimi sae</p>
<p>与那日的痛苦</p>
</blockquote>
</li>
<li><p>そのすべてを爱（あい）してた あなたとともに</p>
<blockquote>
<p>sono subete wo aishiteta anata to tomoni</p>
<p>连同深爱着这一切的你</p>
</blockquote>
</li>
<li><p>胸（むね）に残（のこ）り离（はな）れない</p>
<blockquote>
<p>mune ni nokori hanare nai</p>
<p>化作了深深烙印在我心中的</p>
</blockquote>
</li>
<li><p>苦（にが）いレモンの匂（にお）い</p>
<blockquote>
<p>nigai remon no nioi</p>
<p>苦涩柠檬的香气</p>
</blockquote>
</li>
<li><p>雨（あめ）が降（ふ）り止（や）むまでは帰（かえ）れない</p>
<blockquote>
<p>ame ga furiyamu made wa kaere nai</p>
<p>在雨过天晴前都无法归去</p>
</blockquote>
</li>
<li><p>今（いま）でもあなたはわたしの光（ひかり）</p>
<blockquote>
<p>ima demo anata wa watashi no hikari</p>
<p>时至今日 你仍是我的光芒</p>
</blockquote>
</li>
<li><p>暗闇（くらやみ）であなたの背（せ）をなぞった</p>
<blockquote>
<p>kurayami de anata no se wo nazotta</p>
<p>在黑暗中追寻着你的身影</p>
</blockquote>
</li>
<li><p>その轮郭（りんかく）を鲜明（せんめい）に覚（おぼ）えている</p>
<blockquote>
<p>sono rinkaku wo senmei ni oboete iru</p>
<p>那轮廓至今仍鲜明地刻印于心</p>
</blockquote>
</li>
<li><p>受（う）け止（と）めきれないものと出会（であ）うたび</p>
<blockquote>
<p>uketome kire nai mono to deau tabi</p>
<p>每当遇到无法承受的苦痛时</p>
</blockquote>
</li>
<li><p>溢（あふ）れてやまないのは涙だけ</p>
<blockquote>
<p>afurete yama nai no wa namida dake</p>
<p>总不禁泪如泉涌</p>
</blockquote>
</li>
<li><p>何（なに）をしていたの</p>
<blockquote>
<p>nani wo shite ita no</p>
<p>你都经历过什么</p>
</blockquote>
</li>
<li><p>何（なに）を见（み）ていたの</p>
<blockquote>
<p>nani wo mite ita no</p>
<p>又目睹过什么呢</p>
</blockquote>
</li>
<li><p>わたしの知（し）らない横颜（よこがお）で</p>
<blockquote>
<p>watashi no shira nai yokogao de</p>
<p>脸上浮现着我不曾见过的神情</p>
</blockquote>
</li>
<li><p>どこかであなたが今（いま）</p>
<blockquote>
<p>dokoka de anata ga ima</p>
<p>如果你正在什么地方</p>
</blockquote>
</li>
<li><p>わたしと同（おな）じ様（よう）な</p>
<blockquote>
<p>watashi to onaji youna</p>
<p>与我一样</p>
</blockquote>
</li>
<li><p>涙（なみだ）にくれ 淋（さび）しさの中（なか）にいるなら</p>
<blockquote>
<p>namida ni kure samishisa no naka ni iru nara</p>
<p>终日过着以泪洗面的寂寞生活的话</p>
</blockquote>
</li>
<li><p>わたしのことなどどうか 忘（わす）れてください</p>
<blockquote>
<p>watashi no koto nado douka wasurete kudasai</p>
<p>就请你将我的一切全部遗忘吧</p>
</blockquote>
</li>
<li><p>そんなことを心（こころ）から愿（ねが）うほどに</p>
<blockquote>
<p>sonna koto wo kokoro kara negau hodo ni</p>
<p>这是我发自内深处唯一的祈愿</p>
</blockquote>
</li>
<li><p>今（いま）でもあなたはわたしの光（ひかり）</p>
<blockquote>
<p>ima demo anata wa watashi no hikari</p>
<p>时至今日 你仍是我的光芒</p>
</blockquote>
</li>
<li><p>自分（じぶん）が思（おも）うより 恋（こい）をしていたあなたに</p>
<blockquote>
<p>jibun ga omou yori koi wo shite ita anata ni</p>
<p>我深深地恋慕着你 甚至超出了我自己的想象</p>
</blockquote>
</li>
<li><p>あれから思（おも）うように 息（いき）ができない</p>
<blockquote>
<p>are kara omou youni iki ga deki nai</p>
<p>自此每当想起你 都如同窒息般痛苦</p>
</blockquote>
</li>
<li><p>あんなに侧（そば）にいたのにまるで嘘（うそ）みたい</p>
<blockquote>
<p>annani soba ni ita noni marude uso mitai</p>
<p>你曾亲密伴我身旁 如今却如烟云般消散</p>
</blockquote>
</li>
<li><p>とても忘（わす）れられないそれだけが确（たし）か</p>
<blockquote>
<p>totemo wasurerare nai sore dake ga tashika</p>
<p>唯一能确定的是 我永远都不会将你遗忘</p>
</blockquote>
</li>
<li><p>あの日（ひ）の悲（かな）しみさえ</p>
<blockquote>
<p>ano hi no kanashimi sae</p>
<p>那日的悲伤</p>
</blockquote>
</li>
<li><p>あの日（ひ）の苦（くる）しみさえ</p>
<blockquote>
<p>ano hi no kurushimi sae</p>
<p>与那日的痛苦</p>
</blockquote>
</li>
<li><p>その全（すべ）てを爱（あい）してたあなたと共（とも）に</p>
<blockquote>
<p>sono subete wo aishiteta anata to tomoni</p>
<p>连同深爱着这一切的你</p>
</blockquote>
</li>
<li><p>胸（むね）に残（のこ）り离（はな）れない</p>
<blockquote>
<p>mune ni nokori hanare nai</p>
<p>化作了深深烙印在我心中的</p>
</blockquote>
</li>
<li><p>苦（にが）いレモンの匂（にお）い</p>
<blockquote>
<p>nigai remon no nioi</p>
<p>苦涩柠檬的香气</p>
</blockquote>
</li>
<li><p>雨（あめ）が降（ふ）り止（や）むまでは帰（かえ）れない</p>
<blockquote>
<p>ame ga furiyamu made wa kaere nai</p>
<p>在雨过天晴前都无法归去</p>
</blockquote>
</li>
<li><p>切（き）り分（わ）けた果実（かじつ）の片方（かたほう）の様（よう）に</p>
<blockquote>
<p>kiriwaketa kajitsu no katahou no youni</p>
<p>如同被切开的半个柠檬一般</p>
</blockquote>
</li>
<li><p>今（いま）でもあなたはわたしの光（ひかり）</p>
<blockquote>
<p>ima demo anata wa watashi no hikari</p>
<p>时至今日你仍是我的光芒</p>
</blockquote>
</li>
</ul>
]]></content>
      <tags>
        <tag>歌</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(3)</title>
    <url>/2019-06-16-arcgis-python-3.html</url>
    <content><![CDATA[<p>学习日志 3    </p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版);  </p>
<ul>
<li>使用replaceDataSource()修复单个图层和表对象  </li>
<li>查找文件夹中所有地图文档内丢失数据源的图层  </li>
</ul>
<a id="more"></a>

<h3><span id="1-使用replacedatasource修复单个图层和表对象">1. 使用replaceDataSource()修复单个图层和表对象</span></h3><ul>
<li>layer.replaceDataSource()  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 替换一个图层</span><br><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">df &#x3D; mapping.ListDataFrames(mxd, &quot;Crime&quot;)[0]</span><br><span class="line">lyr &#x3D; mapping.ListLayers(mxd, &quot;Burglary&quot;, df)[0]</span><br><span class="line"># layer.replaceDataSource()方法替换</span><br><span class="line">lyr.replaceDataSource(r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\data&quot;, &quot;SHAPEFILE_WORKSPACE&quot;, &quot;Burglaries_2009&quot;)</span><br></pre></td></tr></table></figure>

<h3><span id="2-查找文件夹中所有地图文档内丢失数据源的图层">2. 查找文件夹中所有地图文档内丢失数据源的图层</span></h3><p>内容：使用循环搜索文件夹中的地图文档文件，查找这些地图文档中丢失的数据源，并将丢失的数据链接的图层名称写入一个文本文件中</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">import os</span><br><span class="line">## 写文件操作 循环目录内容,找到mxd文档判断内部是否有丢失源</span><br><span class="line">## 并把丢失源的图层保存在文件中 ##</span><br><span class="line">## 注意：os.walk(&#39;路径&#39;) 路径过深导致失败，或有中文字符</span><br><span class="line">f &#x3D; open(&quot;BrokenDataList.txt&quot;, &quot;w&quot;)</span><br><span class="line"># os.walk()遍历目录树</span><br><span class="line">for root, dirs, files in os.walk(&#39;H:\ArcpyBook&#39;):</span><br><span class="line">    for name in files:</span><br><span class="line">        filename &#x3D; os.path.join(root, name)</span><br><span class="line">        </span><br><span class="line">        if &quot;.mxd&quot; in filename:</span><br><span class="line">            mxd &#x3D; mapping.MapDocument(filename)</span><br><span class="line">            f.write(&quot;MXD: &quot; + filename + &quot;\n&quot;)</span><br><span class="line">            brknList &#x3D; mapping.ListBrokenDataSources(mxd)</span><br><span class="line">            for brknItem in brknList:</span><br><span class="line">                print(&quot;Broken data item: &quot; + brknItem.name + &quot; in &quot; + filename)</span><br><span class="line">                f.write(&quot;\t&quot; + brknItem.name + &quot;\n&quot;)</span><br><span class="line">print(&quot;All done\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(2)</title>
    <url>/2019-06-13-arcgis-python-2.html</url>
    <content><![CDATA[<p>学习日志 2:   </p>
<p>书籍：基于ArcGIS的Python编程秘笈(第2版);       </p>
<ul>
<li>利用图层更新其他图层属性  </li>
<li>操作数据框中启用时间属性的图层  </li>
<li>查找地图文档和图层文件中丢失的数据源  </li>
<li>使用MapDocument.findAndReplaceWorkplacePaths()修复丢失的数据源  </li>
<li>使用MapDocument.replaceWorkspaces()方法修复丢失的数据源</li>
</ul>
<a id="more"></a>

<h3><span id="1-利用图层更新其他图层属性">1. 利用图层更新其他图层属性</span></h3><p>结果使将要更新的图层的属性变成与原图层一样</p>
<p>更新图层与源图层拥有相同的属性</p>
<p>更改的属性：例如 图层名、字段别名、定义查询等</p>
<p>对于在多个数据框的相同的图层，需要对其进行属性更改设置，可通过这样的方法进行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">df &#x3D; mapping.ListDataFrames(mxd, &quot;Crime&quot;)[0]</span><br><span class="line"># 将要更新的图层</span><br><span class="line">updateLayer &#x3D; mapping.ListLayers(mxd, &quot;Crimes2009&quot;, df)[0]</span><br><span class="line"># 用于更新图层的源图层</span><br><span class="line">sourceLayer &#x3D; mapping.Layer(r&quot;H:\upUpStudy\pythonGis\data\BurglariesNoForcedEntry.lyr&quot;)</span><br><span class="line"># 更新符号系统</span><br><span class="line">mapping.UpdateLayer(df, updateLayer, sourceLayer, False)</span><br></pre></td></tr></table></figure>
<h3><span id="2-操作数据框中启用时间属性的图层">2. 操作数据框中启用时间属性的图层</span></h3><ul>
<li>DataFrameTime对象(DataFrame.time属性返回的结果)</li>
</ul>
<p>可检索</p>
<ul>
<li>currentTime (当前时间)</li>
<li>endTime (结束时间)</li>
<li>startTime (开始时间)</li>
<li>timeStepInterval (时间步长间隔)</li>
</ul>
<p>数据框中的图层必须 ==启用时间属性== 才能进行这些操作 </p>
<h4><span id="以7天为间隔导出犯罪点的位置pdf">以7天为间隔导出犯罪点的位置PDF</span></h4> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">df &#x3D; mapping.ListDataFrames(mxd, &quot;Crime&quot;)[0]</span><br><span class="line">dft &#x3D; df.time</span><br><span class="line"># dft 为DataFrameTime对象 </span><br><span class="line"># 设置当前时间为开始时间</span><br><span class="line">dft.currentTime &#x3D; dft.startTime</span><br><span class="line"># 使用循环导出以7天为间隔的犯罪数据的PDF文件</span><br><span class="line">while dft.currentTime &lt;&#x3D; dft.endTime:</span><br><span class="line">    fileName &#x3D; str(dft.currentTime).split(&quot; &quot;)[0] + &quot;.pdf&quot;</span><br><span class="line">    # 导出地图</span><br><span class="line">    mapping.ExportToPDF(mxd, os.path.join(r&quot;H:\upUpStudy\pythonGis\data\Ch2&quot;, fileName), df)</span><br><span class="line">    print(&quot;Export&quot; + fileName)</span><br><span class="line">    # 循环控制</span><br><span class="line">    dft.currentTime &#x3D; dft.currentTime + dft.timeStepInterval</span><br></pre></td></tr></table></figure>

<h3><span id="3-查找地图文档和图层文件中丢失的数据源">3. 查找地图文档和图层文件中丢失的数据源</span></h3><p> 图层文件前有感叹号表示已丢失数据链接</p>
<ul>
<li>arcpy.mapping.ListBrokenDataSources() 返回已丢失数据源图层列表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line"># 获取文档中丢失数据源图层列表</span><br><span class="line">listBrokenDS &#x3D; mapping.ListBrokenDataSources(mxd)</span><br><span class="line">for layer in listBrokenDS:</span><br><span class="line">    print(layer.name)</span><br></pre></td></tr></table></figure>

<h3><span id="4-使用mapdocumentfindandreplaceworkplacepaths修复丢失的数据源">4. 使用MapDocument.findAndReplaceWorkplacePaths()修复丢失的数据源</span></h3><ul>
<li>MapDocument.findAndReplaceWorkspacePaths()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line"># 获取文档中丢失数据源图层列表</span><br><span class="line">listBrokenDS &#x3D; mapping.ListBrokenDataSources(mxd)</span><br><span class="line">for layer in listBrokenDS:</span><br><span class="line">    print(layer.name)</span><br><span class="line">    </span><br><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line"># 修复文档中图层数据源</span><br><span class="line">mxd.findAndReplaceWorkspacePaths(r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\Ch3\Data\OldData\CityOfSanAntonio.gdb&quot;, r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\data\CityOfSanAntonio.gdb&quot;)</span><br><span class="line"># 结果保存到mxd</span><br><span class="line">mxd.saveACopy(r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\Ch3\Crime_DataLinksFixed.mxd&quot;)</span><br></pre></td></tr></table></figure>

<h4><span id="layer和tableview对象的-findandreplacewokespacepaths">Layer和TableView对象的 findAndReplaceWokespacePaths()</span></h4><ul>
<li>Layer.findAndReplaceWokespacePaths()</li>
<li>TableView.findAndReplaceWokespacePaths()</li>
</ul>
<p>只能用来修复单个丢失的数据源，不能进行全局查找并替换地图文档中所有丢失的数据源</p>
<h4><span id="缺点-替换的数据源必须类型相同">缺点： 替换的数据源必须类型相同</span></h4><p>如原来的数据源是个人地理数据库，那么替换的数据源也必须是个人地理数据库，只是数据库路径改变了</p>
<h3><span id="5-使用mapdocumentreplaceworkspaces方法修复丢失的数据源">5. 使用MapDocument.replaceWorkspaces()方法修复丢失的数据源</span></h3><ul>
<li>MapDocument.replaceWorkspaces()</li>
</ul>
<p>允许从一种工作空间类型转换到另一种工作空间类型；</p>
<p>如从个人地理数据库到文件地理数据库；</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line"># 替换数据源为.mdb个人地理数据库的源</span><br><span class="line">mxd.replaceWorkspaces(r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\data\CityOfSanAntonio.gdb&quot;, &quot;FILEGDB_WORKSPACE&quot;, r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\New_Data\CityOfSanAntonio_Personal.mdb&quot;, &quot;ACCESS_WORKSPACE&quot;)</span><br><span class="line">mxd.saveACopy(r&quot;H:\upUpStudy\pythonGis\基于arcgis的python编程秘籍第二版数据文件\ArcpyBook\Ch3\Crime_DataLinksUpdate.mxd&quot;)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>Git指令</title>
    <url>/2019-06-12-git-shang-chuan-xiang-mu.html</url>
    <content><![CDATA[<h4><span id="1新建项目后">1.新建项目后</span></h4><h4><span id="or-create-a-new-repository-on-the-command-line">…or create a new repository on the command line</span></h4><a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;# emmm&quot; &gt;&gt; README.md</span><br><span class="line">git init</span><br><span class="line">git add README.md</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git remote add origin https:&#x2F;&#x2F;github.com&#x2F;zuahua&#x2F;pythonGame.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<h5><span id="or-push-an-existing-repository-from-the-command-line">…or push an existing repository from the command line</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add origin https:&#x2F;&#x2F;github.com&#x2F;zuahua&#x2F;pythonGame.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>
<h4><span id="2流程">2.流程</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 添加此文件全部</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git remote add origin https:&#x2F;&#x2F;github.com&#x2F;zuahua&#x2F;pythonGame.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Arcgis中的python编程(1)</title>
    <url>/2019-06-13-arcgis-python-1.html</url>
    <content><![CDATA[<h3><span id="学习日志-1">学习日志 1:</span></h3><p>书籍：基于ArcGIS的Python编程秘笈(第2版);   </p>
<ul>
<li>arcpy库  </li>
<li>引用mxd文档、数据框、图层  </li>
<li>改变地图范围  </li>
<li>添加图层文件到数据框  </li>
<li>插入一个图层到某个位置  </li>
</ul>
<a id="more"></a>

<h3><span id="1-arcpy库">1. arcpy库</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import arcpy.mapping as mapping</span><br></pre></td></tr></table></figure>
<h3><span id="2-引用mxd文档-数据框-图层">2. 引用mxd文档、数据框、图层</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mxd &#x3D; mapping.MapDocument(&quot;H:\\upUpStudy\\pythonGis\\text\\text.mxd&quot;)</span><br><span class="line"></span><br><span class="line">#或</span><br><span class="line"></span><br><span class="line">mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">df &#x3D; mapping.ListDataFrames(mxd)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">layers &#x3D; mapping.ListLayers(mxd, &quot;p&quot;, df)</span><br></pre></td></tr></table></figure>

<h3><span id="3-改变地图范围">3. 改变地图范围</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import arcpy.mapping as mapping</span><br><span class="line">... mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">... </span><br><span class="line">... </span><br><span class="line">&gt;&gt;&gt; for df in mapping.ListDataFrames(mxd):</span><br><span class="line">...     if df &#x3D;&#x3D; &quot;df1&quot;:</span><br><span class="line">...         layers &#x3D; mapping.ListLayers(mxd, &#39;counties&#39;, df)</span><br><span class="line">...         for layer in layers:</span><br><span class="line">...             query &#x3D; &#39;&quot;county&quot; &#x3D; &quot;HAYS&quot;&#39;</span><br><span class="line">...             layer.definitionQuery &#x3D; query</span><br><span class="line">...             df.extent &#x3D; layer.getExtent()</span><br></pre></td></tr></table></figure>

<h3><span id="4-添加图层文件到数据框">4. 添加图层文件到数据框</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import arcpy.mapping as mapping</span><br><span class="line">... mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">... df &#x3D; mapping.ListDataFrames(mxd)[0]</span><br><span class="line">#########</span><br><span class="line">... layer &#x3D; mapping.Layer(r&#39;H:\upUpStudy\pythonGis\data\counties.lyr&#39;)</span><br><span class="line">... mapping.AddLayer(df, layer, &quot;AUTO_ARRANGE&quot;)</span><br><span class="line">##########</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h4><span id="41-添加到图层组-移除图层">4.1 添加到图层组、移除图层</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mapping.AddLayerToGroup()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mapping.RemoveLayer()</span><br></pre></td></tr></table></figure>
<h3><span id="5-插入一个图层到某个位置">5. 插入一个图层到某个位置</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mapping.InsertLayer()</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import arcpy.mapping as mapping</span><br><span class="line">&gt;&gt;&gt; mxd &#x3D; mapping.MapDocument(&quot;current&quot;)</span><br><span class="line">&gt;&gt;&gt; df &#x3D; mapping.ListDataFrames(mxd)[0]</span><br><span class="line">&gt;&gt;&gt; # 参考图层</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; reflayer &#x3D; mapping.ListLayers(mxd, &#39;boun*&#39;, df)[0]</span><br><span class="line">&gt;&gt;&gt; # 插入的图层</span><br><span class="line">&gt;&gt;&gt; insertLayer &#x3D; mapping.Layer(r&#39;H:\upUpStudy\pythonGis\data\streets.shp&#39;)</span><br><span class="line">&gt;&gt;&gt; # 插入</span><br><span class="line">&gt;&gt;&gt; mapping.InsertLayer(df, reflayer, insertLayer, &quot;BEFORE&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pythonGIS</tag>
      </tags>
  </entry>
  <entry>
    <title>ubuntu16.04安装vsftpd</title>
    <url>/2019-06-12-ubuntu16.04-vsftpd.html</url>
    <content><![CDATA[<p><a href="https://cnaning.iteye.com/blog/335797" target="_blank" rel="noopener external nofollow noreferrer">配置文件中详细配置说明</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service vsftpd restart &#x2F;&#x2F;重启ftp服务</span><br><span class="line"></span><br><span class="line">netstat -natp | grep 21 &#x2F;&#x2F;查看端口监听状态</span><br><span class="line"></span><br><span class="line">apt-get remove vsftpd &#x2F;&#x2F;卸载软件</span><br><span class="line"></span><br><span class="line">service vsftpd status &#x2F;&#x2F;查看vsftpd的状态，可以输入命令</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4><span id="安装配置">安装配置</span></h4><p><a href="https://blog.csdn.net/qq_36095713/article/details/78024781" target="_blank" rel="noopener external nofollow noreferrer">教程1</a></p>
<p>本地连接 503错误</p>
<p><a href="https://blog.csdn.net/zhezhebie/article/details/78775323" target="_blank" rel="noopener external nofollow noreferrer">教程二</a></p>
<p>远程连接超时</p>
<p>在阿里云服务器里设置防火墙规则<br>FTP就能连接了</p>
<h4><span id="发现连上很慢也出现连接超时">发现连上很慢，也出现连接超时</span></h4><p>在阿里云上防火墙规则添加 全部TCP</p>
<p>配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">listen_ipv6&#x3D;YES</span><br><span class="line">local_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">write_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">local_umask&#x3D;022</span><br><span class="line"></span><br><span class="line">dirmessage_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">use_localtime&#x3D;YES</span><br><span class="line"></span><br><span class="line">xferlog_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">connect_from_port_20&#x3D;YES</span><br><span class="line"></span><br><span class="line">xferlog_file&#x3D;&#x2F;var&#x2F;log&#x2F;vsftpd.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ascii_upload_enable&#x3D;YES</span><br><span class="line">ascii_download_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">chroot_local_user&#x3D;NO</span><br><span class="line"></span><br><span class="line">chroot_list_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">listen_ipv6&#x3D;YES</span><br><span class="line"></span><br><span class="line">anonymous_enable&#x3D;NO</span><br><span class="line"></span><br><span class="line">local_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">write_enable&#x3D;YES</span><br><span class="line"></span><br><span class="line">dirmessage_enable&#x3D;YES</span><br><span class="line">use_localtime&#x3D;YES</span><br><span class="line">xferlog_enable&#x3D;YES</span><br><span class="line">connect_from_port_20&#x3D;YES</span><br><span class="line"></span><br><span class="line">xferlog_file&#x3D;&#x2F;var&#x2F;log&#x2F;vsftpd.log</span><br><span class="line">ascii_upload_enable&#x3D;YES</span><br><span class="line">ascii_download_enable&#x3D;YES</span><br><span class="line">chroot_local_user&#x3D;NO</span><br><span class="line">chroot_list_enable&#x3D;YES</span><br><span class="line">secure_chroot_dir&#x3D;&#x2F;var&#x2F;run&#x2F;vsftpd&#x2F;empty</span><br><span class="line"></span><br><span class="line">pam_service_name&#x3D;vsftpd</span><br><span class="line"></span><br><span class="line">rsa_cert_file&#x3D;&#x2F;etc&#x2F;ssl&#x2F;certs&#x2F;ssl-cert-snakeoil.pem</span><br><span class="line">rsa_private_key_file&#x3D;&#x2F;etc&#x2F;ssl&#x2F;private&#x2F;ssl-cert-snakeoil.key</span><br><span class="line">ssl_enable&#x3D;NO</span><br><span class="line">pasv_enable&#x3D;YES</span><br><span class="line">pasv_min_port&#x3D;20000</span><br><span class="line">pasv_max_port&#x3D;20500</span><br><span class="line"></span><br><span class="line">max_clients&#x3D;5</span><br><span class="line">utf8_filesystem&#x3D;YES</span><br><span class="line"></span><br><span class="line">local_umask&#x3D;022</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>vsftpd</tag>
      </tags>
  </entry>
  <entry>
    <title>记录使用这个 blog theme</title>
    <url>/2019-06-12-essay1.html</url>
    <content><![CDATA[<blockquote>
<ul>
<li>使用github page 来作为blog已经快有一年时间了;</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>最开始使用hexo+github来搭建blog环境，也比较好用，但弄得最后”花里胡哨”，有违blog的本质;</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>之后尝试wordpress(懒，发现需要部署到服务器上，直接放弃);</li>
</ul>
</blockquote>
<a id="more"></a>

<blockquote>
<ul>
<li>一个契机(浏览我为数不多的Line好友动态)，让我发现的这个sites theme;</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>给我最大的感觉是”简洁”吧(最初想着theme花里胡哨的好看，最后还是想着单一的简洁，人生啊).</li>
</ul>
</blockquote>
]]></content>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>minecraft服务器搭建</title>
    <url>/2019-06-12-ubuntu-minecraft-server.html</url>
    <content><![CDATA[<p>暑假玩网易代理我的世界；</p>
<p>玩得不爽，模组太少；</p>
<p>想着自己用服务器搭一个玩玩</p>
<p>参考：<br><a href="https://linux.cn/article-9480-1.html" target="_blank" rel="noopener external nofollow noreferrer">在ubuntu搭建minecraft服务器</a></p>
<a id="more"></a>

<h4><span id="安装java18">安装java1.8</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get install openjdk-8-jdk</span><br></pre></td></tr></table></figure>
<h4><span id="卸载java">卸载java</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove openjdk*</span><br></pre></td></tr></table></figure>
<h4><span id="1screen进入screen">1.screen进入screen</span></h4><h5><span id="11-新建screen">1.1 新建screen</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screen -S newscreen</span><br></pre></td></tr></table></figure>
<h5><span id="12-打开screen进程">1.2 打开screen进程</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screen -r</span><br></pre></td></tr></table></figure>
<h4><span id="2kill-pid退出screen某个进程">2.kill pid退出screen某个进程</span></h4><h4><span id="3运行minecraft">3.运行minecraft</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -Xms500M -Xmx1300M -jar minecraft_server.1.12.2.jar nogui</span><br></pre></td></tr></table></figure>
<h4><span id="4执行sh脚本">4.执行.sh脚本</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;minecraft&#x2F;start.sh</span><br></pre></td></tr></table></figure>
<h4><span id="5进入服务器控制台">5.进入服务器控制台</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screen -r minecraft</span><br></pre></td></tr></table></figure>
<h4><span id="6下载新版本minecraft">6.下载新版本minecraft</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;s3.amazonaws.com&#x2F;Minecraft.Download&#x2F;versions&#x2F;1.12.2&#x2F;minecraft_server.1.12.2.jar</span><br></pre></td></tr></table></figure>
<h5><span id="61接下来运行并构建新服务端">6.1接下来，运行并构建新服务端：</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -Xms500M -Xmx1300M -jar minecraft_server.1.12.2.jar nogui</span><br></pre></td></tr></table></figure>
<h5><span id="62最后更新你的启动脚本">6.2最后，更新你的启动脚本：</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim minecraft&#x2F;start.sh</span><br></pre></td></tr></table></figure>
<h5><span id="63更新版本号数字">6.3更新版本号数字：</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">cd &#x2F;minecraft&#x2F; &amp;&amp; java -Xms500M -Xmx1300M -jar minecraft_server.1.12.2.jar nogui</span><br></pre></td></tr></table></figure>
<h4><span id="7serverproperties参数">7.server.properties参数</span></h4><p><a href="https://minecraft-zh.gamepedia.com/index.php?title=Server.properties&variant=zh" target="_blank" rel="noopener external nofollow noreferrer">server.properties参数</a></p>
<h4><span id="8">8.</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screen -S yourname -&gt; 新建一个叫yourname的session</span><br><span class="line">screen -ls -&gt; 列出当前所有的session</span><br><span class="line">screen -r yourname -&gt; 回到yourname这个session</span><br><span class="line">screen -d yourname -&gt; 远程detach某个session</span><br><span class="line">screen -d -r yourname -&gt; 结束当前session并回到yourname这个session</span><br></pre></td></tr></table></figure>
<h4><span id="9minecraft服务端指令">9.minecraft服务端指令</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;op 玩家名    &#x2F;&#x2F; 给权限</span><br><span class="line">&#x2F;gamemode 模式 玩家名</span><br></pre></td></tr></table></figure>
<h4><span id="10forge安装">10.forge安装</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;files.minecraftforge.net&#x2F;maven&#x2F;net&#x2F;minecraftforge&#x2F;forge&#x2F;1.12.2-14.23.5.2808&#x2F;forge-1.12.2-14.23.5.2808-installer.jar</span><br><span class="line">java -jar forge文件.jar --insatll</span><br></pre></td></tr></table></figure>
<h5><span id="101运行forge">10.1运行forge</span></h5><h5><span id="运行forge需要java18">运行forge需要java1.8</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -Xms500M -Xmx1300M -server -jar forge-1.12.2-14.23.5.2808-universal.jar -nogui</span><br></pre></td></tr></table></figure>
<h4><span id="11赋予sh文件权限">11赋予.sh文件权限</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod +x start.sh</span><br></pre></td></tr></table></figure>
<h4><span id="12mc服务器崩溃自启脚本">12MC服务器崩溃自启脚本</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">while true</span><br><span class="line">do</span><br><span class="line">cd &#x2F;minecraft&#x2F; &amp;&amp; java -Xms500M -Xmx1300M -jar minecraft_server.1.12.2.jar nogui</span><br><span class="line">done</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>Minecraft</tag>
      </tags>
  </entry>
  <entry>
    <title>C语言顺序栈</title>
    <url>/2019-03-19-c-yu-yan-shun-xu-zhan.html</url>
    <content><![CDATA[<p>环境：vscode C语言</p>
<a id="more"></a>

<h4><span id="c语言顺序栈">C语言顺序栈</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 结构体存储栈节点数据</span><br><span class="line">typedef struct student&#123;</span><br><span class="line">    char *name;</span><br><span class="line">    &#x2F;&#x2F;int age;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">&#125;student;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 栈的结构体</span><br><span class="line">typedef struct stack</span><br><span class="line">&#123;</span><br><span class="line">    student *arr; &#x2F;&#x2F; 结构体数组存储节点数据</span><br><span class="line">    int top;  &#x2F;&#x2F; 栈顶元素的下一位(栈顶游标)</span><br><span class="line">    int size;  &#x2F;&#x2F; 栈的大小</span><br><span class="line">    int inc; &#x2F;&#x2F; 扩增栈大小的变量</span><br><span class="line">&#125;stack;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 栈的初始化</span><br><span class="line">void stackInit(stack *s, int size, int inc)&#123;</span><br><span class="line">    printf(&quot;---初始化栈---\n&quot;);</span><br><span class="line">    s-&gt;arr &#x3D; (student*)malloc(size*sizeof(student)); &#x2F;&#x2F; 开辟内存空间</span><br><span class="line">    s-&gt;size &#x3D; size;</span><br><span class="line">    s-&gt;inc &#x3D; inc;</span><br><span class="line">    s-&gt;top &#x3D; 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 入栈操作</span><br><span class="line">void stackPush(stack *s, student e)&#123;</span><br><span class="line">    printf(&quot;入栈元素:%s\n&quot;, e.name);</span><br><span class="line">    if(s-&gt;top &gt;&#x3D; s-&gt;size)&#123; &#x2F;&#x2F;扩增栈的大小</span><br><span class="line">        student *base &#x3D; (student*)realloc(s-&gt;arr, (s-&gt;size+s-&gt;inc)*sizeof(student));</span><br><span class="line">        s-&gt;arr &#x3D; base;</span><br><span class="line">        s-&gt;size &#x3D; s-&gt;size + s-&gt;inc;</span><br><span class="line">        printf(&quot;已扩增\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 入栈</span><br><span class="line">    s-&gt;arr[s-&gt;top] &#x3D; e;</span><br><span class="line">    s-&gt;top &#x3D; s-&gt;top + 1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 出栈操作</span><br><span class="line">void stackPull(stack *s)&#123; &#x2F;&#x2F; 栈顶元素出</span><br><span class="line">    printf(&quot;出栈元素：%s\n&quot;, s-&gt;arr[s-&gt;top-1].name);</span><br><span class="line">    student p;</span><br><span class="line">    s-&gt;arr[s-&gt;top-1] &#x3D; p;</span><br><span class="line">    s-&gt;top &#x3D; s-&gt;top - 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 栈的打印</span><br><span class="line">void stackPrint(stack *s)&#123;</span><br><span class="line">    printf(&quot;打印栈-----------\n&quot;);</span><br><span class="line">    int N &#x3D; s-&gt;top;</span><br><span class="line">    int i;</span><br><span class="line">    for(i&#x3D;N-1; i&gt;&#x3D;0; i--)&#123;</span><br><span class="line">        printf(&quot;栈元素:%s\n&quot;, s-&gt;arr[i].name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 入栈的元素</span><br><span class="line">    student e1 &#x3D; &#123;&quot;n1&quot;&#125;;</span><br><span class="line">    student e2 &#x3D; &#123;&quot;n2&quot;&#125;;</span><br><span class="line">    student e3 &#x3D; &#123;&quot;n3&quot;&#125;;</span><br><span class="line">    student e4 &#x3D; &#123;&quot;n4&quot;&#125;;</span><br><span class="line">    student e5 &#x3D; &#123;&quot;n5&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 栈</span><br><span class="line">    stack *s &#x3D; (stack*)malloc(sizeof(stack));</span><br><span class="line">    stackInit(s, 3, 1); &#x2F;&#x2F; 栈初始化</span><br><span class="line">    &#x2F;&#x2F; 入栈</span><br><span class="line">    stackPush(s, e1);</span><br><span class="line">    stackPush(s, e2);</span><br><span class="line">    stackPush(s, e3);</span><br><span class="line">    stackPush(s, e4);</span><br><span class="line">    stackPush(s, e5);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 打印</span><br><span class="line">    stackPrint(s);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 出栈</span><br><span class="line">    stackPull(s);</span><br><span class="line">    stackPull(s);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 再打印呢</span><br><span class="line">    stackPrint(s);</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>C语言</tag>
      </tags>
  </entry>
  <entry>
    <title>python3 链表结构</title>
    <url>/2019-03-10-python3-lian-biao-jie-gou.html</url>
    <content><![CDATA[<p>环境: python3<br>工具: Spyder</p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Created on Sun Mar 10 17:09:47 2019</span><br><span class="line"></span><br><span class="line">@author: inno</span><br><span class="line">title； 单向链表，创建，删除某个节点</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;节点类&quot;&quot;&quot;</span><br><span class="line">class Node():</span><br><span class="line">    def __init__(self, data):</span><br><span class="line">        self.data &#x3D; data</span><br><span class="line">        self.pnext &#x3D; None</span><br><span class="line">        </span><br><span class="line">&quot;&quot;&quot;类：封装各种方法&quot;&quot;&quot;</span><br><span class="line">class Function():</span><br><span class="line">    def __init__(self, head):</span><br><span class="line">        self.head &#x3D; head</span><br><span class="line">    </span><br><span class="line">    # 添加节点</span><br><span class="line">    def appendNode(self):</span><br><span class="line">        # 令pr为第一个节点</span><br><span class="line">        self.pr &#x3D; self.head</span><br><span class="line">        if self.head.data &#x3D;&#x3D; None: # 若头部为空</span><br><span class="line">            self.head.data &#x3D; input(&quot;Input data:&quot;)</span><br><span class="line">            self.head.pnext &#x3D; None</span><br><span class="line">        else:</span><br><span class="line">            while self.pr.pnext !&#x3D; None:</span><br><span class="line">                self.pr &#x3D; self.pr.pnext</span><br><span class="line">            </span><br><span class="line">            newNode &#x3D; Node(None)</span><br><span class="line">            self.pr.pnext &#x3D; newNode</span><br><span class="line">            newNode.data &#x3D; input(&quot;Input a data:&quot;)</span><br><span class="line">        return self.head</span><br><span class="line">    </span><br><span class="line">    # 传入data，删除这个节点</span><br><span class="line">    def delNode(self, delData):</span><br><span class="line">        </span><br><span class="line">        pr &#x3D; self.head</span><br><span class="line">        p &#x3D; self.head</span><br><span class="line">        if str(self.head.data) &#x3D;&#x3D; str(delData):</span><br><span class="line">            return self.head.pnext</span><br><span class="line">        else:</span><br><span class="line">            while str(pr.data) !&#x3D; str(delData):</span><br><span class="line">                p &#x3D; pr</span><br><span class="line">                pr &#x3D; pr.pnext</span><br><span class="line">            if pr.pnext !&#x3D; None:</span><br><span class="line">                p.pnext &#x3D; pr.pnext</span><br><span class="line">            else:</span><br><span class="line">                p.pnext &#x3D; None</span><br><span class="line">        return self.head</span><br><span class="line">        </span><br><span class="line">                    </span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    # 测试1</span><br><span class="line">    # 手动创建3个节点</span><br><span class="line">    node1 &#x3D; Node(1)</span><br><span class="line">    node2 &#x3D; Node(2)</span><br><span class="line">    node3 &#x3D; Node(3)</span><br><span class="line">    node1.pnext &#x3D; node2</span><br><span class="line">    node2.pnext &#x3D; node3</span><br><span class="line">    # 调用方法，添加第4点</span><br><span class="line">    fun &#x3D; Function(node1)</span><br><span class="line">    node &#x3D; fun.appendNode()</span><br><span class="line">    while node !&#x3D; None:</span><br><span class="line">        print(node.data)</span><br><span class="line">        node &#x3D; node.pnext</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    # 测试2</span><br><span class="line">    # 利用循环创建5个节点的链表</span><br><span class="line">    link &#x3D; Node(None)</span><br><span class="line">    fun1 &#x3D; Function(link)</span><br><span class="line">    for i in range(5):</span><br><span class="line">        link &#x3D; fun1.appendNode()</span><br><span class="line">    p_link &#x3D; link</span><br><span class="line">    while p_link !&#x3D; None:</span><br><span class="line">        print(p_link.data)</span><br><span class="line">        p_link &#x3D; p_link.pnext</span><br><span class="line">    print(&#39;&#39;)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    # 测试3</span><br><span class="line">    # 删除节点数据为555的节点</span><br><span class="line">    fun2 &#x3D; Function(link)</span><br><span class="line">    link &#x3D; fun2.delNode(555)</span><br><span class="line">    p_link2 &#x3D; link</span><br><span class="line">    while p_link2 !&#x3D; None:</span><br><span class="line">        print(p_link2.data)</span><br><span class="line">        p_link2 &#x3D; p_link2.pnext</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>python数据结构</tag>
      </tags>
  </entry>
  <entry>
    <title>pygame飞机大战游戏打包为exe</title>
    <url>/2019-03-07-pygame-exe.html</url>
    <content><![CDATA[<p>环境: python 3.5<br>使用打包库：cx_Freeze<br><a href="http://sighingnow.github.io/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/cx_freeze.html" target="_blank" rel="noopener external nofollow noreferrer">可参考</a></p>
<a id="more"></a>

<h4><span id="pygame飞机大战游戏打包为exe">pygame飞机大战游戏打包为exe</span></h4><h5><span id="安装">安装</span></h5><p>cmd下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install cx_freeze</span><br></pre></td></tr></table></figure>
<h5><span id="解包">解包</span></h5><p>cmd到python安装目录scripts目录下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python cxfreeze-postinstall</span><br></pre></td></tr></table></figure>
<h5><span id="检查是否安装好">检查是否安装好</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cxfreeze -h</span><br></pre></td></tr></table></figure>
<h5><span id="打包">打包</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cxfreeze 文件名.py</span><br></pre></td></tr></table></figure>
<h5><span id="注意">注意</span></h5><p><strong>打包主文件，及执行文件，其他.py文件在同一目录，<br>有图片注意相对路径</strong></p>
<p><strong>打包完成会生成dist文件目录，图片文件应放在其中，与exe文件相对应的路径</strong></p>
<p>此时运行会弹出一闪而过的黑窗口</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cxfreeze .py(需打包文件路径） --target-dir D:\a（存放exe的目标文件夹路径）--base-name&#x3D;win32gui</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pygame</tag>
      </tags>
  </entry>
  <entry>
    <title>C语言链表</title>
    <url>/2019-03-03-c-yu-yan-lian-biao.html</url>
    <content><![CDATA[<p>环境: VC++ 6.0</p>
<a id="more"></a>

<h4><span id="c语言链表">C语言链表</span></h4><h5><span id="1头文件">1.头文件</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &quot;stdafx.h&quot;  &#x2F;&#x2F; 可略</span><br><span class="line">#include &quot;stdio.h&quot;</span><br><span class="line">#include &quot;stdlib.h&quot;</span><br></pre></td></tr></table></figure>
<h5><span id="2函数名">2.函数名</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">struct link *AppendNode(struct link *head);</span><br><span class="line">void DisplayNode(struct link *head);</span><br><span class="line">struct link *creat(struct link *head, int n);</span><br><span class="line">void DeleteMemory(struct link *head);</span><br><span class="line">struct link *DeleteNode(struct link *head, int nodedata);</span><br><span class="line">struct link *InsertNode(struct link *head, int nodedata);</span><br></pre></td></tr></table></figure>
<h5><span id="3-结构体">3. 结构体</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 结构体</span><br><span class="line">typedef struct link</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	int data;</span><br><span class="line">	struct link *next;</span><br><span class="line">&#125;Link;</span><br></pre></td></tr></table></figure>
<h5><span id="4-主函数">4. 主函数</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 主函数 *&#x2F;</span><br><span class="line">int main(int argc, char* argv[])</span><br><span class="line">&#123;</span><br><span class="line">	Link *head &#x3D; NULL;</span><br><span class="line">	&#x2F;&#x2F;head &#x3D; AppendNode(head);</span><br><span class="line">	head &#x3D; creat(head, 5);</span><br><span class="line">	DisplayNode(head);</span><br><span class="line">	printf(&quot;\n&quot;);</span><br><span class="line">	&#x2F;&#x2F;DeleteMemory(head);</span><br><span class="line">	Link *head1 &#x3D; DeleteNode(head, 555);</span><br><span class="line">	DisplayNode(head1);</span><br><span class="line">	printf(&quot;\n&quot;);</span><br><span class="line">	Link *head2 &#x3D; InsertNode(head1, 555);</span><br><span class="line">	DisplayNode(head2);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="5-方法新建一个节点并添加到链表末尾返回添加节点后的链表的头指针">5. 方法:新建一个节点并添加到链表末尾，返回添加节点后的链表的头指针</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 新建一个节点并添加到链表末尾，返回添加节点后的链表的头指针 *&#x2F;</span><br><span class="line">Link *AppendNode(Link *head)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	Link *p &#x3D; NULL, *pr &#x3D; head;</span><br><span class="line">	int data;</span><br><span class="line">	p &#x3D; (Link*)malloc(sizeof(Link));</span><br><span class="line">	if(p &#x3D;&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		&#x2F;&#x2F; 新建内存失败，退出程序</span><br><span class="line">		printf(&quot;No enough memory\n&quot;);</span><br><span class="line">		exit(0);</span><br><span class="line">	&#125;</span><br><span class="line">	&#x2F;&#x2F; 若原链表为空</span><br><span class="line">	if(head &#x3D;&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		head &#x3D; p;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		while(pr-&gt;next !&#x3D; NULL)</span><br><span class="line">		&#123;</span><br><span class="line">			pr &#x3D; pr-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		pr-&gt;next &#x3D; p;</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;Input data:&quot;);</span><br><span class="line">	scanf(&quot;%d&quot;, &amp;data);</span><br><span class="line">	p-&gt;data &#x3D; data;</span><br><span class="line">	p-&gt;next &#x3D; NULL;</span><br><span class="line">	return head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="6方法-显示链表中的所有节点的节点号和数据">6.方法: 显示链表中的所有节点的节点号和数据</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 显示链表中的所有节点的节点号和数据 *&#x2F;</span><br><span class="line">void DisplayNode(struct link *head)</span><br><span class="line">&#123;</span><br><span class="line">	Link *p &#x3D; head;</span><br><span class="line">	int j &#x3D; 1;</span><br><span class="line">	while(p !&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		printf(&quot;%5d, %10d\n&quot;, j, p-&gt;data);</span><br><span class="line">		p &#x3D; p-&gt;next;</span><br><span class="line">		j++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="7-创建链表存储n个数据">7. 创建链表,存储n个数据</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 创建链表,存储n个数据 *&#x2F;</span><br><span class="line">struct link *creat(struct link *head, int n)</span><br><span class="line">&#123;</span><br><span class="line">	for(int i &#x3D; 0; i &lt; n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		struct link *node &#x3D; NULL, *end &#x3D; head;</span><br><span class="line">		int data;</span><br><span class="line">		node &#x3D; (struct link*)malloc(sizeof(struct link));</span><br><span class="line">		if(head &#x3D;&#x3D; NULL)</span><br><span class="line">		&#123;</span><br><span class="line">			head &#x3D; node;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			while(end-&gt;next !&#x3D; NULL)</span><br><span class="line">			&#123;</span><br><span class="line">				end &#x3D; end-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			end-&gt;next &#x3D; node;</span><br><span class="line">		&#125;</span><br><span class="line">		printf(&quot;Input data:&quot;);</span><br><span class="line">		scanf(&quot;%d&quot;, &amp;data);</span><br><span class="line">		node-&gt;data &#x3D; data;</span><br><span class="line">		node-&gt;next &#x3D; NULL;</span><br><span class="line">	&#125;</span><br><span class="line">	return head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="8-释放链表节点的内存">8. 释放链表节点的内存</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 释放链表节点的内存 *&#x2F;</span><br><span class="line">void DeleteMemory(struct link *head)</span><br><span class="line">&#123;</span><br><span class="line">	struct link *p &#x3D; head, *pr &#x3D; NULL;</span><br><span class="line">	while(p !&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		pr &#x3D; p;</span><br><span class="line">		p &#x3D; p-&gt;next;</span><br><span class="line">		free(pr);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="9-链表的删除某个节点的操作">9. 链表的删除某个节点的操作</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 链表的删除某个节点的操作*&#x2F;</span><br><span class="line">struct link *DeleteNode(struct link *head, int nodedata)</span><br><span class="line">&#123;</span><br><span class="line">	struct link *p &#x3D; head, *pr &#x3D; head;</span><br><span class="line">	if(head &#x3D;&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		printf(&quot;Linked Table is empty!\n&quot;);</span><br><span class="line">		return head;</span><br><span class="line">	&#125;</span><br><span class="line">	while(nodedata !&#x3D; p-&gt;data &amp;&amp; p-&gt;next !&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		pr &#x3D; p;</span><br><span class="line">		p &#x3D; p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	if(nodedata &#x3D;&#x3D; p-&gt;data)</span><br><span class="line">	&#123;</span><br><span class="line">		if(p &#x3D;&#x3D; head)</span><br><span class="line">		&#123;</span><br><span class="line">			head &#x3D; p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			pr-&gt;next &#x3D; p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		free(p);</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		printf(&quot;no the nodedata in the linked Table!\n&quot;);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	return head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="10-有序链表插入某个节点">10. 有序链表插入某个节点</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* 有序链表插入某个节点 *&#x2F;</span><br><span class="line">struct link *InsertNode(struct link *head, int nodedata)</span><br><span class="line">&#123;</span><br><span class="line">	struct link *pr &#x3D; head, *p &#x3D; head, *temp &#x3D; head;</span><br><span class="line">	&#x2F;&#x2F; 为插入节点开辟内存</span><br><span class="line">	p &#x3D; (struct link*)malloc(sizeof(struct link));</span><br><span class="line">	p-&gt;data &#x3D; nodedata;</span><br><span class="line">	p-&gt;next &#x3D; NULL;</span><br><span class="line">	&#x2F;&#x2F; 链表为空</span><br><span class="line">	if(head &#x3D;&#x3D; NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		printf(&quot;Linked Table is empty!\n&quot;);</span><br><span class="line">		head &#x3D; p;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	else &#x2F;&#x2F; 链表非空</span><br><span class="line">	&#123;</span><br><span class="line">		while(nodedata &gt; pr-&gt;data &amp;&amp; pr-&gt;next !&#x3D; NULL) &#x2F;&#x2F; 循环到pr-&gt;data &gt;&#x3D; nodedata 并且未到链表尾</span><br><span class="line">		&#123;</span><br><span class="line">			temp &#x3D; pr;</span><br><span class="line">			pr &#x3D; pr-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		if(nodedata &lt;&#x3D; pr-&gt;data)</span><br><span class="line">		&#123;</span><br><span class="line">			if(pr &#x3D;&#x3D; head) &#x2F;&#x2F; 头节点</span><br><span class="line">			&#123;</span><br><span class="line">				&#x2F;&#x2F; 在头节点之前插入p</span><br><span class="line">				p-&gt;next &#x3D; pr;</span><br><span class="line">				head &#x3D; p;</span><br><span class="line">			&#125;</span><br><span class="line">			else</span><br><span class="line">			&#123;</span><br><span class="line">				pr &#x3D; temp;</span><br><span class="line">				p-&gt;next &#x3D; pr-&gt;next;</span><br><span class="line">				pr-&gt;next &#x3D; p;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		else &#x2F;&#x2F; 末尾</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">			pr-&gt;next &#x3D; p;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>C语言</tag>
      </tags>
  </entry>
  <entry>
    <title>python爬虫入门学习笔记</title>
    <url>/2019-02-19-python-spider.html</url>
    <content><![CDATA[<p>学习环境:python3<br>python IDLE</p>
<a id="more"></a>

<h4><span id="1python安装30及以上版本">1.python安装3.0及以上版本</span></h4><h4><span id="2安装requests库">2.安装requests库</span></h4><p>cmd指令:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install requests</span><br></pre></td></tr></table></figure>
<p>测试:(打开python 的IDLE)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">&#x2F;&#x2F; 获取网页</span><br><span class="line">r &#x3D; requests.get(&quot;https:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">&#x2F;&#x2F; 获取状态码200为正常</span><br><span class="line">r.status_code</span><br><span class="line">&#x2F;&#x2F; 更改编码方式为utf-8</span><br><span class="line">r.encoding &#x3D; &#39;utf-8&#39;</span><br><span class="line">&#x2F;&#x2F; 打印</span><br><span class="line">r.text</span><br></pre></td></tr></table></figure>
<h4><span id="3requests库的get方法">3.requests库的get()方法</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">requests.get(url)</span><br></pre></td></tr></table></figure>
<p>它有Request和Response两个对象</p>
<h4><span id="4response对象">4.Response对象</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">r &#x3D; requests.get(&quot;https:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">print(r.status_code)</span><br><span class="line">&#x2F;&#x2F; 查看r的类型</span><br><span class="line">type(r)</span><br><span class="line">&#x2F;&#x2F; 查看r的头</span><br><span class="line">r.headers</span><br></pre></td></tr></table></figure>
<h5><span id="41-response对象的属性">4.1 Response对象的属性</span></h5><p><img src="/python-spider/python-1.png" alt="image"></p>
<h5><span id="42-request库异常">4.2 Request库异常</span></h5><p><img src="/python-spider/python-2.png" alt="image"></p>
<h5><span id="43-判断是否异常通用代码框架">4.3 判断是否异常(通用代码框架)</span></h5><p>方法:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">r.raise_for_status()</span><br><span class="line"># 如果状态不是200，报错</span><br></pre></td></tr></table></figure>
<p>通用代码框架:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">def getHTMLText(url):</span><br><span class="line">	try:</span><br><span class="line">		r &#x3D; requests.get(url, timeout &#x3D; 30)</span><br><span class="line">		r.raise_for_status() # 判断状态是否为200</span><br><span class="line">		r.encoding &#x3D; r.apparent_encoding</span><br><span class="line">		return r.text</span><br><span class="line">	except:</span><br><span class="line">		return &quot;产生异常&quot;</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">     url &#x3D; &quot;https:&#x2F;&#x2F;www.baidu.com&quot;</span><br><span class="line">     print(getHTMLText(url))</span><br></pre></td></tr></table></figure>
<h4><span id="5-request库的主要方法">5 Request库的主要方法</span></h4><p> <img src="/python-spider/python-3.png" alt="image"><br>put方法会将原有覆盖</p>
<p>patch对资源更新</p>
<h4><span id="6-网络爬虫的尺寸">6 网络爬虫的尺寸</span></h4><p><img src="/python-spider/python-4.png" alt="image"></p>
<h4><span id="7-对网络爬虫限制">7 对网络爬虫限制</span></h4><p><img src="/python-spider/python-5.png" alt="image"></p>
<h5><span id="71-robots协议">7.1 Robots协议</span></h5><p><img src="/python-spider/python-6.png" alt="image"></p>
<h4><span id="8-爬取被拒绝如果是user-agent如何爬取">8 爬取被拒绝，如果是User-Agent，如何爬取？</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查看头部User-Agent,发现User-Agent: python-requests...</span><br><span class="line">r.request.headers</span><br><span class="line"># 定义键值对去模拟浏览器访问，更改User-Agent</span><br><span class="line">kv &#x3D; &#123;&#39;User-Agent&#39;:&#39;Mozilla&#x2F;5.0&#39;&#125;</span><br><span class="line">url &#x3D; ...</span><br><span class="line"># 爬取页面，更改User-Agent</span><br><span class="line">r &#x3D; requests.get(url,headers &#x3D; kv)</span><br><span class="line"># 查看状态码，如为200则成功</span><br><span class="line">r.status_code</span><br></pre></td></tr></table></figure>
<p>例如爬取amazon的页面全代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">def getHTMLText(url):</span><br><span class="line">    try:</span><br><span class="line">        kv &#x3D; &#123;&#39;User-Agent&#39;:&#39;Mozilla&#x2F;5.0&#39;&#125;</span><br><span class="line">        r &#x3D; requests.get(url,headers &#x3D; kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding &#x3D; r.apparent_encoding</span><br><span class="line">        print(r.text) # r.text[1000:2000]指打印第1001~1999个字符</span><br><span class="line">    except:</span><br><span class="line">        print(&quot;错误&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    url &#x3D; &quot;https:&#x2F;&#x2F;www.amazon.com&quot;</span><br><span class="line">    print(getHTMLText(url))</span><br></pre></td></tr></table></figure>
<h4><span id="9-爬取百度-360关键词搜索结果">9 爬取百度 360关键词搜索结果</span></h4><p>搜索引擎关键词提交接口:<br>百度</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com&#x2F;s?wd&#x3D;keyword</span><br></pre></td></tr></table></figure>
<p>360：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.so.com&#x2F;s?q&#x3D;keyword</span><br></pre></td></tr></table></figure>
<h4><span id="10-爬取网络图片并保存">10 爬取网络图片并保存</span></h4><p>网络图片链接的格式</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.example.com&#x2F;picture.jpg</span><br></pre></td></tr></table></figure>
<p>案例，爬取google一张图</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import os</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;news.qingdaonews.com&#x2F;images&#x2F;attachement&#x2F;jpg&#x2F;site1&#x2F;20170720&#x2F;48d224f8c5531ada49cc0a.jpg&quot;</span><br><span class="line">root &#x3D; &quot;F:&#x2F;py&#x2F;py-creeper&#x2F;spider-picture&#x2F;&quot;</span><br><span class="line">path &#x3D; root  +  url.split(&#39;&#x2F;&#39;)[-1] # 剪切出图片名称</span><br><span class="line">try:</span><br><span class="line">     if not os.path.exists(root): # 判断root路径是否存在</span><br><span class="line">          os.mkdir(root)</span><br><span class="line">     if not os.path.exists(path): # 判断path下文件是否存在</span><br><span class="line">          r &#x3D; requests.get(url)</span><br><span class="line">          with open(path, &#39;wb&#39;) as f:</span><br><span class="line">               f.write(r.content)</span><br><span class="line">               f.close()</span><br><span class="line">               printf(&quot;OK&quot;)</span><br><span class="line">     else:</span><br><span class="line">          print(&quot;文件已存在&quot;)</span><br><span class="line">except:</span><br><span class="line">     print(&quot;爬取失败&quot;)</span><br></pre></td></tr></table></figure>
<h4><span id="11-ip地址归属地的自动查询">11 IP地址归属地的自动查询</span></h4><p>ip138接口形式</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;m.ip138.com&#x2F;ip.asp?ip&#x3D;IpAddress</span><br></pre></td></tr></table></figure>
<p>完整代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;m.ip138.com&#x2F;ip.asp?ip&#x3D;&quot;</span><br><span class="line">try:</span><br><span class="line">     r &#x3D; requests.get(url + &#39;202.204.80.112&#39;)</span><br><span class="line">     r.raise_for_status()</span><br><span class="line">     # r.encoding &#x3D; r.apparent.encoding</span><br><span class="line">     print(r.text)</span><br><span class="line">except:</span><br><span class="line">     print(&quot;爬取失败&quot;)</span><br></pre></td></tr></table></figure>
<h4><span id="12-网页数据的解析beautifulsoup库">12 网页数据的解析，beautifulsoup库</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 安装,打开cmd</span><br><span class="line">pip install beautifulsoup4</span><br></pre></td></tr></table></figure>
<p>使用方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from bs4 import BeautifulSoup # 从BeautifulSoup4导入BeautifulSoup类</span><br><span class="line"># data是网页数据,html.parser是解析方式</span><br><span class="line">soup &#x3D; BeautifulSoup(&lt;p&gt;data&lt;&#x2F;p&gt;,&quot;html.parser&quot;)</span><br></pre></td></tr></table></figure>

<h5><span id="121-测试解析效果">12.1 测试解析效果</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">try:</span><br><span class="line">     url &#x3D; &quot;https:&#x2F;&#x2F;python123.io&#x2F;ws&#x2F;demo.html&quot;</span><br><span class="line">     r &#x3D; requests.get(url)</span><br><span class="line">     r.raise_for_status() # 判断状态200</span><br><span class="line">     demo &#x3D; r.text</span><br><span class="line">     # 解析网页</span><br><span class="line">     soup &#x3D; BeautifulSoup(demo , &quot;html.parser&quot;) # html.parser是解析方式</span><br><span class="line">     print(soup.prettify()) # prettify意为美化</span><br><span class="line">except:</span><br><span class="line">     print(&quot;失败&quot;)</span><br></pre></td></tr></table></figure>
<p>它可以将网页标签解析为容易看的格式</p>
<p>解析结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">  &lt;title&gt;</span><br><span class="line">   This is a python demo page</span><br><span class="line">  &lt;&#x2F;title&gt;</span><br><span class="line"> &lt;&#x2F;head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line">  &lt;p class&#x3D;&quot;title&quot;&gt;</span><br><span class="line">   &lt;b&gt;</span><br><span class="line">    The demo python introduces several python courses.</span><br><span class="line">   &lt;&#x2F;b&gt;</span><br><span class="line">  &lt;&#x2F;p&gt;</span><br><span class="line">  &lt;p class&#x3D;&quot;course&quot;&gt;</span><br><span class="line">   Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line">   &lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;</span><br><span class="line">    Basic Python</span><br><span class="line">   &lt;&#x2F;a&gt;</span><br><span class="line">   and</span><br><span class="line">   &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;</span><br><span class="line">    Advanced Python</span><br><span class="line">   &lt;&#x2F;a&gt;</span><br><span class="line">   .</span><br><span class="line">  &lt;&#x2F;p&gt;</span><br><span class="line"> &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<h5><span id="122-理解beautifulsoup">12.2 理解BeautifulSoup</span></h5><p>如有需要，可直接导入整个库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import bs4</span><br></pre></td></tr></table></figure>
<p>BeautifulSoup是bs4库中的类</p>
<p>HTML = 标签树 = BeautifulSoup</p>
<h5><span id="123-beautifulsoup解析本地html文件方式">12.3 BeautifulSoup解析本地html文件方式</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from bs4 impor BeautifulSoup</span><br><span class="line"># 编码方式为utf-8</span><br><span class="line">soup1 &#x3D; BeautifulSoup(open(&quot;F:\\HTML\\text2.html&quot; , encoding &#x3D; &quot;utf-8&quot;) , &quot;html.parser&quot; )</span><br><span class="line">print(soup1.prettify())</span><br></pre></td></tr></table></figure>
<h5><span id="124-beautifulsoup的解析器">12.4 BeautifulSoup的解析器</span></h5><p><img src="/python-spider/python-7.png" alt="image"></p>
<h5><span id="125-beautifulsoup的基本元素">12.5 BeautifulSoup的基本元素</span></h5><p><img src="/python-spider/python-8.png" alt="image"></p>
<h5><span id="126-利用beautifulsoup查看元素信息">12.6 利用BeautifulSoup查看元素信息</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">r &#x3D; requests.get(&quot;https:&#x2F;&#x2F;python123.io&#x2F;ws&#x2F;demo.html&quot;)</span><br><span class="line">demo &#x3D; r.text</span><br><span class="line">soup &#x3D; BeautifulSoup(demo , &quot;html.parser&quot;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查看标题</span><br><span class="line">soup.title</span><br><span class="line"># 输出： &lt;title&gt;This is a python demo page&lt;&#x2F;title&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查询标签为&lt;a&gt;的</span><br><span class="line">tag &#x3D; soup.a</span><br><span class="line"># 输出其中第一个: &lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查看标签名</span><br><span class="line">soup.a.name</span><br><span class="line"># 输出： &#39;a&#39;</span><br><span class="line"># 查看其父名</span><br><span class="line">soup.a.parent.name</span><br><span class="line"># 输出：&#39;p&#39;</span><br><span class="line"># 查看其父父名</span><br><span class="line">soup.a.parent.parent.name</span><br><span class="line"># 输出 ：&#39;body&#39;</span><br></pre></td></tr></table></figure>
<p>查看标签属性信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tag1 &#x3D; soup.a</span><br><span class="line"># .attrs属性</span><br><span class="line">tag1.attrs # 输出：&#123;&#39;href&#39;: &#39;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&#39;, &#39;class&#39;: [&#39;py1&#39;], &#39;id&#39;: &#39;link1&#39;&#125;</span><br><span class="line"># &lt;a&gt;标签的属性也是一个字典</span><br></pre></td></tr></table></figure>
<p>提取属性中的信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 提取class中值</span><br><span class="line">tag1.attrs[&#39;class&#39;]</span><br><span class="line"># 输出: [&#39;py1&#39;]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 提取链接</span><br><span class="line">tag1.attrs[&#39;href&#39;]</span><br><span class="line"># 输出：&#39;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&#39;</span><br></pre></td></tr></table></figure>
<p>提取标签中的内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">soup.a.string</span><br><span class="line"># 输出： &#39;Basic Python&#39;</span><br><span class="line">soup.p.string</span><br><span class="line"># 输出：&#39;The demo python introduces several python courses.&#39;</span><br></pre></td></tr></table></figure>
<p>特别的是：注释标签，获取内容时不会表示其中是否是注释，只有通过查看它的类型来区分</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; newsoup &#x3D; BeautifulSoup(&quot;&lt;b&gt;&lt;!--This is a comment--&gt;&lt;&#x2F;b&gt;&lt;p&gt;This is not a comment &lt;&#x2F;p&gt;&quot;, &quot;html.parser&quot;)</span><br><span class="line">&gt;&gt;&gt; newsoup.b.string</span><br><span class="line">&#39;This is a comment&#39;</span><br><span class="line">&gt;&gt;&gt; type(newsoup.b.string)</span><br><span class="line">&lt;class &#39;bs4.element.Comment&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; newsoup.p.string</span><br><span class="line">&#39;This is not a comment &#39;</span><br><span class="line">&gt;&gt;&gt; type(newsoup.p.string)</span><br><span class="line">&lt;class &#39;bs4.element.NavigableString&#39;&gt;</span><br></pre></td></tr></table></figure>

<h5><span id="127-元素-属性总结">12.7 元素、属性总结</span></h5><p><img src="/python-spider/python-9.png" alt="image"></p>
<h4><span id="13-基于bs4的html的遍历方法">13 基于bs4的HTML的遍历方法</span></h4><p><img src="/python-spider/python-10.png" alt="image"></p>
<h5><span id="131-标签树的下行遍历">13.1 标签树的下行遍历</span></h5><p><img src="/python-spider/python-11.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.head</span><br><span class="line">&lt;head&gt;&lt;title&gt;This is a python demo page&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;</span><br></pre></td></tr></table></figure>
<p>head的子节点列表,body的子节点列表</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># head的子节点列表</span><br><span class="line">&gt;&gt;&gt; soup.head.contents</span><br><span class="line">[&lt;title&gt;This is a python demo page&lt;&#x2F;title&gt;]</span><br><span class="line"># body的子节点列表</span><br><span class="line">&gt;&gt;&gt; soup.body.contents</span><br><span class="line">[&#39;\n&#39;, &lt;p class&#x3D;&quot;title&quot;&gt;&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;, &#39;\n&#39;, &lt;p class&#x3D;&quot;course&quot;&gt;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line"></span><br><span class="line">&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt; and &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;, &#39;\n&#39;]</span><br></pre></td></tr></table></figure>
<p>查看body子节点的个数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; len(soup.body.contents)</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
<p>输出body子节点列表中第一个元素</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.body.contents[1]</span><br><span class="line">&lt;p class&#x3D;&quot;title&quot;&gt;&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>
<h5><span id="遍历子节点-子孙节点">遍历子节点、子孙节点</span></h5><p>==遍历子节点==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for child in soup.body.children:</span><br><span class="line">	print(child)</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;p class&#x3D;&quot;title&quot;&gt;&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;p class&#x3D;&quot;course&quot;&gt;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line"></span><br><span class="line">&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt; and &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>
<p>==遍历子孙节点==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for child in soup.body.descendants:</span><br><span class="line">	print(child)</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;p class&#x3D;&quot;title&quot;&gt;&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;</span><br><span class="line">The demo python introduces several python courses.</span><br><span class="line">&lt;p class&#x3D;&quot;course&quot;&gt;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line">&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt; and &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;</span><br><span class="line">Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line">&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;</span><br><span class="line">Basic Python</span><br><span class="line"> and </span><br><span class="line">&lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;</span><br><span class="line">Advanced Python</span><br><span class="line">.</span><br></pre></td></tr></table></figure>
<h5><span id="132-标签树的上行遍历">13.2 标签树的上行遍历</span></h5><p><img src="/python-spider/python-12.png" alt="image"><br>与下行遍历类似</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">soup.body.parent</span><br><span class="line">soup.body.parents</span><br></pre></td></tr></table></figure>
<p>==soup本身的parent为空==</p>
<p>打印&lt;a&gt;标签的.parents.name</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; demo &#x3D; r.text</span><br><span class="line">&gt;&gt;&gt; soup &#x3D; BeautifulSoup(demo , &quot;html.parser&quot;)</span><br><span class="line">&gt;&gt;&gt; for parent in soup.a.parents:</span><br><span class="line">	if parent is None:</span><br><span class="line">		print(parent)</span><br><span class="line">	else:</span><br><span class="line">		print(parent.name)</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">p</span><br><span class="line">body</span><br><span class="line">html</span><br><span class="line">[document]</span><br></pre></td></tr></table></figure>
<h5><span id="133-平行遍历">13.3 平行遍历</span></h5><p><img src="/python-spider/python-13.png" alt="image"></p>
<p>==条件：平行遍历发生在同一个父子节点下的节点==</p>
<p>遍历&lt;a&gt;之后的平行节点</p>
<p>==注意：节点有可能是string类型的and，而不一定完全是标签类型==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for sibling in soup.a.next_siblings:</span><br><span class="line">	if isinstance(sibling,str):</span><br><span class="line">		print(sibling)</span><br><span class="line">	else:</span><br><span class="line">		print(sibling.name)</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line"> and </span><br><span class="line">a</span><br><span class="line">.</span><br></pre></td></tr></table></figure>
<p>遍历&lt;a&gt;之后的平行节点</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for sibling in soup.a.next_siblings:</span><br><span class="line">	print(sibling)</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"> and </span><br><span class="line">&lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;</span><br><span class="line">.</span><br></pre></td></tr></table></figure>
<p>遍历&lt;a&gt;之前的平行节点</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for sibling in soup.a.previous_siblings:</span><br><span class="line">	print(sibling)</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br></pre></td></tr></table></figure>
<h5><span id="134-规整输出html的prettify方法">13.4 规整输出HTML的prettify()方法</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print(soup.prettify())</span><br><span class="line">print(soup.a.prettify())</span><br></pre></td></tr></table></figure>
<h4><span id="14-信息标记的三种形式">14 信息标记的三种形式</span></h4><p>XML</p>
<p><img src="/python-spider/python-14.png" alt="image"><br>JSON : 有类型的键值对</p>
<p><img src="/python-spider/python-15.png" alt="image"><br>YAML ：无类型的键值对</p>
<p><img src="/python-spider/python-16.png" alt="image"></p>
<h4><span id="15-信息的提取">15 信息的提取</span></h4><p>实例<br><img src="/python-spider/python-17.png" alt="image"><br>使用了soup.find_all()方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">查找所有&lt;a&gt;</span><br><span class="line">soup.find_all(&#39;a&#39;)</span><br></pre></td></tr></table></figure>
<p>完整代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">url &#x3D; &quot;https:&#x2F;&#x2F;python123.io&#x2F;ws&#x2F;demo.html&quot;</span><br><span class="line">try:</span><br><span class="line">     r &#x3D; requests.get(url)</span><br><span class="line">     r.raise_for_status()</span><br><span class="line">     demo &#x3D; r.text</span><br><span class="line">     soup &#x3D; BeautifulSoup(demo , &quot;html.parser&quot; )</span><br><span class="line">     for link in soup.find_all(&#39;a&#39;):</span><br><span class="line">          print(link.get(&#39;href&#39;))</span><br><span class="line">except:</span><br><span class="line">     print(&quot;失败&quot;)</span><br></pre></td></tr></table></figure>
<h5><span id="151-soupfind_all方法的查询信息">15.1 soup.find_all()方法的查询信息</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;&gt;.find_all(name,attrs,recursive,string,**kwargs)</span><br></pre></td></tr></table></figure>
<h6><span id="1511-参数name表示对标签名字的查找字符串">15.1.1 参数name，表示对标签名字的查找字符串</span></h6><p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import requests</span><br><span class="line">&gt;&gt;&gt; from bs4 import BeautifulSoup</span><br><span class="line">&gt;&gt;&gt; url &#x3D; &quot;https:&#x2F;&#x2F;python123.io&#x2F;ws&#x2F;demo.html&quot;</span><br><span class="line">&gt;&gt;&gt; r &#x3D; requests.get(url)</span><br><span class="line">&gt;&gt;&gt; demo &#x3D; r.text</span><br><span class="line">&gt;&gt;&gt; soup &#x3D; BeautifulSoup(demo , &quot;html.parser&quot;)</span><br></pre></td></tr></table></figure>
<p>查找所有&lt;a&gt;标签，输出是个列表</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all(&#39;a&#39;)</span><br><span class="line">[&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;, &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;]</span><br></pre></td></tr></table></figure>
<p>查找所有的&lt;a&gt;&lt;b&gt;标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all([&#39;a&#39; , &#39;b&#39;])</span><br><span class="line">[&lt;b&gt;The demo python introduces several python courses.&lt;&#x2F;b&gt;, &lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;, &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;]</span><br></pre></td></tr></table></figure>
<p>如果soup.find_all(True) , 则表示==查找出所有的标签==</p>
<p>打印页面所有标签名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for tag in soup.find_all(True):</span><br><span class="line">	print(tag.name)</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">html</span><br><span class="line">head</span><br><span class="line">title</span><br><span class="line">body</span><br><span class="line">p</span><br><span class="line">b</span><br><span class="line">p</span><br><span class="line">a</span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<p>打印所有以b开头的标签</p>
<p>用到==正则表达式库==</p>
<p>使用方法:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查找所有以b开头的标签</span><br><span class="line">soup.find_all(re.compile(&#39;b&#39;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; for tag in soup.find_all(re.compile(&#39;b&#39;)):</span><br><span class="line">	print(tag.name)</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">body</span><br><span class="line">b</span><br></pre></td></tr></table></figure>
<h6><span id="1512-参数attrs对标签属性值的检索字符串可标注属性检索">15.1.2 参数attrs，对标签属性值的检索字符串，可标注属性检索</span></h6><p>实例:</p>
<p>检索带有course属性值的&lt;p&gt;标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all(&#39;p&#39; , &#39;course&#39;)</span><br><span class="line">[&lt;p class&#x3D;&quot;course&quot;&gt;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:</span><br><span class="line"></span><br><span class="line">&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt; and &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;]</span><br></pre></td></tr></table></figure>
<p>查找属性id=’link1’的标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">soup.find_all(id&#x3D;&#39;link1&#39;)</span><br><span class="line">[&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;]</span><br></pre></td></tr></table></figure>
<p>使用正则表达式检索所有id包含’link’的标签，link1,link2…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; soup.find_all(id &#x3D; re.compile(&#39;link&#39;))</span><br><span class="line">[&lt;a class&#x3D;&quot;py1&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-268001&quot; id&#x3D;&quot;link1&quot;&gt;Basic Python&lt;&#x2F;a&gt;, &lt;a class&#x3D;&quot;py2&quot; href&#x3D;&quot;http:&#x2F;&#x2F;www.icourse163.org&#x2F;course&#x2F;BIT-1001870001&quot; id&#x3D;&quot;link2&quot;&gt;Advanced Python&lt;&#x2F;a&gt;]</span><br></pre></td></tr></table></figure>
<h6><span id="1513-参数-recursive是否对子孙全部检索默认true改为false时表示只检索其子节点">15.1.3 参数 recursive：是否对子孙全部检索，默认True,改为False时，表示只检索其子节点</span></h6><p>例：表示soup的子节点中没有&lt;a&gt;标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all(&#39;a&#39; , recursive&#x3D;False)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>
<h6><span id="1514-参数string-ltgtltgt中字符串区域的检索字符串">15.1.4 参数string : &lt;&gt;…&lt;/&gt;中字符串区域的检索字符串</span></h6><p>例:</p>
<p>检索标签内容中的 Basic Python</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all(string &#x3D; &quot;Basic Python&quot;)</span><br><span class="line">[&#39;Basic Python&#39;]</span><br></pre></td></tr></table></figure>

<p>使用正则表达式检索标签内容==含有==Python的内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; soup.find_all(string &#x3D; re.compile(&quot;Python&quot;))</span><br><span class="line">[&#39;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:\r\n&#39;, &#39;Basic Python&#39;, &#39;Advanced Python&#39;]</span><br></pre></td></tr></table></figure>
<h6><span id="1515-find的扩展方法">15.1.5 find的扩展方法</span></h6><p><img src="/python-spider/python-18.png" alt="image"></p>
<p>由于find_all()十分常用，==soup.find_all()等价于soup()==</p>
<h4><span id="16-实例爬取中国大学排名信息">16 实例，爬取中国大学排名信息</span></h4><p>完整代码:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import bs4</span><br><span class="line"></span><br><span class="line"># 爬取大学排名网页</span><br><span class="line">def getHTMLText(url):</span><br><span class="line">     try:</span><br><span class="line">          r &#x3D; requests.get(url , timeout &#x3D; 30)</span><br><span class="line">          r.raise_for_status() # 判断状态码</span><br><span class="line">          r.encoding &#x3D; r.apparent_encoding</span><br><span class="line">          return r.text</span><br><span class="line">     except:</span><br><span class="line">          return &quot;爬取失败&quot;</span><br><span class="line"></span><br><span class="line"># 提取网页中大学排名相关信息，并存到列表</span><br><span class="line">def getUnivList(ulist , html):</span><br><span class="line">     soup &#x3D; BeautifulSoup(html , &quot;html.parser&quot;)</span><br><span class="line">     for tr in soup.find(&#39;tbody&#39;).children:</span><br><span class="line">          if isinstance(tr , bs4.element.Tag):</span><br><span class="line">               tds &#x3D; tr.find_all(&#39;td&#39;)</span><br><span class="line">               ulist.append( [tds[0].string , tds[1].string , tds[3].string] )</span><br><span class="line">               </span><br><span class="line">     </span><br><span class="line"># 输出大学排名列表</span><br><span class="line">def printUnivList(ulist , num):</span><br><span class="line">     tplt &#x3D; &quot;&#123;0:^6&#125;\t&#123;1:&#123;3&#125;^15&#125;\t&#123;2:^6&#125;&quot;</span><br><span class="line">     print(tplt.format(&quot;排名&quot; , &quot;大学名称&quot; , &quot;总分&quot; , chr(12288)))</span><br><span class="line">     for i in range(num):</span><br><span class="line">          u &#x3D; ulist[i]</span><br><span class="line">          print(tplt.format(u[0] , u[1] , u[2] , chr(12288)))</span><br><span class="line">     print(str(num) + &quot;所大学&quot;)</span><br><span class="line">     </span><br><span class="line"></span><br><span class="line"># 主函数</span><br><span class="line">def main():</span><br><span class="line">     uinfo &#x3D; []</span><br><span class="line">     url &#x3D; &quot;http:&#x2F;&#x2F;www.zuihaodaxue.com&#x2F;zuihaodaxuepaiming2019.html&quot;</span><br><span class="line">     html &#x3D; getHTMLText(url)</span><br><span class="line">     getUnivList(uinfo , html)</span><br><span class="line">     printUnivList(uinfo , 30)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h5><span id="161-代码分析">16.1 代码分析</span></h5><hr>
<p>为什么导入 bs4库?</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># isinstance()用于判断tr类型时，bs4.element.Tag需要用到bs4库</span><br><span class="line"> isinstance(tr , bs4.element.Tag)</span><br></pre></td></tr></table></figure>
<hr>
<p> 主函数<br> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> def main():</span><br><span class="line">    ...</span><br><span class="line">main()</span><br></pre></td></tr></table></figure></p>
<hr>
<p>==注意网页的编码方式==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">r.encoding &#x3D; r.apparent_encoding</span><br></pre></td></tr></table></figure>
<hr>
<p>网页表格的父子关系:  ==标签==</p>
<p>&lt;tbody&gt;–&gt;&lt;tr&gt;–&gt;&lt;td&gt;</p>
<p>&lt;tbody&gt;包含整个表的信息，这里包含全部大学排名及其相关的信息</p>
<p>&lt;tr&gt;包含一个大学的所有相关信息,表示表的==每一行==</p>
<p>&lt;td&gt;就是一个大学中的一个信息，如名称，排名；表格==一行中的一个信息==</p>
<hr>
<p>数据的存入：</p>
<p>使用二维列表;</p>
<p>一维列表中再存一维列表构成二维列表</p>
<hr>
<p>格式化输出 str.format()</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print(&quot;&#123;:^6&#125;\t&#123;:^15&#125;\t&#123;:^6&#125;&quot;.format(&quot;排名&quot;，&quot;大学名称&quot;,&quot;分数&quot;))</span><br></pre></td></tr></table></figure>
<p>^ 表示右对齐</p>
<hr>
<p>格式化输出的优化（中西文输出的优化）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 表示中文的空格</span><br><span class="line">chr(12288)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># &#123;1:&#123;3&#125;^15&#125; 含义:1代表format()中第二个参数来填充这个位置；</span><br><span class="line"># &#123;3&#125;代表用format()中第四个参数来填充字符前的空白区域</span><br><span class="line"># 15代表宽度</span><br><span class="line">string1 &#x3D; &quot;&#123;0:^6&#125;\t&#123;1:&#123;3&#125;^15&#125;\t&#123;2:^6&#125;&quot;.format(u[0],u[1],u[2],chr(12288))</span><br></pre></td></tr></table></figure>
<h4><span id="17-正则表达式">17 正则表达式</span></h4><p><img src="/python-spider/python-19.png" alt="image"></p>
<p><img src="/python-spider/python-20.png" alt="image"></p>
<p><img src="/python-spider/python-21.png" alt="image"></p>
<p><img src="/python-spider/python-22.png" alt="image"></p>
<p><img src="/python-spider/python-23.png" alt="image"></p>
<p>正则表达式的表示类型<br><img src="/python-spider/python-24.png" alt="image"></p>
<p><img src="/python-spider/python-25.png" alt="image"></p>
<h4><span id="18-re库主要功能函数正则表达式库">18 Re库主要功能函数(正则表达式库)</span></h4><p><img src="/python-spider/python-26.png" alt="image"></p>
<h5><span id="181-research">18.1 re.search()</span></h5><p><img src="/python-spider/python-27.png" alt="image"></p>
<p><img src="/python-spider/python-28.png" alt="image"></p>
<p>例:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; match &#x3D; re.search(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;BIT 100081&#39;)</span><br><span class="line">&gt;&gt;&gt; if match:</span><br><span class="line">	print(match.group(0))</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">100081</span><br></pre></td></tr></table></figure>
<h5><span id="182-rematch">18.2 re.match()</span></h5><p>它匹配字符串是在==头位置匹配==</p>
<p>例:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; match &#x3D; re.match(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;100067 BIT&#39;)</span><br><span class="line">&gt;&gt;&gt; if match:</span><br><span class="line">	print(match.group(0))</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">100067</span><br></pre></td></tr></table></figure>
<h5><span id="183-refindall">18.3 re.findall()</span></h5><p>它返回的是个列表</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; ls &#x3D; re.findall(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;IJK100088 OKL156009 IOP188899&#39;)</span><br><span class="line">&gt;&gt;&gt; print(ls)</span><br><span class="line">[&#39;100088&#39;, &#39;156009&#39;, &#39;188899&#39;]</span><br></pre></td></tr></table></figure>
<h5><span id="184-resplit">18.4 re.split()</span></h5><p><img src="/python-spider/python-29.png" alt="image"></p>
<p>maxsplit=1 参数表示，只切割出第一个，剩下的原样输出</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; re.split(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;IJK100088 OKL156009 IOP188899&#39;)</span><br><span class="line">[&#39;IJK&#39;, &#39; OKL&#39;, &#39; IOP&#39;, &#39;&#39;]</span><br><span class="line">&gt;&gt;&gt; re.split(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;IJK100088 OKL156009 IOP188899&#39; , maxsplit&#x3D;1)</span><br><span class="line">[&#39;IJK&#39;, &#39; OKL156009 IOP188899&#39;]</span><br></pre></td></tr></table></figure>
<h5><span id="185-refinditer">18.5 re.finditer()</span></h5><p>finditer()遍历了整个字符串，每次返回一个match类型</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; for m in re.finditer(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;IJK100088 OKL156009 IOP188899&#39;):</span><br><span class="line">	if m:</span><br><span class="line">		print(m.group(0))</span><br><span class="line"></span><br><span class="line">100088</span><br><span class="line">156009</span><br><span class="line">188899</span><br></pre></td></tr></table></figure>
<h5><span id="186-resubpatternreplstringcount0flags0">18.6 re.sub(pattern,repl,string,count=0,flags=0)</span></h5><p><img src="/python-spider/python-30.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; re.sub(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;zipcode&#39; , &#39;IJK100088 OKL156009 IOP188899&#39;)</span><br><span class="line">&#39;IJKzipcode OKLzipcode IOPzipcode&#39;</span><br></pre></td></tr></table></figure>
<h5><span id="187-正则表达式的面向对象的用法">18.7 正则表达式的面向对象的用法</span></h5><p><img src="/python-spider/python-31.png" alt="image"></p>
<p>将正则表达式存储为==正则表达式对象==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pat &#x3D; re.compile(r&#39;[1-9]\d&#123;5&#125;&#39;)</span><br></pre></td></tr></table></figure>
<h5><span id="188-regex-recompilepatternflags0">18.8 regex = re.compile(pattern,flags=0)</span></h5><p>regex:正则表达式</p>
<p>等价用法:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">regex.search()</span><br><span class="line">regex.match()</span><br><span class="line">regex.findall()</span><br><span class="line">regex.split()</span><br><span class="line">regex.finditer()</span><br><span class="line">regex.sub()</span><br></pre></td></tr></table></figure>
<h5><span id="189-match对象">18.9 match对象</span></h5><p>==match对象只有一个结果，字符串中有多个可用finditer()==</p>
<p><img src="/python-spider/python-32.png" alt="image"></p>
<p><img src="/python-spider/python-33.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; m &#x3D; re.search(r&#39;[1-9]\d&#123;5&#125;&#39; , &#39;KLO100089 JIO100056&#39;)</span><br><span class="line">&gt;&gt;&gt; m.string</span><br><span class="line">&#39;KLO100089 JIO100056&#39;</span><br><span class="line">&gt;&gt;&gt; m.re</span><br><span class="line">re.compile(&#39;[1-9]\\d&#123;5&#125;&#39;)</span><br><span class="line">&gt;&gt;&gt; m.pos</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt; m.endpos</span><br><span class="line">19</span><br><span class="line">&gt;&gt;&gt; m.group(0)</span><br><span class="line">&#39;100089&#39;</span><br><span class="line">&gt;&gt;&gt; m</span><br><span class="line">&lt;re.Match object; span&#x3D;(3, 9), match&#x3D;&#39;100089&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; m.start()</span><br><span class="line">3</span><br><span class="line">&gt;&gt;&gt; m.end()</span><br><span class="line">9</span><br></pre></td></tr></table></figure>
<h4><span id="19-实例爬取京东鼠标">19 实例：爬取京东鼠标</span></h4><h5><span id="191-查看链接与接口">19.1 查看链接与接口</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;pvid&#x3D;ab1812a3adfc4abfa04fc59f52d3e6cb</span><br><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;3&amp;s&#x3D;59&amp;click&#x3D;0</span><br><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;5&amp;s&#x3D;114&amp;click&#x3D;0</span><br><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;7&amp;s&#x3D;166&amp;click&#x3D;0</span><br><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;9&amp;s&#x3D;218&amp;click&#x3D;0</span><br><span class="line"># https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;11&amp;s&#x3D;271&amp;click&#x3D;0</span><br></pre></td></tr></table></figure>
<h5><span id="192-使用的库">19.2 使用的库</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br></pre></td></tr></table></figure>
<h5><span id="193-查看网页源码提取信息">19.3 查看网页源码提取信息</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if len(name[i].split(&#39;&gt;&#39;)) &lt; 3 :</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[1]</span><br><span class="line">            elif len(name[i].split(&#39;&gt;&#39;)) &gt;&#x3D; 3 and len(name[i].split(&#39;&gt;&#39;)) &lt; 6 :</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[2]</span><br><span class="line">            else:</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[7]</span><br><span class="line">            name2 &#x3D; name1.split(&#39;&lt;&#39;)[0]</span><br><span class="line">            price1 &#x3D; price[i].split(&#39;&gt;&#39;)[1]</span><br><span class="line">            price2 &#x3D; price1.split(&#39;&lt;&#39;)[0]</span><br><span class="line">            ulist.append([name2 , price2])</span><br></pre></td></tr></table></figure>

<h5><span id="194-完整代码">19.4 完整代码</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def getHTMLText(url):</span><br><span class="line">    try:</span><br><span class="line">        kv &#x3D; &#123;&#39;User-Agent&#39;:&#39;Mozilla&#x2F;5.0&#39;&#125;</span><br><span class="line">        r &#x3D; requests.get(url , headers &#x3D; kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding &#x3D; r.apparent_encoding</span><br><span class="line">        return r.text</span><br><span class="line">    except:</span><br><span class="line">        return &quot;爬取失败&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getInfo(ulist , html):</span><br><span class="line">    name &#x3D; re.findall(&#39;\&lt;em\&gt;.*?\&lt;font&#39; , html)</span><br><span class="line">    price &#x3D; re.findall(&#39;\&lt;i\&gt;[\d]*\.[\d]*\&lt;\&#x2F;i\&gt;&#39; , html)</span><br><span class="line">    for i in range(len(name)):</span><br><span class="line">        try:</span><br><span class="line">            if len(name[i].split(&#39;&gt;&#39;)) &lt; 3 :</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[1]</span><br><span class="line">            elif len(name[i].split(&#39;&gt;&#39;)) &gt;&#x3D; 3 and len(name[i].split(&#39;&gt;&#39;)) &lt; 6 :</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[2]</span><br><span class="line">            else:</span><br><span class="line">                name1 &#x3D; name[i].split(&#39;&gt;&#39;)[7]</span><br><span class="line">            name2 &#x3D; name1.split(&#39;&lt;&#39;)[0]</span><br><span class="line">            price1 &#x3D; price[i].split(&#39;&gt;&#39;)[1]</span><br><span class="line">            price2 &#x3D; price1.split(&#39;&lt;&#39;)[0]</span><br><span class="line">            ulist.append([name2 , price2])</span><br><span class="line">        except:</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def printList(ulist):</span><br><span class="line">    string &#x3D; &#39;&#123;0:&lt;6&#125;\t&#123;1:&#123;3&#125;&lt;40&#125;\t&#123;2:&lt;6&#125;&#39;</span><br><span class="line">    print(string.format(&quot;商品序列&quot;,&quot;商品名称&quot;,&quot;商品价格&quot;,chr(12288)))</span><br><span class="line">    for i in range(len(ulist)):</span><br><span class="line">        info &#x3D; ulist[i]</span><br><span class="line">        print(string.format(i+1,info[0],info[1],chr(12288)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    infoList &#x3D; []</span><br><span class="line">    pageNum &#x3D; 5</span><br><span class="line">    url &#x3D; &quot;https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&quot;</span><br><span class="line">    </span><br><span class="line">    for i in range(pageNum):</span><br><span class="line">        html &#x3D; getHTMLText(url)</span><br><span class="line">        url &#x3D; &quot;https:&#x2F;&#x2F;search.jd.com&#x2F;Search?keyword&#x3D;%E9%BC%A0%E6%A0%87&amp;enc&#x3D;utf-8&quot; + &quot;&amp;qrst&#x3D;1&amp;rt&#x3D;1&amp;stop&#x3D;1&amp;vt&#x3D;2&amp;wq&#x3D;%E9%BC%A0%E6%A0%87&amp;page&#x3D;&quot; + str(3+2*i) + &quot;&amp;s&#x3D;&quot; + str(59*(i+1)) + &quot;&amp;click&#x3D;0&quot;</span><br><span class="line">        getInfo(infoList , html)</span><br><span class="line"></span><br><span class="line">    printList(infoList)</span><br><span class="line">    </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h4><span id="20-scrapy框架">20 scrapy框架</span></h4><p>安装scrapy</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># cmd 命令</span><br><span class="line">pip install scrapy</span><br></pre></td></tr></table></figure>

<h5><span id="201-框架结构">20.1 框架结构</span></h5><p><img src="/python-spider/python-34.png" alt="image"></p>
<h5><span id="202-scrapy-常用命令">20.2  scrapy 常用命令</span></h5><p>查看命令行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scrapy -h</span><br></pre></td></tr></table></figure>
<p><img src="/python-spider/python-35.png" alt="image"></p>
<h5><span id="203-小实例">20.3 小实例</span></h5><p>cmd下操作</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 某目录下创建项目</span><br><span class="line">scrapy startproject python123demo</span><br></pre></td></tr></table></figure>
<p><img src="/python-spider/python-36.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd python123demo</span><br><span class="line"># 生成爬虫</span><br><span class="line">scrapy genspider demo python.io</span><br></pre></td></tr></table></figure>
<p>编辑生成的demo.py</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DemoSpider(scrapy.Spider):</span><br><span class="line">    # 爬虫名</span><br><span class="line">    name &#x3D; &#39;demo&#39;</span><br><span class="line">    # 爬取的链接</span><br><span class="line">    start_urls &#x3D; [&#39;http:&#x2F;&#x2F;python.io&#x2F;ws&#x2F;demo.html&#39;]</span><br><span class="line"></span><br><span class="line">    def parse(self, response):</span><br><span class="line">        # 爬取的页面保存为文件</span><br><span class="line">        fname &#x3D; response.url.split(&#39;&#x2F;&#39;)[-1]</span><br><span class="line">        with open(fname , &#39;wb&#39;) as f:</span><br><span class="line">            f.write(response.body)</span><br><span class="line">            fname.close()</span><br><span class="line">        self.log(&#39;saved file %s&#39; % fname)</span><br></pre></td></tr></table></figure>
<p>运行爬虫文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># cmd 运行爬虫文件</span><br><span class="line">scrapy crawl demo.py</span><br></pre></td></tr></table></figure>
<h5><span id="204-yield-关键字">20.4 yield 关键字</span></h5><p>yeild是一个生成器，当运行到它时，它会生成一个值，然后冻结，直到再次唤醒它，再生成一个值,一般与循环连用</p>
<p>例:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">def gen(n):</span><br><span class="line">	for i in range(n):</span><br><span class="line">		yield i**2</span><br><span class="line"></span><br><span class="line">for i in gen(5):</span><br><span class="line">    print(i,&quot; &quot;,end&#x3D;&quot;&quot;)</span><br><span class="line"></span><br><span class="line"># 结果: 0  1  4  9  16</span><br></pre></td></tr></table></figure>
<h5><span id="205-使用yield优化demo爬虫">20.5 使用yield优化demo爬虫</span></h5><p>在链接非常多的情况下，能有效地节约资源</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DemoSpider(scrapy.Spider):</span><br><span class="line">    # 爬虫名</span><br><span class="line">    name &#x3D; &#39;demo&#39;</span><br><span class="line">    # 爬取的链接</span><br><span class="line">    def start_requests(self):</span><br><span class="line">        urls &#x3D; [&#39;http:&#x2F;&#x2F;python123.io&#x2F;ws&#x2F;demo.html&#39;]</span><br><span class="line">        # 使用生成器去调用链接</span><br><span class="line">        for url in urls:</span><br><span class="line">            yield scrapy.Request(url&#x3D;url , callback&#x3D;self.parse)</span><br><span class="line"></span><br><span class="line">    def parse(self, response):</span><br><span class="line">        # 爬取的页面保存为文件</span><br><span class="line">        fname &#x3D; response.url.split(&#39;&#x2F;&#39;)[-1]</span><br><span class="line">        with open(fname , &#39;wb&#39;) as f:</span><br><span class="line">            f.write(response.body)</span><br><span class="line">            fname.close()</span><br><span class="line">        self.log(&#39;saved file %s&#39; % fname)</span><br></pre></td></tr></table></figure>
<h4><span id="21-scrapy爬虫的数据类型">21 scrapy爬虫的数据类型</span></h4><h5><span id="211-request类">21.1 Request类</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class scrapy.http.Request()</span><br></pre></td></tr></table></figure>
<p>表示一个http请求</p>
<p><img src="/python-spider/python-37.png" alt="image"></p>
<h5><span id="212-response类">21.2 Response类</span></h5><p><img src="/python-spider/python-38.png" alt="image"></p>
<h5><span id="213-item类">21.3 Item类</span></h5><h4><span id="22-实例爬取股票数据">22 实例:爬取股票数据</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 新浪股票</span><br><span class="line">https:&#x2F;&#x2F;finance.sina.com.cn&#x2F;stock&#x2F;</span><br><span class="line"># 百度股票</span><br><span class="line">https:&#x2F;&#x2F;gupiao.baidu.com&#x2F;stock</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 股票代码一览表</span><br><span class="line">http:&#x2F;&#x2F;quote.eastmoney.com&#x2F;stocklist.html</span><br></pre></td></tr></table></figure>
<p>全部代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import traceback</span><br><span class="line">import bs4</span><br><span class="line"></span><br><span class="line">class SpiderStock:</span><br><span class="line">    # 初始化</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line">    </span><br><span class="line">    # 获取页面</span><br><span class="line">    def getHTMLText(self,url):</span><br><span class="line">        try:</span><br><span class="line">            kv &#x3D; &#123;&#39;User-Agent&#39;:&#39;Mozilla&#x2F;5.0&#39;&#125;</span><br><span class="line">            r &#x3D; requests.get(url , headers &#x3D; kv)</span><br><span class="line">            r.raise_for_status()</span><br><span class="line">            r.encoding &#x3D; r.apparent_encoding</span><br><span class="line">            return r.text</span><br><span class="line">        except:</span><br><span class="line">            print(&quot;\r爬取失败&quot;,end&#x3D;&#39;&#39;)</span><br><span class="line"></span><br><span class="line">    # 提取信息</span><br><span class="line">    def getInfo(self,sCodeList,fname):</span><br><span class="line">        count &#x3D; 0</span><br><span class="line">        infoDict &#x3D; &#123;&#125;</span><br><span class="line">        for stock in sCodeList:</span><br><span class="line">            try:</span><br><span class="line">                    url &#x3D; &quot;https:&#x2F;&#x2F;gupiao.baidu.com&#x2F;stock&#x2F;&quot; + stock</span><br><span class="line">                    if url &#x3D;&#x3D; &#39;&#39;:</span><br><span class="line">                        continue</span><br><span class="line">                        </span><br><span class="line">                    html &#x3D; self.getHTMLText(url)</span><br><span class="line">                        </span><br><span class="line">                    soup &#x3D; BeautifulSoup(html,&#39;html.parser&#39;)</span><br><span class="line">                    # 查询股票信息的位置</span><br><span class="line">                    infoStock &#x3D; soup.find(&#39;div&#39;,attrs &#x3D; &#123;&#39;class&#39;:&#39;stock-bets&#39;&#125;)</span><br><span class="line">                    # 股票名称</span><br><span class="line">                    name &#x3D; infoStock.find(&#39;a&#39;,attrs &#x3D; &#123;&#39;class&#39;:&#39;bets-name&#39;&#125;)</span><br><span class="line">                    # 存放在字典中</span><br><span class="line">                    infoDict.update(&#123;&#39;股票名称&#39;:name.text.split()[0]&#125;)</span><br><span class="line">                    </span><br><span class="line">                    keyList &#x3D; infoStock.find_all(&#39;dt&#39;)</span><br><span class="line">                    valueList &#x3D; infoStock.find_all(&#39;dd&#39;)</span><br><span class="line">                </span><br><span class="line">                    </span><br><span class="line">                    for j in range(len(valueList)):</span><br><span class="line">                        key &#x3D; keyList[j].text</span><br><span class="line">                        value &#x3D; valueList[j].text</span><br><span class="line">                        # 字典添加值</span><br><span class="line">                        infoDict[key] &#x3D; value</span><br><span class="line"></span><br><span class="line">                    # 将信息保存在文件</span><br><span class="line">                    with open(fname,&#39;a&#39;,encoding&#x3D;&#39;utf-8&#39;) as f:</span><br><span class="line">                        f.write(str(infoDict) + &#39;\n&#39;)</span><br><span class="line">                        count &#x3D; count + 1</span><br><span class="line">                        print(&#39;\r当前进度: &#123;:.2f&#125;%&#39;.format(count*100&#x2F;len(sCodeList)),end&#x3D;&#39;&#39;)</span><br><span class="line">            except:</span><br><span class="line">                count &#x3D; count + 1</span><br><span class="line">                print(&#39;\r当前进度: &#123;:.2f&#125;%&#39;.format(count*100&#x2F;len(sCodeList)),end&#x3D;&#39;&#39;)</span><br><span class="line">                # traceback.print_exc()  显示错误</span><br><span class="line">                continue</span><br><span class="line">                </span><br><span class="line">    # 获取股票代码</span><br><span class="line">    def getStockList(self,sUrl):</span><br><span class="line">        try:</span><br><span class="line">            string &#x3D; r&#39;[s][hz][\d]&#123;6&#125;\.[h][t][m][l]&#39;</span><br><span class="line">            html &#x3D; self.getHTMLText(sUrl)</span><br><span class="line">            sCodeList &#x3D; re.findall(string,html)</span><br><span class="line">            return sCodeList</span><br><span class="line">        except:</span><br><span class="line">            print(&quot;\r获取股票代码失败&quot;,end&#x3D;&#39;&#39;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    # 输出表</span><br><span class="line">    def printList(self , slist):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    # 主函数</span><br><span class="line">    def main(self):</span><br><span class="line">        url &#x3D; &quot;https:&#x2F;&#x2F;gupiao.baidu.com&#x2F;stock&quot;</span><br><span class="line">        sCodeUrl &#x3D; &quot;http:&#x2F;&#x2F;quote.eastmoney.com&#x2F;stocklist.html&quot;</span><br><span class="line">        # 存储文件路径</span><br><span class="line">        fname &#x3D; &quot;F:\\py\\py-spider\\spider-stock\\info_stock.txt&quot;</span><br><span class="line">        slist &#x3D; []</span><br><span class="line">        lack_slist &#x3D; []</span><br><span class="line">        slist &#x3D; self.getStockList(sCodeUrl)</span><br><span class="line">        # 确定股票数</span><br><span class="line">        for i in range(20):</span><br><span class="line">            lack_slist.append(slist[i])</span><br><span class="line">        </span><br><span class="line">        self.getInfo(lack_slist , fname)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">spiderstock &#x3D; SpiderStock()</span><br><span class="line">spiderstock.main()</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>python爬虫</tag>
      </tags>
  </entry>
  <entry>
    <title>HTML学习笔记</title>
    <url>/2019-06-12-html-note.html</url>
    <content><![CDATA[<p>由于自己学着ruby on rails网站的部署，现在也部署成功了；<br>因此开始学习前端的一些知识；<br>这里是我学习html的学习笔记。</p>
<p>我是在w3school学习的;<a href="www.w3school.com.cn/">w3school</a></p>
<a id="more"></a>

<hr>
<h4><span id="1-html标签的学习">1. html标签的学习</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body bgcolor&#x3D;&quot;blue&quot;&gt;</span><br><span class="line">&lt;!--标题--&gt;</span><br><span class="line">&lt;h1 align&#x3D;&quot;center&quot;&gt;一级标题(heading1)&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;h2&gt;二级标题(heading2)&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--段落--&gt;</span><br><span class="line">&lt;p&gt;这是段落内容(paragraph)&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--链接--&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;inno-hua.xyz&quot;&gt;这是一个链接(Link)(href&#x3D;hypertext reference)&lt;&#x2F;a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--图片,name.jpg在同一文件夹下&gt;</span><br><span class="line">&lt;img src&#x3D;&quot;name.jpg&quot; width&#x3D;&quot;100&quot; hight&#x3D;&quot;100&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;br &#x2F;&gt;  &lt;!--换行--&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr &#x2F;&gt;  &lt;!--水平线--&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--使用style属性--&gt;</span><br><span class="line">&lt;body style&#x3D;&quot;background-color:red&quot;&gt;</span><br><span class="line">&lt;h1 style&#x3D;&quot;background:blue&quot;&gt;这是标题&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;hr&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--元素中文本的字体系列、颜色和字体尺寸--&gt;</span><br><span class="line">&lt;h2 style&#x3D;&quot;font-family:arial;color:blue;font-size:20px&quot;&gt;a heading2&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;p style&#x3D;&quot;text-align:center;font-family:arial;font-size:30px&quot;&gt;a paragraph&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p style&#x3D;&quot;background:green&quot;&gt;这是段落&lt;&#x2F;p&gt;</span><br><span class="line">&lt;hr &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--文本格式化标签--&gt;</span><br><span class="line">&lt;p&gt;&lt;b&gt;黑体&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;tt&gt;呈现类似打字机或者等宽的文本效果&lt;&#x2F;tt&gt;</span><br><span class="line">&lt;i&gt;斜体字&lt;&#x2F;i&gt;</span><br><span class="line">&lt;big&gt;大号字&lt;&#x2F;big&gt;</span><br><span class="line">&lt;small&gt;小号字&lt;&#x2F;small&gt;</span><br><span class="line">&lt;em&gt;定义着重文字。&lt;&#x2F;em&gt; </span><br><span class="line">&lt;strong&gt;定义加重语气。&lt;&#x2F;strong&gt; </span><br><span class="line">&lt;sub&gt;定义下标字。&lt;&#x2F;sub&gt; </span><br><span class="line">&lt;sup&gt;定义上标字。&lt;&#x2F;sup&gt; </span><br><span class="line">&lt;ins&gt;定义插入字。&lt;&#x2F;ins&gt; </span><br><span class="line">&lt;del&gt;定义删除字。&lt;&#x2F;del&gt;</span><br><span class="line">&lt;hr &#x2F;&gt;</span><br><span class="line">&lt;!--“计算机输出”标签--&gt;</span><br><span class="line">&lt;code&gt;定义计算机代码。&lt;&#x2F;code&gt; </span><br><span class="line">&lt;kbd&gt;定义键盘码。&lt;&#x2F;kbd&gt; </span><br><span class="line">&lt;smap&gt;定义计算机代码样本。&lt;&#x2F;smap&gt; </span><br><span class="line">&lt;tt&gt;定义打字机代码。&lt;&#x2F;tt&gt; </span><br><span class="line">&lt;var&gt;定义变量。&lt;&#x2F;var&gt; </span><br><span class="line">&lt;pre&gt;定义预格式文本。&lt;&#x2F;pre&gt;</span><br><span class="line">&lt;hr &#x2F;&gt;</span><br><span class="line">&lt;!--引用、引用和术语定义--&gt;</span><br><span class="line">&lt;abbr&gt;定义缩写。&lt;&#x2F;abbr&gt; </span><br><span class="line">&lt;acronym&gt;定义首字母缩写。&lt;&#x2F;acronym&gt; </span><br><span class="line">&lt;address&gt;定义地址。&lt;&#x2F;address&gt; </span><br><span class="line">&lt;bdo&gt;定义文字方向。&lt;&#x2F;bdo&gt; </span><br><span class="line">&lt;blockquote&gt;定义长的引用。&lt;&#x2F;blockquote&gt; </span><br><span class="line">&lt;q&gt;定义短的引用语。&lt;&#x2F;q&gt; </span><br><span class="line">&lt;cite&gt;定义引用、引证。&lt;&#x2F;cite&gt; </span><br><span class="line">&lt;dfn&gt;定义一个定义项目。&lt;&#x2F;dfn&gt;</span><br><span class="line">&lt;br &#x2F;&gt;</span><br><span class="line">&lt;!--实例--&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">	my goals are &lt;q&gt;can complete the learn.&lt;&#x2F;q&gt;</span><br><span class="line">	&lt;br &#x2F;&gt;</span><br><span class="line">	&lt;p&gt;以下内容引用自 WWF 的网站：&lt;&#x2F;p&gt;</span><br><span class="line">	&lt;blockquote cite&#x3D;&quot;http:&#x2F;&#x2F;www.worldwildlife.org&#x2F;who&#x2F;index.html&quot;&gt;</span><br><span class="line">		五十年来，WWF 一直致力于保护自然界的未来。</span><br><span class="line">世界领先的环保组织，WWF 工作于 100 个国家，</span><br><span class="line">并得到美国一百二十万会员及全球近五百万会员的支持。</span><br><span class="line">	&lt;&#x2F;blockquote&gt;</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">	&lt;abbr title&#x3D;&quot;World Health Organization&quot;&gt;WHO&lt;&#x2F;abbr&gt;</span><br><span class="line">	成立于 1948 年。</span><br><span class="line">	&lt;p&gt;&lt;dfn&gt;&lt;abbr title&#x3D;&quot;World Health Organization&quot;&gt;WHO&lt;&#x2F;abbr&gt;&lt;&#x2F;dfn&gt; 成立于 1948 年。&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;!--HTML &lt;address&gt; 元素定义文档或文章的联系信息（作者&#x2F;拥有者）。此元素通常以斜体显示--&gt;</span><br><span class="line">&lt;address&gt;</span><br><span class="line">	written by inno.&lt;br &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;address&gt;</span><br><span class="line">&lt;!--&lt;cite&gt; 元素定义著作的标题。--&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">	&lt;cite&gt;The Scream&lt;&#x2F;cite&gt;by Edward Munch. Painted in 1893.</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;!--HTML &lt;bdo&gt; 元素定义双流向覆盖（bi-directional override）。&lt;bdo&gt; 元素用于覆盖当前文本方向：--&gt;</span><br><span class="line">	&lt;p&gt;</span><br><span class="line">		&lt;bdo dir&#x3D;&quot;rtl&quot;&gt;This text will be written from right to left&lt;&#x2F;bdo&gt;</span><br><span class="line">	&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--HTML 键盘格式 HTML &lt;kbd&gt; 元素定义键盘输入：--&gt;</span><br><span class="line">&lt;p&gt;To open a file, select:&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;&lt;kbd&gt;File | Open...&lt;&#x2F;kbd&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;!--code--&gt;</span><br><span class="line">&lt;p&gt;Coding Example:&lt;&#x2F;p&gt;</span><br><span class="line">&lt;code&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">var person &#x3D; &#123;</span><br><span class="line">    firstName:&quot;Bill&quot;,</span><br><span class="line">    lastName:&quot;Gates&quot;,</span><br><span class="line">    age:50,</span><br><span class="line">    eyeColor:&quot;blue&quot;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;pre&gt;</span><br><span class="line">&lt;&#x2F;code&gt;</span><br><span class="line">&lt;hr &#x2F;&gt;</span><br><span class="line">&lt;!--HTML &lt;var&gt; 元素定义数学变量：--&gt;</span><br><span class="line">&lt;p&gt;Einstein wrote:&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;&lt;var&gt;E &#x3D; m c&lt;sup&gt;2&lt;&#x2F;sup&gt;&lt;&#x2F;var&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;!--样式css--&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">h1 &#123;color: red&#125;</span><br><span class="line">p &#123;color: blue&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;header 1&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;p&gt;A paragraph.&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;!--没有下滑线的链接--&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;gb2312&quot; &#x2F;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Language&quot; content&#x3D;&quot;zh-cn&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;&#x2F;example&#x2F;html&#x2F;lastpage.html&quot; style&#x3D;&quot;text-decoration:none&quot;&gt;</span><br><span class="line">这是一个链接！</span><br><span class="line">&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;!--外部样式表--&gt;</span><br><span class="line">&lt;!--当样式需要被应用到很多页面的时候，外部样式表将是理想的选择。使用外部样式表，你就可以通过更改一个文件来改变整个站点的外观。--&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;&#x2F;html&#x2F;csstest1.css&quot; &gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;我通过外部样式表进行格式化。&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;p&gt;我也一样！&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr &#x2F;&gt;</span><br><span class="line">&lt;!--内部样式表--&gt;</span><br><span class="line">&lt;!--当单个文件需要特别样式时，就可以使用内部样式表。你可以在 head 部分通过 &lt;style&gt; 标签定义内部样式表。--&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">body &#123;background-color: red&#125;</span><br><span class="line">p &#123;margin-left: 20px&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;!--内联样式--&gt;</span><br><span class="line">&lt;!--当特殊的样式需要应用到个别元素时，就可以使用内联样式。 使用内联样式的方法是在相关的标签中使用样式属性。样式属性可以包含任何 CSS 属性。以下实例显示出如何改变段落的颜色和左外边距。--&gt;	</span><br><span class="line">&lt;p style&#x3D;&quot;color: red; margin-left: 20px&quot;&gt;</span><br><span class="line">This is a paragraph</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--HTML 链接 - target 属性--&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;&quot; target&#x3D;&quot;_blank&quot;&gt;Visit W3School!&lt;&#x2F;a&gt;</span><br><span class="line">&lt;p&gt;如果把链接的 target 属性设置为 &quot;_blank&quot;，该链接会在新窗口中打开。&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--链接到同一页面的某一位置--&gt;</span><br><span class="line">&lt;p&gt;&lt;a href&#x3D;&quot;#top&quot;&gt;到达顶端&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;!--邮件链接--&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">这是邮件链接：</span><br><span class="line">&lt;a href&#x3D;&quot;mailto:someone@microsoft.com?subject&#x3D;Hello%20again&quot;&gt;发送邮件&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">&lt;b&gt;注意：&lt;&#x2F;b&gt;应该使用 %20 来替换单词之间的空格，这样浏览器就可以正确地显示文本了。</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;hr&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title>给service添加ssh port</title>
    <url>/2019-06-12-service-add-ssh-port.html</url>
    <content><![CDATA[<p>给service添加ssh port</p>
<a id="more"></a>

<h5><span id="1远程登录服务器后">1.远程登录服务器后</span></h5><p>输入指令:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br></pre></td></tr></table></figure>
<p>在末尾添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Port 22</span><br></pre></td></tr></table></figure>
<p>重启ssh</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service ssh restart</span><br></pre></td></tr></table></figure>
<h5><span id="2vim未安装">2.vim未安装</span></h5><p>安装：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install vim</span><br></pre></td></tr></table></figure>
<h5><span id="3若再次登录时出现warning-remote-host-identification-has-changed">3.若再次登录时出现WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!</span></h5><p>解决见<a href="https://zuahua.github.io/2018/12/08/ss-issue1/" target="_blank" rel="noopener external nofollow noreferrer">这篇文章</a></p>
]]></content>
      <tags>
        <tag>ss</tag>
      </tags>
  </entry>
  <entry>
    <title>ruby on Rails建站思路</title>
    <url>/2018-12-07-ruby-on-rails-jian-zhan-si-lu.html</url>
    <content><![CDATA[<p>建网站需要我会ruby,ruby on rails,nodejs,git，gem…….</p>
<p>然而我只会“教程”</p>
<p>很菜很佛</p>
<p>所以理理思路</p>
<p>了解一下我不了解的东西</p>
<a id="more"></a>

<h4><span id="1nodejs是js的服务器运行环境">1.nodejs是js的服务器运行环境</span></h4><h4><span id="2rbenv-是ruby的版本管理器">2.rbenv 是ruby的版本管理器</span></h4><h4><span id="3gem和bundle">3.Gem和bundle</span></h4><p>gem与bundler是关于一个ruby项目的软件包依赖的, 它们是以一个ruby项目为中心的</p>
<p>项目的根目录会有一个Gemfile, 里面定义了该项目的软件包依赖的相关事项. 发现它默认是从rubygems.org这个网站获取内容的. 我想把源换成taobao.org. 可以修改Gemfile文件. 把source那一行改成: source ‘<a href="http://ruby.taobao.org/&#39;" target="_blank" rel="noopener external nofollow noreferrer">http://ruby.taobao.org/&#39;</a></p>
<p> bundle是用来管理维护项目的软件包的;</p>
<p> gem则是用来管理具体的每一个软件包的. </p>
<h6><span id="bundler配置文件">bundler配置文件</span></h6><p>项目特定配置文件, 放在项目根目录下的.bundle/config文件中.</p>
<p>全局的配置文件, 放在 ~/.bundle/config文件中.</p>
<p>我参考了这儿<a href="https://blog.csdn.net/zdq0394123/article/details/8075493" target="_blank" rel="noopener external nofollow noreferrer">他也不知道参考的谁</a></p>
<h4><span id="4-nginx和passanger">4. Nginx和Passanger</span></h4><h5><span id="41-nginx这个软件用来处理http请求">4.1 Nginx这个软件用来处理HTTP请求</span></h5><h5><span id="42-nginx接收到请求转手给phusion-passenger用于部署">4.2 Nginx接收到请求转手给Phusion Passenger，用于部署</span></h5><h5><span id="43-passenger是nginx集成的软件">4.3 Passenger是Nginx集成的软件</span></h5><h5><span id="44-修改配置文件告诉nginx使用的是哪个版本的ruby">4.4 修改配置文件告诉Nginx使用的是哪个版本的ruby</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;mod-http-passenger.conf</span><br></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">passenger_ruby &#x2F;home&#x2F;my&#x2F;.rbenv&#x2F;shims&#x2F;ruby;</span><br></pre></td></tr></table></figure>
<p>注释掉这行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">### passenger_ruby &#x2F;usr&#x2F;bin&#x2F;passenger_free_ruby; ###</span><br></pre></td></tr></table></figure>
<h4><span id="5capistrano是一个用ruby写的可以自动布署的软件">5.Capistrano是一个用Ruby写的可以自动布署的软件</span></h4><p><a href="https://capistranorb.com/" target="_blank" rel="noopener external nofollow noreferrer">Capistrano</a></p>
<h4><span id="6capistrano自动部署">6.Capistrano自动部署</span></h4><h5><span id="61新建rails项目">6.1新建rails项目</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails new project-ruby -d mysql</span><br></pre></td></tr></table></figure>
<h5><span id="62将项目加入版本管理系统">6.2将项目加入版本管理系统</span></h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd project-ruby</span><br><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git status</span><br><span class="line">git commit -m &quot;First Commit&quot;</span><br></pre></td></tr></table></figure>
<hr>
<h5><span id="出现问题">==出现问题==</span></h5><p>*** 请告诉我你是谁。</p>
<p>运行</p>
<p>  git config –global user.email “<a href="mailto:you@example.com" rel="external nofollow noreferrer">you@example.com</a>“<br>  git config –global user.name “Your Name”</p>
<p>来设置您账号的缺省身份标识。<br>如果仅在本仓库设置身份标识，则省略 –global 参数。</p>
<p>==解决：==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global user.email &quot;you@example.com&quot;</span><br></pre></td></tr></table></figure>
<p>==然后再==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit -m &quot;First Commit&quot;</span><br></pre></td></tr></table></figure>
<hr>
<p>使用github存放代码，新建github仓库</p>
<p>新建仓库名：myWebSight</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add origin git@github.com:zuahua&#x2F;myWebSite.git</span><br></pre></td></tr></table></figure>
<p>push 上去</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>
<hr>
<p>==出现问题==<br>Warning: Permanently added ‘github.com,—‘ (RSA) to the list of known hosts.<br><a href="mailto:git@github.com" rel="external nofollow noreferrer">git@github.com</a>: Permission denied (publickey).<br>fatal: 无法读取远程仓库。</p>
<p>请确认您有正确的访问权限并且仓库存在。</p>
<p>==原因:本地机未与github建立ssh key==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</span><br></pre></td></tr></table></figure>
<p>将生成的id_rsa.pub中的内容复制到github的ssh中</p>
<p>这样github才能识别出你</p>
<hr>
<p>==再==<br>push 上去</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>
<hr>
<p>没几天又重push时</p>
<p>error: 无法推送一些引用到 ‘git@github.com:zuahua/myWebSite.git’<br>提示：更新被拒绝，因为远程仓库包含您本地尚不存在的提交。这通常是因为另外<br>提示：一个仓库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更</p>
<p>==强行push==</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push -u origin +master</span><br></pre></td></tr></table></figure>

<hr>
<h4><span id="7配置gemfile">7.配置Gemfile</span></h4><p>在rails项目文件夹内</p>
<p>打开Gemfile文件配置</p>
<p>在末尾加入</p>
<p>主要目的是安装这些Gem</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim Gemfile</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  # Windows does not include zoneinfo files, so bundle the tzinfo-data gem</span><br><span class="line">  </span><br><span class="line">gem &#39;tzinfo&#39;,platforms: [:mingw, :mswin, :x64_mingw, :jruby]</span><br><span class="line">group :development do</span><br><span class="line">  gem &#39;capistrano&#39;, &#39;~&gt; 3.11&#39;</span><br><span class="line">  gem &#39;capistrano-rails&#39;, &#39;~&gt; 1.4&#39;</span><br><span class="line">  gem &#39;capistrano-passenger&#39;, &#39;~&gt; 0.2.0&#39;</span><br><span class="line">  gem &#39;capistrano-rbenv&#39;, &#39;~&gt; 2.1&#39;, &#39;&gt;&#x3D; 2.1.3&#39;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>保存，退出后</p>
<p>bundle命令安装上面的gem</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bundle</span><br><span class="line">bundle --binstubs</span><br></pre></td></tr></table></figure>
<p>然后再生成capistrano的配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cap install STAGES&#x3D;production</span><br></pre></td></tr></table></figure>
<p>结果与生成的文件如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p config&#x2F;deploy</span><br><span class="line">create config&#x2F;deploy.rb</span><br><span class="line">create config&#x2F;deploy&#x2F;production.rb</span><br><span class="line">mkdir -p lib&#x2F;capistrano&#x2F;tasks</span><br><span class="line">create Capfile</span><br><span class="line">Capified</span><br></pre></td></tr></table></figure>
<h5><span id="71生成了capistrano这些配置文件以后再对这些配置文件进行配置">7.1生成了Capistrano这些配置文件以后，再对这些配置文件进行配置</span></h5><h6><span id="711-deployrb">7.1.1 deploy.rb</span></h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim config&#x2F;deploy.rb</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">######################################################这儿</span><br><span class="line">set :application, &quot;myWebSite&quot;</span><br><span class="line"></span><br><span class="line">set :repo_url, &quot;git@github.com:zuahua&#x2F;myWebSite.git&quot;</span><br><span class="line">########################################################</span><br><span class="line"></span><br><span class="line"># Default branch is :master</span><br><span class="line"># ask :branch, &#96;git rev-parse --abbrev-ref HEAD&#96;.chomp</span><br><span class="line">######################################################这儿</span><br><span class="line"># Default deploy_to directory is &#x2F;var&#x2F;www&#x2F;my_app_name</span><br><span class="line"># set :deploy_to, &quot;&#x2F;var&#x2F;www&#x2F;my_app_name&quot;</span><br><span class="line">set :deploy_to, &quot;&#x2F;home&#x2F;my&#x2F;myWebSite&quot;</span><br><span class="line">######################################################</span><br><span class="line"># Default value for :format is :airbrussh.</span><br><span class="line"># set :format, :airbrussh</span><br><span class="line"></span><br><span class="line"># You can configure the Airbrussh format using :format_options.</span><br><span class="line"># These are the defaults.</span><br><span class="line"># set :format_options, command_output: true, log_file: &quot;log&#x2F;capistrano.log&quot;, color: :auto, truncate: :auto</span><br><span class="line"></span><br><span class="line"># Default value for :pty is false</span><br><span class="line"># set :pty, true</span><br><span class="line">######################################################这儿</span><br><span class="line"># Default value for :linked_files is []</span><br><span class="line"># append :linked_files, &quot;config&#x2F;database.yml&quot;</span><br><span class="line">append :linked_files, &quot;config&#x2F;database.yml&quot;, &quot;config&#x2F;master.key&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Default value for linked_dirs is []</span><br><span class="line"># append :linked_dirs, &quot;log&quot;, &quot;tmp&#x2F;pids&quot;, &quot;tmp&#x2F;cache&quot;, &quot;tmp&#x2F;sockets&quot;, &quot;public&#x2F;system&quot;</span><br><span class="line">append :linked_dirs, &quot;log&quot;, &quot;tmp&#x2F;pids&quot;, &quot;tmp&#x2F;cache&quot;, &quot;tmp&#x2F;sockets&quot;, &quot;vendor&#x2F;bundle&quot;, &quot;public&#x2F;system&quot;, &quot;public&#x2F;uploads&quot;</span><br><span class="line">######################################################</span><br></pre></td></tr></table></figure>
<h6><span id="712-productionrb">7.1.2 production.rb</span></h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim config&#x2F;deploy&#x2F;production.rb</span><br></pre></td></tr></table></figure>

<p>确定部署在哪儿</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">################################## 这儿</span><br><span class="line">server &#39;104.225.237.232&#39;, user: &#39;my&#39;, roles: %w&#123;app db web&#125;</span><br><span class="line">#################################</span><br><span class="line"># server-based syntax</span><br><span class="line"># &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"># Defines a single server with a list of roles and multiple properties.</span><br><span class="line"># You can define all roles on a single server, or split them:</span><br><span class="line"></span><br><span class="line"># server &quot;example.com&quot;, user: &quot;deploy&quot;, roles: %w&#123;app db web&#125;, my_property: :my_value</span><br><span class="line"># server &quot;example.com&quot;, user: &quot;deploy&quot;, roles: %w&#123;app web&#125;, other_property: :other_value</span><br><span class="line"># server &quot;db.example.com&quot;, user: &quot;deploy&quot;, roles: %w&#123;db&#125;</span><br></pre></td></tr></table></figure>
<h6><span id="723-capfile">7.2.3 Capfile</span></h6><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim Capfile</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># require &quot;capistrano&#x2F;rvm&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;rbenv&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;chruby&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;bundler&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;rails&#x2F;assets&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;rails&#x2F;migrations&quot;</span><br><span class="line"># require &quot;capistrano&#x2F;passenger&quot;</span><br><span class="line">#########################################  这儿</span><br><span class="line">require &#39;capistrano&#x2F;rails&#39;</span><br><span class="line">require &#39;capistrano&#x2F;passenger&#39;</span><br><span class="line">require &#39;capistrano&#x2F;rbenv&#39;</span><br><span class="line">set :rbenv_type, :user</span><br><span class="line">set :rbenv_ruby, &#39;2.5.1&#39;</span><br><span class="line">#######################################</span><br><span class="line"># Load custom tasks from &#96;lib&#x2F;capistrano&#x2F;tasks&#96; if you have any defined</span><br><span class="line">Dir.glob(&quot;lib&#x2F;capistrano&#x2F;tasks&#x2F;*.rake&quot;).each &#123; |r| import r &#125;</span><br></pre></td></tr></table></figure>
<h4><span id="8在本地开发机上隐藏一些敏感信息">8.在本地开发机上隐藏一些敏感信息</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;config&#x2F;database.yml&quot; &gt;&gt; .gitignore</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim .gitignore</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Ignore bundler config.</span><br><span class="line">&#x2F;.bundle</span><br><span class="line">#####################################这儿</span><br><span class="line"># Ignore all logfiles and tempfiles.</span><br><span class="line">&#x2F;log&#x2F;*</span><br><span class="line">!&#x2F;log&#x2F;.keep</span><br><span class="line">&#x2F;tmp&#x2F;.keep</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Ignore uploaded files in development.</span><br><span class="line">&#x2F;storage&#x2F;*</span><br><span class="line">!&#x2F;storage&#x2F;.keep</span><br><span class="line"></span><br><span class="line">&#x2F;node_modeles</span><br><span class="line">&#x2F;yarn-error.log</span><br><span class="line"></span><br><span class="line">&#x2F;public&#x2F;assets</span><br><span class="line">.byebug_history</span><br><span class="line"></span><br><span class="line"># Igore master key for decrypting credentials and more.</span><br><span class="line">config&#x2F;master.key</span><br><span class="line">config&#x2F;database.yml</span><br><span class="line">################################</span><br></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add .gitignore</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git mv config&#x2F;database.yml config&#x2F;database.yml.sample</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit -m &quot;Only store sample database config&quot;</span><br><span class="line">cp config&#x2F;database.yml.sample config&#x2F;database.yml</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;configure Capistrano&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<p>push 上去</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure>
<h4><span id="9在本地机器上执行命令布署">9.在本地机器上执行命令布署</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cap production deploy</span><br></pre></td></tr></table></figure>

<h5><span id="91问题">9.1==问题==</span></h5><p>服务器上找不到database.yml</p>
<p>/home/…/shared/config这个目录下，在建立的database.yml中输入如下内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">production:</span><br><span class="line">  adapter: mysql2</span><br><span class="line">  database: myWebSite</span><br><span class="line">  username: root</span><br><span class="line">  password: .......</span><br></pre></td></tr></table></figure>
<h6><span id="92服务器上找不到masterkey文件">9.2==服务器上找不到master.key文件==</span></h6> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp config&#x2F;master.key my@104.225.237.232:&#x2F;home&#x2F;my&#x2F;myWebSite&#x2F;shared&#x2F;config</span><br></pre></td></tr></table></figure>
<hr>
<p>==由于未知原因，本地config目录下也未自动生成master.key，因此出现问题==</p>
<p>之后将secrets.yml上传到服务器，修改deploy.rb配置文件中的Link:mater.key也替换成secrets.yml</p>
<p>并在.gitignore中添加了secrets.yml</p>
<hr>
<h5><span id="93找不到javascript库">9.3找不到JavaScript库</span></h5><p>服务器上安装</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install nodejs</span><br></pre></td></tr></table></figure>
<h4><span id="10配置nginx">10配置Nginx</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;default ~&#x2F;default20181215</span><br><span class="line"># ~&#x2F;default20181215备份</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80 default_server;</span><br><span class="line">        listen [::]:80 default_server;</span><br><span class="line"></span><br><span class="line">        server_name innohua.com;</span><br><span class="line">        passenger_enabled on;</span><br><span class="line">        rails_env    production;</span><br><span class="line">        root         &#x2F;home&#x2F;my&#x2F;myWebSite&#x2F;current&#x2F;public;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page &#x2F;50x.html</span><br><span class="line">        error_page   500 502 503 504  &#x2F;50x.html;</span><br><span class="line">        location &#x3D; &#x2F;50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重启</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure>
<h4><span id="11部署测试">11.部署测试</span></h4><p>本地机</p>
<p>建立数据库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo mysql -u root -p</span><br><span class="line">create database myWebSite_development;</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<hr>
<p>之后出现本地无法部署的情况<br>并且root@localhost被拒</p>
<p>可能是mysql未使用某个database和database.yml没配置好</p>
<p>之后在mysql新建了一个用户，并创建使用某个database,修改了database.yml配置文件，成功</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE USER &#39;inno&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password&#39;;</span><br><span class="line"># 所有权限都给inno</span><br><span class="line">GRANT ALL PRIVILEGES ON * . * TO &#39;inno&#39;@&#39;localhost&#39;;</span><br><span class="line">exit;</span><br><span class="line"></span><br><span class="line">mysql -u inno -p</span><br><span class="line">create database myWebSite_development4;</span><br><span class="line">use myWebSite_development4;</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<hr>
<p>查看并修改database.yml</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim config&#x2F;database.yml</span><br></pre></td></tr></table></figure>
<hr>
<p>修改:主要修改了用户、密码、数据库名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">default: &amp;default</span><br><span class="line">  adapter: mysql2</span><br><span class="line">  encoding: utf8</span><br><span class="line">  pool: 5</span><br><span class="line">  username: inno</span><br><span class="line">  password: mypassword</span><br><span class="line">  socket: &#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock</span><br><span class="line"></span><br><span class="line">development:</span><br><span class="line">  &lt;&lt;: *default</span><br><span class="line">  # database: projectruby4_development</span><br><span class="line">  database: myWebSite_development4</span><br></pre></td></tr></table></figure>
<hr>
<p>建立小测试</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails g scaffold phone name</span><br></pre></td></tr></table></figure>
<p>查看路由</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim config&#x2F;routes.rb</span><br></pre></td></tr></table></figure>
<hr>
<p>==问题==<br>如果没有指向路由，添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root to:&quot;phones#index&quot;</span><br></pre></td></tr></table></figure>
<hr>
<p>操作数据库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># rails db:migrate是ruby5.0版本之后的</span><br><span class="line">rails db:migrate</span><br><span class="line"># 低版本 rake db:migrate</span><br></pre></td></tr></table></figure>



<p>查看</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails s</span><br></pre></td></tr></table></figure>
<p>可本地查看了</p>
<p>部署到网页</p>
<p>先推送到github</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git status</span><br><span class="line">git commit -m &quot;text deploy&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<p>部署</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cap production deploy</span><br></pre></td></tr></table></figure>
<hr>
<p>==错误==</p>
<p>出现phones表已存在</p>
<p>服务器端登录mysql;删掉自己创建的数据库中的phones表</p>
<p>再本地</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cap production deploy</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<p>==问题==</p>
<p>部署后网页出现</p>
<p>==Incomplete response received from application==</p>
<p>运行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rake secret</span><br></pre></td></tr></table></figure>
<p>复制结果到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim config&#x2F;secrets.yml</span><br></pre></td></tr></table></figure>
<p>production后的环境变量</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">secret_key_base: &lt;%&#x3D; ENV[&quot;SECRET_KEY_BASE&quot;] %&gt;</span><br></pre></td></tr></table></figure>
<p>替换冒号后的</p>
<p>将这个文件copy到服务器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp config&#x2F;secrets.yml my@104.225.237.232:&#x2F;home&#x2F;my&#x2F;myWebSite&#x2F;shared&#x2F;config</span><br></pre></td></tr></table></figure>
<p>服务器端重启app</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">passenger-config restart-app</span><br></pre></td></tr></table></figure>

<hr>
<p>继续测试</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim app&#x2F;views&#x2F;phones&#x2F;index.html.erb</span><br></pre></td></tr></table></figure>
<p>更改标题为…后</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git status</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;change of index.html.erb&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cap production deploy</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>RubyWeb建站</tag>
      </tags>
  </entry>
  <entry>
    <title>求三角形外接圆的圆心</title>
    <url>/2019-06-12-qiu-san-jiao-xing-wai-jie-yuan-de-yuan-xin.html</url>
    <content><![CDATA[<p>已知三点坐标<br>求三角形外接圆的圆心</p>
<a id="more"></a>

<hr>
<h4><span id="求三角形外接圆的圆心">求三角形外接圆的圆心</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 外接圆圆心、半径</span><br><span class="line">double x,y,r;</span><br><span class="line">double A1,B1,C1,A2,B2,C2;</span><br><span class="line">&#x2F;&#x2F; 三点</span><br><span class="line">double x1,x2,x3,y1,y2,y3;</span><br><span class="line">&#x2F;&#x2F; 给点赋值</span><br><span class="line">x1 &#x3D; p[0].x;</span><br><span class="line">x2 &#x3D; p[1].x;</span><br><span class="line">x3 &#x3D; p[2].x;</span><br><span class="line">y1 &#x3D; p[0].y;</span><br><span class="line">y2 &#x3D; p[1].y;</span><br><span class="line">y3 &#x3D; p[2].y;</span><br><span class="line">A1 &#x3D; 2*(x2-x1);</span><br><span class="line">B1 &#x3D; 2*(y2-y1);</span><br><span class="line">C1 &#x3D; x2*x2+y2*y2-x1*x1-y1*y1;</span><br><span class="line">A2 &#x3D; 2*(x3-x2);</span><br><span class="line">B2 &#x3D; 2*(y3-y2);</span><br><span class="line">C2 &#x3D; x3*x3+y3*y3-x2*x2-y2*y2;</span><br><span class="line">	</span><br><span class="line">x &#x3D; ((C1*B2)-(C2*B1))&#x2F;((A1*B2)-(A2*B1));</span><br><span class="line">y &#x3D; ((A1*C2)-(A2*C1))&#x2F;((A1*B2)-(A2*B1));</span><br><span class="line">r &#x3D; sqrt((x-p[0].x)*(x-p[0].x)+(y-p[0].y)*(y-p[0].y));</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>算法笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>bwg搭建ss教程</title>
    <url>/2018-11-22-bwg-ss.html</url>
    <content><![CDATA[<p>bwg搭建ss教程</p>
<p>本文来自：<a href="https://www.vpnask.com/fanqiang/bandwagonhost-install-shadowsocks/" target="_blank" rel="noopener external nofollow noreferrer">搬瓦工(BandwagonHost)取消了一键安装SS后，最新搬瓦工手动安装SS教程！</a></p>
<a id="more"></a>

<hr>
<h4><span id="安装ssr脚本">安装SSR脚本</span></h4><p><strong>第一步</strong>：（登录服务器后）等到出现root@host~字样，复制下面脚本第1条命令，回车：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget --no-check-certificate -O shadowsocks-all.sh https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;teddysun&#x2F;shadowsocks_install&#x2F;master&#x2F;shadowsocks-all.sh</span><br></pre></td></tr></table></figure>
<p>注意⚠️：国外服务器运行脚本时容易出错，如出现错误提示 bash: wget: command not found，可以请在先执行 yum -y install wget 命令。成功后，再执行上面的命令。如果没有出现提示错误，请略过。</p>
<p><strong>第二步</strong>：等待如上图所示之后，我们输入第2条脚本命令，回车：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod +x shadowsocks-all.sh</span><br></pre></td></tr></table></figure>
<p><strong>第三步</strong>：等待如上图所示之后，输入第3条脚本命令，回车：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;shadowsocks-all.sh 2&gt;&amp;1 | tee shadowsocks-all.log</span><br></pre></td></tr></table></figure>
<p><strong>第四步</strong>：出现以上画面，根据需要选择，不懂的话直接选1，或者默认回车。下面会提示你输入你的SS SERVER的密码，和端口。不输入就是默认。跑完命令后会出来你的SS客户端的信息。</p>
<p><strong>第五步</strong>：我们输入完成ss的密码和端口号之后，进行回车：</p>
<p><strong>第六步</strong>：特别注意，由于iPhone端的的wingy目前只支持到cfb，所以我们选择aes-256-cfb，即7 ，回车：</p>
<p> <strong>第七步</strong>：这一步按回车继续，然后需要几分钟的安装过程，请耐心等待出现下面的画面：</p>
<p><strong>第八步</strong>：当我们看到Congratulations, Shadowsocks-Python server install completed!时，则证明我们已经成功安装了ss。请立即将这些信息复制下来加以保存，我们就会用到这几个比较重要的信息：主机服务器IP地址、端口号、密码和加密方式。上面的命令全部回车执行后，如果没有报错，即为执行成功，出现确认提示的时候，输入 y 后，回车即可。</p>
]]></content>
      <tags>
        <tag>ss</tag>
      </tags>
  </entry>
  <entry>
    <title>求垂点与平行线的算法</title>
    <url>/2019-06-12-qiu-chui-dian-yu-ping-xing-xian-de-suan-fa.html</url>
    <content><![CDATA[<p>已知两点构成的线段</p>
<p>求第三点到已知线段的垂点</p>
<p>求过第四点与已知线段平行的直线</p>
<a id="more"></a>

<hr>
<h4><span id="1以下给出算法">1.以下给出算法</span></h4><h5><span id="11求垂点坐标">1.1求垂点坐标</span></h5><p>问题：已知两点: (x0,y0) (x1,y1)构成线段；</p>
<p>求第三点(x2,y2)到这条线段的垂线段。</p>
<p>求解：</p>
<p>线段L函数：(y1-y0)/(x1-x0)=(y-y0)(x-x0)</p>
<p>垂线段函数：y-y2=(x0-x1)(x-x2)/(y1-y2) +y2</p>
<p>联立解得：</p>
<p>x = [ x2(x0-x1)^2 + x0(y1-y2)^2 + (y0-y2)(y1-y0)(x0-x1) ] / [ (x0-x1)^2 + (y1-y0)^2]</p>
<p>将x代入函数求y</p>
<h5><span id="12求平行线">1.2求平行线</span></h5><p>已知第四点(x3,y3)，求过这点与线段平行的直线</p>
<p>线段斜率：</p>
<p>k = (y1-y0)/(x1-x0)</p>
<p>平行线的函数表达式：</p>
<p>y = k*(x - x3)+y3</p>
<p>x=999时，y=k*(999 - x3)+y3</p>
<p>x=-999时，y=k*(-999 - x3)+y3</p>
<p>得到较远处平行线上两点，连接可看成直线</p>
<h5><span id="13缺陷">1.3缺陷：</span></h5><p>未考虑线段斜率为0的情况，简单，懒得写了</p>
]]></content>
      <tags>
        <tag>算法笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>C_ALG坐标变换公式</title>
    <url>/2019-06-12-c-alg-zuo-biao-bian-huan-gong-shi.html</url>
    <content><![CDATA[<p>C语言实现GIS算法中的坐标变换</p>
<p>平移变换、比例变换、旋转变换</p>
<a id="more"></a>

<h3><span id="c_alg坐标变换公式">C_ALG坐标变换公式</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; X, Y    </span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 平移</span><br><span class="line">X +&#x3D; Xm;</span><br><span class="line">Y +&#x3D; Ym;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 比例</span><br><span class="line">&#x2F;&#x2F; 以坐标原点为参照点</span><br><span class="line">X *&#x3D; Xs;</span><br><span class="line">Y *&#x3D; Ys;</span><br><span class="line">&#x2F;&#x2F; 以x0y0为参照点的比例变换</span><br><span class="line">X &#x3D; (X-x0)*Xs + x0;</span><br><span class="line">Y &#x3D; (Y-y0)*Ys + y0;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 旋转</span><br><span class="line">X &#x3D; X*cosA + Y*sinA</span><br><span class="line">Y &#x3D; X*sinA - Y*cosA</span><br><span class="line"></span><br><span class="line">******如果是屏幕坐标，顺时针旋转，</span><br><span class="line">&#x2F;&#x2F; 以坐标原点</span><br><span class="line">X &#x3D; X*cosA - Y*sinA;</span><br><span class="line">Y &#x3D; X*sinA + Y*cosA;</span><br><span class="line">&#x2F;&#x2F; 以指定点旋转</span><br><span class="line">X &#x3D; (X-x0)*cos(A) - (Y-y0)*sin(A);</span><br><span class="line">Y &#x3D; (X-x0)*sin(A) + (Y-y0)*cos(A);</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>算法笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>vc6.0;MFC；画笔与填充</title>
    <url>/2018-10-22-vc6.0-mfc-hua-bi-yu-ju-xing-tian-chong.html</url>
    <content><![CDATA[<p>C语言MFC中画笔与矩形填充</p>
<a id="more"></a>

<hr>
<h3><span id="画笔与填充">画笔与填充</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CDC *pDC &#x3D; GetDC();</span><br><span class="line">&#x2F;&#x2F;绘制红线</span><br><span class="line">CPen pen;</span><br><span class="line">pen.CreatePen(PS_SOLID,2,RGB(255,0,0));</span><br><span class="line">pDC-&gt;SelectObject(&amp;pen);</span><br><span class="line">&#x2F;&#x2F;矩形透明</span><br><span class="line">CBrush *pBrush &#x3D; CBrush::FromHandle((HBRUSH)GetStockObject(NULL_BRUSH));</span><br><span class="line">CBrush *pOldBrush &#x3D; pDC-&gt;SelectObject(pBrush);</span><br><span class="line">pDC-&gt;Rectangle(xmin,ymin,xmax,ymax);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 矩形填充</span><br><span class="line">CRect rt(x1+i*b1,y1+j*b2,x2+i*b1,y2+j*b2);</span><br><span class="line">pdc-&gt;FillSolidRect(&amp;rt,RGB(255,0,0));</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>C语言</tag>
      </tags>
  </entry>
  <entry>
    <title>C语言的写入文件数据与读取文件数据</title>
    <url>/2018-10-22-c-yu-yan-de-xie-ru-wen-jian-shu-ju-yu-du-qu-wen-jian-shu-ju.html</url>
    <content><![CDATA[<p>C语言的写入文件数据与读取文件数据</p>
<p>vc6.0</p>
<p>MFC</p>
<a id="more"></a>

<hr>
<h3><span id="c语言的写入文件">C语言的写入文件</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FILE *fp;</span><br><span class="line">fp &#x3D; fopen(&quot;F:\\Clanuage\\GISALG\\dataFile\\fffffff.txt&quot;,&quot;w&quot;);</span><br><span class="line">&#x2F;&#x2F; 第一行输出点的个数</span><br><span class="line">fprintf(fp,&quot;%d\n&quot;,num);</span><br><span class="line">&#x2F;&#x2F; 输出点的坐标</span><br><span class="line">for(int i&#x3D;0;i&lt;num;i++)</span><br><span class="line">&#123;</span><br><span class="line">	fprintf(fp,&quot;%d,%d\n&quot;,p[i].x,p[i].y);</span><br><span class="line">&#125;</span><br><span class="line">fclose(fp);</span><br></pre></td></tr></table></figure>
<h3><span id="读取文件数据">读取文件数据</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FILE *fp;</span><br><span class="line">fp &#x3D; fopen(&quot;F:\\Clanuage\\GISALG\\dataFile\\fffffff.txt&quot;,&quot;r&quot;);</span><br><span class="line">fscanf(fp,&quot;%d&quot;,&amp;num);</span><br><span class="line">for(int i&#x3D;0;i&lt;num;i++)</span><br><span class="line">&#123;</span><br><span class="line">	fscanf(fp,&quot;%d,%d&quot;,&amp;p[i].x,&amp;p[i].y);</span><br><span class="line">&#125;</span><br><span class="line">fclose(fp);</span><br><span class="line">&#x2F;&#x2F; 绘制</span><br><span class="line">CDC *pdc &#x3D; GetDC();</span><br><span class="line">for(int j&#x3D;0;j&lt;num;j++)</span><br><span class="line">&#123;</span><br><span class="line">	pdc-&gt;Ellipse(p[j].x-5,p[j].y-5,p[j].x+5,p[j].y+5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>C语言</tag>
      </tags>
  </entry>
  <entry>
    <title>复习C语言二级笔记</title>
    <url>/2018-08-23-fu-xi-c-yu-yan-er-ji-bi-ji.html</url>
    <content><![CDATA[<p>学完一学期C语言，没啥感觉</p>
<p>好多题也不会做</p>
<p>二级临近，只有边刷题，边学习了</p>
<p>内容比较杂乱，刷题遇到便逐渐解决的问题</p>
<a id="more"></a>

<hr>
<h3><span id="1-a-getchar-只获取键盘上一个字符getchar函数的作用是从终端读入一个字符">1、   a = getchar() 只获取键盘上++一个++字符；getchar函数的作用是从==终端==读入一个字符</span></h3><hr>
<h3><span id="2-数据库常用的关系运算为三种">2、数据库常用的关系运算为三种：</span></h3><p>1、即选择。</p>
<p>2、投影。</p>
<p>3、连接。 </p>
<p>（1）选择，是从二维表中选出符合条件的记录，它是从行的角度对关系进行的运算。</p>
<p>（2）投影，是从二维表中选出所需要的列，它是从列的角度对关系进行的运算。</p>
<p>（3）连接，是同时涉及到两个二维表的运算，它是将两个关系在给定的属性上满足给定条件的记录连接起来而得到的一个新的关系</p>
<hr>
<h3><span id="3-c语言没有逻辑值用-1-0-代替">3、   C语言没有逻辑值，用 <strong>1 0</strong> 代替</span></h3><hr>
<h3><span id="4-当有序链表为顺序存储时才能采用二分查找二分查找最多需要比较log2-n次而顺序查找最多需要n次">4、当有序链表为顺序存储时才能采用二分查找，二分查找最多需要比较log2 n次，而顺序查找最多需要n次。</span></h3><hr>
<h3><span id="5-数据流程图dfd图是结构化方法的需求分析工具">5、数据流程图（DFD图）是结构化方法的<strong>需求分析工具</strong></span></h3><hr>
<h3><span id="6-字符数组的赋值">6、 字符数组的赋值：</span></h3><p>char str[] = {‘h’,’a’,’p’,’p’,’y’,’\0’}</p>
<p>char str[] = “happy”;        </p>
<p>char str[] = {“happy”};</p>
<p>char *str;                 str = “happy”;</p>
<p>==错误赋值==：char str[6];  str = “happy”;</p>
<p>char *str;  str={“happy”};</p>
<hr>
<h3><span id="7-关于自定义函数中的return">7、关于自定义函数中的return:</span></h3><p>一个自定义函数中可以没有返回值，定义为void，程序执行结束后自动返回到调用处；</p>
<p>自定义函数中可以设置多个return语句，但返回值只能是一个。</p>
<hr>
<h3><span id="8-指针与数组">8、指针与数组：</span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int a=10,*p;</span><br><span class="line">int a=10;</span><br><span class="line">p=&amp;a;  //int *p=&amp;a;</span><br><span class="line"><span class="built_in">printf</span>(“%p”,p);  //为a的地址</span><br><span class="line"><span class="built_in">printf</span>(“%d”,*p)  //为a的值，*p代表指向a地址的值</span><br><span class="line"><span class="built_in">printf</span>(“%d”，&amp;p);  //为指针型变量p自己的地址</span><br><span class="line">/////////////////////////////</span><br><span class="line">int a[5]=&#123;1,2,3,4,5&#125;;</span><br><span class="line">int *p=a;  //a的首地址给了指针p</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>,*(p+1));等价于<span class="built_in">printf</span>(<span class="string">"%d"</span>,*(a+1));  //输出为2</span><br></pre></td></tr></table></figure>
<hr>
<h3><span id="9-指针数组和数组指针">9、指针数组和数组指针</span></h3><h4><span id="数组指针">数组指针：</span></h4><p>int (*p)[3];  //定义了一个指针型变量p，指向一个整型数组</p>
<h4><span id="指针数组">指针数组：</span></h4><p>int *p[3];     //定义了一个数组，里面存放指针型元素，指向整型</p>
<hr>
<h3><span id="10-静态变量static">10、静态变量static</span></h3><h4><span id="静态局部变量">静态局部变量：</span></h4><p>在函数中时，函数运行结束，这个静态变量的值不会被销毁，函数下次使用时仍能使用。</p>
<h4><span id="静态全局变量">静态全局变量：</span></h4><p>静态全局变量 作用于仅限于变量被定义的文件。在函数中引用不会改变他的值</p>
<hr>
<h3><span id="11-结构体">11、结构体</span></h3><p>结构体类型的变量在程序运行期间要作==为一个整体占用连续的内存单元==</p>
<h4><span id="结构体的定义">结构体的定义</span></h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">struct student   //struct student为结构体类型</span><br><span class="line">        &#123; </span><br><span class="line">         int num;</span><br><span class="line">         char  name[20];</span><br><span class="line">         char sex;</span><br><span class="line">         int age;</span><br><span class="line">         <span class="built_in">float</span> score;</span><br><span class="line">         char addr[30];</span><br><span class="line">        &#125;; </span><br><span class="line">struct student   stu1,stu2;   //声明结构体变量stu1,stu2</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">struct student</span><br><span class="line">    &#123; </span><br><span class="line">     int num;</span><br><span class="line">     char  name[20];</span><br><span class="line">     char sex;</span><br><span class="line">     int age;</span><br><span class="line">     <span class="built_in">float</span> score;</span><br><span class="line">     char addr[30];</span><br><span class="line">    &#125;stu1,stu2;</span><br></pre></td></tr></table></figure>

<h4><span id="初始化">初始化：</span></h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">struct student</span><br><span class="line">    &#123; char name[10];</span><br><span class="line">    int age;</span><br><span class="line">    <span class="built_in">float</span> score[5];</span><br><span class="line">    &#125;stu=&#123;“zhangsan”,20,78,92,83,75,69&#125;;</span><br><span class="line">    struct student li,zhang=&#123;<span class="string">"zhangsan"</span>,20,78,92,83,75,69&#125;; </span><br><span class="line">    li=zhang; //将zhang对象拷贝一份赋值给li</span><br><span class="line">      /*</span><br><span class="line">      但li=&#123; “li si”,19,76,56,90,69,80&#125;;是非法的</span><br><span class="line">      */</span><br></pre></td></tr></table></figure>
<h4><span id="typedef定义的数据类型">typedef定义的数据类型</span></h4><p>typedef struct student STUDENT  为==结构体类型==定义一个新的名字，即==strct student与STUDENT同义==</p>
<p>等价于下程序</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct student</span><br><span class="line">    &#123; char name[10];</span><br><span class="line">    int age;</span><br><span class="line">    float score[5];</span><br><span class="line">    &#125;STUDENT;</span><br></pre></td></tr></table></figure>

<h3><span id="111-共用体">11.1 共用体</span></h3><p>共用体的每个成员的==起始地址都相同==</p>
<p>变量所占的内存长度等于==最长的成员的长度==</p>
<p>C 语言规定 ,==不能==把共用体变量作为函数的参数</p>
<hr>
<h3><span id="12-文件操作">12、文件操作</span></h3><p>文件的打开操作 fopen 打开一个文件</p>
<p>文件的关闭操作 fclose 关闭一个文件</p>
<p>文件的读写操作 fgetc 从文件中读取一个字符</p>
<p>fputc 写一个字符到文件中去</p>
<p>fgets 从文件中读取一个字符串</p>
<p>fputs 写一个字符串到文件中去</p>
<p>fprintf 往文件中写格式化数据</p>
<p>fscanf(fp,”%d”,n) 格式化读取文件中数据</p>
<p>fread(stu,sizeof(STUDENT),n,fp) 以二进制形式读取文件中的数据</p>
<p>fwrite 以二进制形式写数据到文件中去</p>
<p>getw 以二进制形式读取一个整数</p>
<p>putw 以二进制形式存贮一个整数</p>
<p>文件状态检查函数 feof 文件结束</p>
<p>ferror 文件读/写出错</p>
<p>feof 读入到字符尾’\0’时返回0</p>
<p>以 “wt” 方式写入的是字符文件 ,转义字符 \n 被看作两个字符来处理</p>
<p>“wb”方式写入的是二进制文件 ,转义字符 ‘\n’是一个字符</p>
<hr>
<h3><span id="13-设某循环队列的容量为50如果头指针front-45指向队头元素的前一位置尾指针-rear-10指向队尾元素则该循环队列中共有15个元素">13、设某循环队列的容量为50，如果头指针front ＝45（指向队头元素的前一位置），尾指针 rear ＝10（指向队尾元素），则该循环队列中共有15个元素。</span></h3><h4><span id="计算公式队列头为front队列尾为rearm为容量">计算公式（队列头为front,队列尾为rear,M为容量）</span></h4><h4><span id="rear-front-mm">|rear - front + M|%M</span></h4><p>这里为 |10-45+50|%50=15</p>
<hr>
<h3><span id="14-二叉树的遍历">14、二叉树的遍历</span></h3><p>遍历就是不重复地访问二叉树的所有结点。</p>
<p>二叉树遍历的方法有3种：++前序遍历、中序遍历和后序遍历++。</p>
<p>记住3种遍历的顺序：</p>
<p>①前序，访问根→按前序遍历左子树→按前序遍历右子树。 </p>
<p>②中序，按中序遍历左子树→访问根→按中序遍历右子树。 </p>
<p>③后序，按后序遍历左子树→按后序遍历右子树→访问根。</p>
<h4><span id="例子后序遍历">例子：后序遍历</span></h4><p>  E</p>
<p> /  \</p>
<p>S    C</p>
<p>|    / \</p>
<p>A   B  P</p>
<p>结果：ASBPCE</p>
<h4><span id="14-1-在任意一棵二叉树中-度为-0-的结点-即叶子结点-总是比度为-2-的结点多一个">14、1  在任意一棵二叉树中 ,度为 0 的结点 (即叶子结点 )总是比度为 2 的结点==多一个==。</span></h4><h4><span id="142-在树形结构中-每一个结点只有一个前件-称为父结点没有前件的结点只有一个-称为树的根结点-每一个结点可以有多个后件-它们都称为该结点的子结点-没有后件的结点称为叶子结点">14.2 在树形结构中 ,每一个结点只有一个==前件== ,称为==父结点==;没有前件的结点只有一个 ,称为==树的根结点== ;每一个结点可以有多个==后件== ,它们都称为该结点的==子结点== ;没有后件的结点称为==叶子结点==。</span></h4><hr>
<h3><span id="15-软件是程序数据和文档的集合">15、软件是==程序数据==和==文档==的集合</span></h3><hr>
<h3><span id="16-else-与其最近的没有配对的if配对">16、else 与其最近的没有配对的if配对</span></h3><h4><span id="下题注意else-if与else的配对">下题注意else if与else的配对</span></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        int a&#x3D;1,b&#x3D;2,c&#x3D;3,d&#x3D;0;</span><br><span class="line">        if （ a&#x3D;&#x3D;1 ）</span><br><span class="line">        &#123;</span><br><span class="line">                if （ b!&#x3D;2 ）</span><br><span class="line">                &#123;</span><br><span class="line">                        if （ c&#x3D;&#x3D;3 ）</span><br><span class="line">                        &#123;</span><br><span class="line">                                d&#x3D;1;</span><br><span class="line">                        &#125;</span><br><span class="line">                        else</span><br><span class="line">                        &#123;</span><br><span class="line">                                d&#x3D;2;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                else if （ c!&#x3D;3 ） </span><br><span class="line">                &#123;       </span><br><span class="line">                        d&#x3D;3;    </span><br><span class="line">                &#125;       </span><br><span class="line">                else    </span><br><span class="line">                &#123;       </span><br><span class="line">                        d&#x3D;4;    </span><br><span class="line">                &#125;       </span><br><span class="line">        &#125;       </span><br><span class="line">        else    </span><br><span class="line">        &#123;       </span><br><span class="line">                d&#x3D;5;    </span><br><span class="line">        &#125;</span><br><span class="line">        printf （ &quot; %d\n &quot; ,d ） ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3><span id="17-c语言中的字符数组的结尾">17、c语言中的字符数组的结尾</span></h3><p>因为c语言中没有字符串类型，所以借助字符数组来存储字符串，为了区别字符串，需要在字符数组的末尾添加ASCII为0，即’\0’，来作为字符串的结束标志，并且不计入字符串长度。</p>
<h4><span id="即strlen输出结果为实际数组长度">即strlen()输出结果为实际数组长度</span></h4><hr>
<h2><span id="算法及理论题汇总">算法及理论题汇总</span></h2><h3><span id="181-n-s图">18.1 、N-S图</span></h3><p>为了避免流程图在描述程序逻辑时的灵活性,提出了用方框图来代替传统的程序流程图 ,通常也把这种图称为==N-S图==</p>
<p>N-S 图是由 Nassi 和 Shneiderman 提出的一种符合程序化结构<br>设计原则的图形描述工具。 它的提出是为了避免流程图在描述程序逻辑时的随意性上灵活性。</p>
<h3><span id="182-结构化程序设计方法的主要原则可以概括为自顶向下-逐步求精-模块化及限制使用goto语句总的来说可使程序结构良好-易读-易理解-易维护">18.2、结构化程序设计方法的主要原则可以概括为==自顶向下==、==逐步求精==、==模块化==及限制使用goto语句,总的来说可使==程序结构良好、 易读、易理解、易维护==。</span></h3><h3><span id="1821-软件设计遵循软件工程的基本目标和原则建立了适用于在软件设计中应该遵循的基本原理和与软件设计有关的概念它们具有抽象-模块化-信息隐蔽和数据独立性-自底向上是集成测试中增量测试的一种">18.2.1 软件设计遵循软件工程的基本目标和原则,建立了适用于在软件设计中应该遵循的基本原理和与软件设计有关的概念,它们具有==抽象、 模块化、信息隐蔽和数据独立性==。自底向上是集成测试中增量测试的一种</span></h3><h3><span id="183-为了使模块尽可能独立要求模块的内聚程度要尽量高且各模块间的耦合程度要尽量弱">18.3、为了使模块尽可能独立,要求模块的==内聚程度要尽量高==,且各模块间的==耦合程度要尽量弱==</span></h3><h3><span id="1831模块之间的耦合程度反映了模块的独立性也反映了系统分解后的复杂程度-按照耦合程度从强到弱分别是内容耦合-公共耦合-外部耦合-控制耦合-标记耦合-数据耦合和非直接耦合没有异构耦合这种方式">18.3.1模块之间的耦合程度反映了模块的独立性,也反映了系统分解后的复杂程度。按照耦合程度从强到弱分别是:==内容耦合、公共耦合、外部耦合、控制耦合、标记耦合、数据耦合和非直接耦合==,没有异构耦合这种方式。</span></h3><p>。</p>
<p>模块的独立程度可以由两个定性标准度量:耦合性和内聚性。耦合性是衡量不同模块彼此间互相依赖(连接)的紧密程度;内聚性是衡量一个模块内部各个元素彼此结合的紧密程度。一般来说,要求模块之间的耦合尽可能地低 ,而内聚性尽可能地高。</p>
<h3><span id="184-需求分析">18.4、需求分析</span></h3><p>需求分析是软件定义时期的最后一个阶段；任务是确定==软件系统功能==</p>
<h4><span id="软件开发方法是在总体设计阶段需完成的任务">软件开发方法是在总体设计阶段需完成的任务</span></h4><h4><span id="软件开发工具是在实现阶段需完成的任务">软件开发工具是在实现阶段需完成的任务</span></h4><h4><span id="软件开发费用是在可行性研究阶段需完成的任务">软件开发费用是在可行性研究阶段需完成的任务</span></h4><h3><span id="1841软件需求规格说明书-srssoftware-requirement-specification是需求分析阶段的最后成果-是软件开发中的重要文档之一">18.4.1软件需求规格说明书 (SRS,Software Requirement Specification)是需求分析阶段的最后成果 ,是软件开发中的重要文档之一。</span></h3><p>它具有以下几个方面的作用:==①便于用户、开发人员进行理解和交流 ;② 反映出用户问题的结构 ,可以作为软件开发工作的基础和依据 ;③ 作为确认测试和验收的依据==。</p>
<h3><span id="185-算法的特征">18.5、算法的特征</span></h3><p>算法具有 5 个特性:①==有穷性==:一个算法必须(对任何合法的输入值 )在执行有穷步之后结束,且每一步都可在==有限时间内完成==,即运行时间是有限的 ;②==确定性==:算法中每一条指令必须有确切的含义 ,读者理解时不会产生歧义;③==可行性==:一个算法是可行的,即算法中描述的操作都是可以通过已经实现的基本运算执行有限次来实现;④ ==输入:一个算法有零个或多个输入==,这些输入取自于某个特定的对象的集合 ;⑤ ==输出 :一个算法有一个或多个输出==。</p>
<h3><span id="186-如果进栈序列为-e1e2e3e4则可能的出栈序列是">18.6、如果进栈序列为 e1,e2,e3,e4,则可能的出栈序列是</span></h3><p>进栈与出栈的规则是：==后进先出==</p>
<p>可能的情况：e1进e2进e3进e4进，则出的顺序e4/e3/e2/e1</p>
<p>e1进，e2进再出，e3进再出，e4进；出的顺序:e2/e3/e4/e1</p>
<p>e1进，e2进，e3进再出，e4进；出的顺序e3/e4/e2/e1</p>
<p>等等</p>
<h3><span id="187-结构体对链表的定义">18.7、结构体对链表的定义</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct link</span><br><span class="line">&#123;</span><br><span class="line">    int data;              &#x2F;&#x2F;数据域</span><br><span class="line">    struct link *next;           &#x2F;&#x2F;指针域</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h3><span id="19-在最坏情况下快速排序-冒泡排序和直接插入排序需要的比较次数都为-nn-12堆排序需要的比较次数为-nlog2n">19、在最坏情况下,快速排序、冒泡排序和直接插入排序需要的比较次数都为 n(n-1)/2,堆排序需要的比较次数为 nlog2n。</span></h3><hr>
<h3><span id="20-数据的物理独立性是指数据的物理结构的改变不会影响数据库的逻辑结构">20、数据的物理独立性是指数据的物理结构的改变,不会影响数据库的逻辑结构</span></h3><hr>
<h3><span id="21-关系中的行称为元组对应存储文件中的记录关系中的列称为属性对应存储文件中的字段">21、关系中的==行称为元组==,对应存储文件中的记录,关系中的==列称为属性==,对应存储文件中的字段</span></h3><hr>
<h3><span id="22-c-语言中-在定义并初始化二维数组时-可以省略数组第一维的长度-但是不能省略第二维的长度">22、C 语言中 ,在定义并初始化二维数组时 ,可以省略数组第一维的长度 ,但是==不能省略第二维的长度==。</span></h3><hr>
<h3><span id="23-预处理">23、预处理</span></h3><p>在程序中凡是以 “#”开始的语句行都是预处理命令行</p>
<p>C 语言中的预处理命令以符号#开头,这些命令是在==程序编译之前进行处理的==</p>
<hr>
<h3><span id="24-位运算">24、位运算</span></h3><h4><span id="~-按位取反">~ 按位取反</span></h4><h4><span id="ltlt左移-gtgt右移">&lt;&lt;左移    &gt;&gt;右移</span></h4><p>a &lt;&lt; n</p>
<p>二进制数a向左移动n位，左边n位舍去，右边n位用0补齐</p>
<h4><span id="按位异或">^按位异或</span></h4><p>规则：相同为0,不同为1</p>
<p>&nbsp; 011100</p>
<p>^100111</p>
<p>&nbsp;111011</p>
<hr>
<h3><span id="25-测试的目的是暴露错误-评价程序的可靠性调试的目的是发现错误的位置并改正错误">25、==测试==的目的是暴露错误 ,评价程序的可靠性；==调试==的目的是发现错误的位置并改正错误</span></h3><hr>
<h3><span id="26-当循环队列非空且队尾指针等于队头指针时-说明循环队列已满-不能进行入队运算-这种情况称为上溢">26、当循环队列非空且队尾指针等于队头指针时 ,说明循环队列已满 ,不能进行入队运算。这种情况称为==上溢==</span></h3><h3><span id="27-在关系模型中-把数据看成一个二维表-每一个二维表称为一个关系">27、在关系模型中 ,把数据看成一个二维表 ,每一个二维表称为一个==关系==</span></h3><p>在关系模型中 ,把数据看成一个二维表 ,每一个二维表称为一个==关系==。表中的每一列称为一个==属性== ,相当于记录中的一个数据项 ,对属性的命名称为属性名 ;表中的一行称为一个==元组== ,相当于记录值。</p>
<hr>
<h3><span id="27-在计算机软件系统的体系结构中-数据库管理系统位于用户和操作系统之间">27、在计算机软件系统的体系结构中 ,数据库管理系统位于用户和==操作系统==之间</span></h3><h3><span id="28-fseek函数的调用-fseek文件指针-位移量-起始点">28、fseek函数的调用  ==fseek(文件指针 ,位移量 ,起始点)==</span></h3><p>“起始点 “用 0,1 或 2 代替 ,其中 ,0 代表 “文件开始 “;1 为”当前位置 “;2 为”文件末尾 “ 。 “位移量 “指以 “起始点 “为基点 ,向前移动的字节数。 ANSI C 和大多数 C 版本要求位移量是 long 型数据 ,这样当文件的长度大于 64k 时不致出现问题。 ANSI C标准规定在数字的末尾加一个字母 L,就表示 long 型。</p>
<h3><span id="29-流程图">29、流程图</span></h3><p>程序流程图是人们对解决问题的方法、思路或算法的一种图形方式的描述。其中 ,==图框==表示各种==操作的类型==,图框中的==文字==和符号表示操作的==内容== ;==流程线==表示操作的==先后次序==。带箭头的线段在数据流程图中表示==数据流==;带箭头的线段在程序流程图中表示==控制流==。在图元之间用带有箭头的线段表示==图元关系==。在模块之间用带有箭头的线段表示==调用关系==。</p>
<hr>
<h3><span id="30-已知数据表中每个元素距其最终位置不远为节省时间应采用的算法是直接插入排序">30、已知数据表中==每个元素距其最终位置不远==，为节省时间，应采用的算法是==直接插入排序==</span></h3><p>堆排序的比较次数为nlog2n;直接插入排序的比较次数为n(n-1)/2;快速排序的比较次数为 nlog2n</p>
<hr>
<h3><span id="31-c-语言的语法规定-字母-ee之前必须有数字-且-ee后面的指数必须是整数">31、C 语言的语法规定 ,字母 e(E)==之前必须有数字== ,且 e(E)==后面的指数必须是整数==</span></h3><p>3E04</p>
<p>0.2E5</p>
<hr>
<h3><span id="32-数据结构分为逻辑结构与存储结构-线性链表属于存储结构">32、数据结构分为逻辑结构与存储结构 ,线性链表属于==存储结构==</span></h3><p>数据的逻辑结构是指反映数据元素之间逻辑关系的数据结构 ;数据的存储结构是指数据的逻辑结构在计算机存储空间中的存放<br>形式。在数据的存储结构中 ,不仅要存放各数据元素的信息 ,还需要存放各数据元素之间前后件关系的信息。</p>
<hr>
<h3><span id="33-数据库设计分为以下-6-个设计阶段-需求分析阶段-概念设计阶段-逻辑设计阶段-物理设计阶段-实施阶段及数据库运行和维护阶段">33、数据库设计分为以下 6 个设计阶段 :需求分析阶段、概念设计阶段、逻辑设计阶段、物理设计阶段、实施阶段及数据库运行和维护阶段。</span></h3><hr>
<h3><span id="34-getsputsfgets标准输入输出">34、gets();puts();fgets();标准输入输出</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int name[10];</span><br><span class="line">gets(name);</span><br><span class="line">fgets(name,sizeof(name),stdin);</span><br></pre></td></tr></table></figure>
<hr>
<h3><span id="35-字符操作函数">35、字符操作函数</span></h3><p>strlen(str)返回实际数组的长度</p>
<p>strcpy(str1,str2)将str2复制到str1，注意数组长度</p>
<p>strcmp(str1,str2)比较str1与str2，从左到右以ASCII码值比较，str1&gt;str2，返回值大于1，str1=str2返回0，str1&lt;str2，返回值小于0</p>
<hr>
]]></content>
      <tags>
        <tag>C语言</tag>
      </tags>
  </entry>
  <entry>
    <title>从0开始的python飞机外星人大战 (2)</title>
    <url>/2018-08-21-pygame-2.html</url>
    <content><![CDATA[<h2><span id="重构模块game_function-由于每次重构都需要改alien_invasinpy在写笔记时很麻烦所以我这儿先重构一些最后给出alien_invasionpy的代码">重构：模块game_Function  由于每次重构都需要改alien_invasin.py，在写笔记时很麻烦，所以我这儿先重构一些，最后给出alien_invasion.py的代码</span></h2><h3><span id="新建文件game_functionspy">新建文件：game_Functions.py</span></h3><h3><span id="函数check_event">函数check_event()</span></h3><h3><span id="函数update_screen">函数update_screen()</span></h3><a id="more"></a>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line"></span><br><span class="line">def check_events():</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">            sys.exit</span><br><span class="line"></span><br><span class="line">def update_screen(ai_settings,screen,ship):</span><br><span class="line">    <span class="string">""</span><span class="string">"更新屏幕"</span><span class="string">""</span></span><br><span class="line">    <span class="comment"># 每次循环都重绘屏幕</span></span><br><span class="line">    screen.fill(ai_settings.bg_color)</span><br><span class="line">    ship.blitme()</span><br><span class="line">    </span><br><span class="line">    pygame.display.flip()</span><br></pre></td></tr></table></figure>
<h3><span id="响应按键飞船的左右连续移动">响应按键，飞船的左右连续移动</span></h3><p>我们让moving_right和moving_left来存储是否左右移动，True和False;  KEYDOWN代表键被按住，KEYUP代表松开键； 在ship类中初始化moving_right和moving_left的值为False,并设置在为True时的移动； 在check_event()中则设置了判断True和Fale的依据</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line"></span><br><span class="line">def check_events(ship):</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">            sys.exit</span><br><span class="line">        <span class="comment">##################</span></span><br><span class="line">        <span class="keyword">elif</span> event.type == pygame.KEYDOWN:</span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_RIGHT:</span><br><span class="line">                ship.moving_right = True</span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_LEFT:</span><br><span class="line">                ship.moving_left = True</span><br><span class="line">        <span class="keyword">elif</span> event.type == pygame.KEYUP</span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_RIGHT:</span><br><span class="line">                ship.moving_right = False</span><br><span class="line">            <span class="keyword">if</span> event.key == pygame.K_LEFT:</span><br><span class="line">                ship.moving_left = False</span><br><span class="line">        <span class="comment">#########################        </span></span><br><span class="line">            </span><br><span class="line">def update_screen(ai_settings,screen,ship):</span><br><span class="line">    <span class="string">""</span><span class="string">"更新屏幕"</span><span class="string">""</span></span><br><span class="line">    <span class="comment"># 每次循环都重绘屏幕</span></span><br><span class="line">    screen.fill(ai_settings.bg_color)</span><br><span class="line">    ship.blitme()</span><br><span class="line">    </span><br><span class="line">    pygame.display.flip()</span><br></pre></td></tr></table></figure>
<h3><span id="ship类中的更改">ship类中的更改</span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import pygame</span><br><span class="line">class Ship():</span><br><span class="line">    def __init__(self,screen):</span><br><span class="line">        <span class="string">""</span><span class="string">"初始化飞船，设置它的位置"</span><span class="string">""</span></span><br><span class="line">        <span class="comment"># 设置screen属性</span></span><br><span class="line">        self.screen = screen</span><br><span class="line">        <span class="comment"># 加载飞船图片</span></span><br><span class="line">        self.image = pygame.image.load(<span class="string">'images/ship.bmp'</span>)</span><br><span class="line">        <span class="comment"># 获取图片外接矩形和屏幕矩形</span></span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.screen_rect = self.screen.get_rect()</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 将飞船的位置放在屏幕底部中央</span></span><br><span class="line">        self.rect.centerx = self.screen_rect.centerx</span><br><span class="line">        self.rect.bottom = self.screen_rect.bottom</span><br><span class="line">     <span class="comment">########   </span></span><br><span class="line">        self.moving_right = False</span><br><span class="line">        self.moving_left = False</span><br><span class="line">    def update(self):</span><br><span class="line">        <span class="keyword">if</span> self.moving_right:</span><br><span class="line">            self.rect.centerx += 1</span><br><span class="line">        <span class="keyword">if</span> self.moving_left:</span><br><span class="line">            self.rect.centerx -= 1</span><br><span class="line">    <span class="comment">################</span></span><br><span class="line">    <span class="comment"># 按指定的位置绘制飞船</span></span><br><span class="line">    def blitme(self):</span><br><span class="line">        self.screen.blit(self.image,self.rect)</span><br></pre></td></tr></table></figure>
<h3><span id="alien_invasionpy的更改">alien_invasion.py的更改</span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line"><span class="comment"># 导入类</span></span><br><span class="line">from settings import Settings</span><br><span class="line">from ship import Ship</span><br><span class="line"><span class="comment">##</span></span><br><span class="line">import game_Functions as gf</span><br><span class="line"><span class="comment">##</span></span><br><span class="line">def run_game():</span><br><span class="line">    pygame.init()</span><br><span class="line">    <span class="comment"># 将Settings类中属性存储在ai_settings中</span></span><br><span class="line">    ai_settings = Settings()</span><br><span class="line">    <span class="comment"># 调用类中属性</span></span><br><span class="line">    screen = pygame.display.set_mode((ai_settings.screen_width,ai_settings.screen_height))</span><br><span class="line">    pygame.display.caption(<span class="string">"Alien Invasion"</span>)</span><br><span class="line">    <span class="comment"># 创建飞船</span></span><br><span class="line">    ship = Ship(screen)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="comment">#########</span></span><br><span class="line">        gf.check_event(ship)</span><br><span class="line">        ship.update()</span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        gf.update_screen(ai_settings,screen,ship)</span><br><span class="line">        </span><br><span class="line">       </span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>pygame</tag>
      </tags>
  </entry>
  <entry>
    <title>从0开始的python飞机外星人大战 (1)</title>
    <url>/2018-08-20-pygame-1.html</url>
    <content><![CDATA[<p>由于学了几天python的基础知识，意识到python作为一门语言，它的语法的简单，严格的格式；……这里是作为一个菜鸡，开始写的（抄的）一个经典的实战：飞机大战</p>
<p>下面我们开始。</p>
<h2><span id="环境说明">环境说明</span></h2><p>本文使用的是python3 + pycharm</p>
<h2><span id="创建项目文件">创建项目文件</span></h2><p>创建文件：alien_invasion,后面创建的py文件都放在这个文件下</p>
<h2><span id="安装pygame包">安装pygame包</span></h2><p>在pycharm中，file–&gt;Default settings–&gt;Project Interpreter(项目解释器)–&gt;右边的+号–&gt;搜索pygame–&gt;install</p>
<a id="more"></a>

<h2><span id="新建alien_invasionpy文件创建pygame窗口以及响应用户输入">新建alien_invasion.py文件；创建pygame窗口以及响应用户输入</span></h2> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line">def run_game():</span><br><span class="line">    <span class="comment"># 初始化</span></span><br><span class="line">    pygame.init()</span><br><span class="line">    <span class="comment"># 绘制屏幕</span></span><br><span class="line">    screen = pygame.display.set_mode((1200,800))</span><br><span class="line">    <span class="comment"># 设置屏幕标题</span></span><br><span class="line">    pygame.display.set_caption(<span class="string">"Alien Invasion"</span>)</span><br><span class="line">    <span class="comment"># 游戏主函数</span></span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="comment"># 获取键盘鼠标输入，设置退出</span></span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">                sys.exit()</span><br><span class="line">        <span class="comment"># 让绘制屏幕可见</span></span><br><span class="line">        pygame.display.flip()</span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>
<h2><span id="加入背景颜色">加入背景颜色</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">pygame.display.set_caption(<span class="string">"Alien Invasion"</span>)</span><br><span class="line"><span class="comment"># 设置背景色，RGB</span></span><br><span class="line">bg_color = (230,230,230)</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 每次循环都重绘屏幕</span></span><br><span class="line">    screen.fill(bg_color)</span><br><span class="line">    pygame.display.flip()</span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>
<h2><span id="创建一个设置的类">创建一个设置的类</span></h2><p>新建一个settings.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">class Settings():</span><br><span class="line">    <span class="string">""</span><span class="string">"存储外星人入侵所有设置的类"</span><span class="string">""</span></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.screen_width = 1200</span><br><span class="line">        self.screen_heught = 800</span><br><span class="line">        self.bg_corlor = (230,230,230)</span><br></pre></td></tr></table></figure>
<h2><span id="更改alien_invasionpy参数完整代码如下">更改alien_invasion.py参数，完整代码如下</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line"><span class="comment"># 导入类</span></span><br><span class="line">from settings import Settings</span><br><span class="line">def run_game():</span><br><span class="line">    pygame.init()</span><br><span class="line">    <span class="comment"># 将Settings类中属性存储在ai_settings中</span></span><br><span class="line">    ai_settings = Settings()</span><br><span class="line">    <span class="comment"># 调用类中属性</span></span><br><span class="line">    screen = pygame.display.set_mode((ai_settings.screen_width,ai_settings.screen_height))</span><br><span class="line">    pygame.display.caption(<span class="string">"Alien Invasion"</span>)</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">                sys.exit()</span><br><span class="line">        screen.fill(ai_settings.bg_color)</span><br><span class="line">        pygame.display.flip()</span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>
<h2><span id="下载飞船图片建立shippy构建ship类">下载飞船图片，建立ship.py，构建Ship类</span></h2><p>在alien_invasion下新建文件夹images，将图片放在其下（图片为位图格式，因为python能识别位图，其他格式需要安装包）</p>
<p>ship.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import pygame</span><br><span class="line">class Ship():</span><br><span class="line">    def __init__(self,screen):</span><br><span class="line">        <span class="string">""</span><span class="string">"初始化飞船，设置它的位置"</span><span class="string">""</span></span><br><span class="line">        <span class="comment"># 设置screen属性</span></span><br><span class="line">        self.screen = screen</span><br><span class="line">        <span class="comment"># 加载飞船图片</span></span><br><span class="line">        self.image = pygame.image.load(<span class="string">'images/ship.bmp'</span>)</span><br><span class="line">        <span class="comment"># 获取图片外接矩形和屏幕矩形</span></span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.screen_rect = self.screen.get_rect()</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 将飞船的位置放在屏幕底部中央</span></span><br><span class="line">        self.rect.centerx = self.screen_rect.centerx</span><br><span class="line">        self.rect.bottom = self.screen_rect.bottom</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 按指定的位置绘制飞船</span></span><br><span class="line">    def blitme(self):</span><br><span class="line">        self.screen.blit(self.image,self.rect)</span><br></pre></td></tr></table></figure>
<h2><span id="在alien_invasionpy中引用ship类来创建飞船">在alien_invasion.py中引用Ship类来创建飞船</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import pygame</span><br><span class="line"><span class="comment"># 导入类</span></span><br><span class="line">from settings import Settings</span><br><span class="line">from ship import Ship</span><br><span class="line">def run_game():</span><br><span class="line">    pygame.init()</span><br><span class="line">    <span class="comment"># 将Settings类中属性存储在ai_settings中</span></span><br><span class="line">    ai_settings = Settings()</span><br><span class="line">    <span class="comment"># 调用类中属性</span></span><br><span class="line">    screen = pygame.display.set_mode((ai_settings.screen_width,ai_settings.screen_height))</span><br><span class="line">    pygame.display.caption(<span class="string">"Alien Invasion"</span>)</span><br><span class="line">    <span class="comment"># 创建飞船</span></span><br><span class="line">    ship = Ship(screen)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">                sys.exit()</span><br><span class="line">        screen.fill(ai_settings.bg_color)</span><br><span class="line">        </span><br><span class="line">        ship.blitme()</span><br><span class="line">        </span><br><span class="line">        pygame.display.flip()</span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>pygame</tag>
      </tags>
  </entry>
  <entry>
    <title>程序结构、分支语句、条件、列表、循环</title>
    <url>/2018-08-10-python-4.html</url>
    <content><![CDATA[<p>python自学第四节<br>程序结构、分支语句、条件、列表、循环</p>
<h2><span id="程序结构">程序结构</span></h2><ul>
<li>程序结构只需要由三种构成： 程序=顺序+分支+循环</li>
<li>顺序</li>
<li>分支：即选择条件</li>
<li>循环</li>
</ul>
<h3><span id="1-条件语句">1、条件语句</span></h3><ul>
<li>语法如下：<pre><code>if (条件表达式)：
    程序处理模块</code></pre></li>
<li>python用缩进来表示代码层级关系<ul>
<li>python2空格和tab可混用</li>
<li>python3不能混用</li>
</ul>
</li>
</ul>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="number">1</span>):</span><br><span class="line">    print(<span class="string">"True"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>True</code></pre><ul>
<li>在python中  pass语句，占位，不执行任何语句，不起任何作用</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="number">5</span> &gt; <span class="number">3</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h4><span id="练习判断学生成绩的等级">练习：判断学生成绩的等级</span></h4><ul>
<li>90及以上为A</li>
<li>80-90为B</li>
<li>70-80为C</li>
<li>60-70为D</li>
<li>其余为E</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">score = input(<span class="string">"键入学生成绩："</span>)</span><br><span class="line">score1 = int(score)   <span class="comment">#input键入的是字符，这里强转为整型</span></span><br><span class="line"><span class="keyword">if</span> (score1 &gt;= <span class="number">90</span> ):</span><br><span class="line">    print(<span class="string">"A"</span>)</span><br><span class="line"><span class="keyword">if</span> (score1 &gt;= <span class="number">80</span> <span class="keyword">and</span> score1 &lt; <span class="number">90</span>):</span><br><span class="line">    print(<span class="string">"B"</span>)</span><br><span class="line"><span class="keyword">if</span> (score1 &gt;= <span class="number">70</span> <span class="keyword">and</span> score1 &lt; <span class="number">80</span>):</span><br><span class="line">    print(<span class="string">"C"</span>)</span><br><span class="line"><span class="keyword">if</span> (score1 &gt;= <span class="number">60</span> <span class="keyword">and</span> score1 &lt; <span class="number">70</span>):</span><br><span class="line">    print(<span class="string">"D"</span>)</span><br><span class="line"><span class="keyword">if</span> (score1 &lt; <span class="number">60</span>):</span><br><span class="line">    print(<span class="string">"E"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>键入学生成绩：70
C</code></pre><h3><span id="ifelse">if…else</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 60分以上及格，60分以下重考，90分以上为优，70-90为良；60-70为中；20-60为差；20分以下：请到老师办公室</span></span><br><span class="line">score = input(<span class="string">"输入成绩："</span>)</span><br><span class="line">score = int(score)</span><br><span class="line"><span class="keyword">if</span> (score &gt;<span class="number">60</span>):</span><br><span class="line">    print(<span class="string">"及格"</span>)</span><br><span class="line">    <span class="keyword">if</span> (score &gt; <span class="number">90</span>):</span><br><span class="line">        print(<span class="string">"优"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> (score &gt; <span class="number">70</span>):</span><br><span class="line">            print(<span class="string">"良"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"中"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"重考"</span>)</span><br><span class="line">    <span class="keyword">if</span> (score &gt; <span class="number">20</span>):</span><br><span class="line">        print(<span class="string">"差"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"请到老师办公室"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>输入成绩：99
及格
优</code></pre><h3><span id="2-三元运算符">2、三元运算符</span></h3><ul>
<li>语法： x if 条件 else y</li>
<li>表示如果条件成立则输出x；否则输出y</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">"优秀"</span> <span class="keyword">if</span> <span class="number">2</span>&gt;<span class="number">1</span> <span class="keyword">else</span> <span class="string">"不行"</span></span><br></pre></td></tr></table></figure>




<pre><code>&apos;优秀&apos;</code></pre><h4><span id="运用三元运算符求最大值">运用三元运算符求最大值</span></h4><ul>
<li>a,b,c由用户输入</li>
<li>输出最大值</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = int(input(<span class="string">"输入a:"</span>))</span><br><span class="line">b = int(input(<span class="string">"输入b:"</span>))</span><br><span class="line">c = int(input(<span class="string">"输入c:"</span>))</span><br><span class="line">d = (a <span class="keyword">if</span> a&gt;b <span class="keyword">else</span> b) <span class="keyword">if</span> ((a <span class="keyword">if</span> a &gt;b <span class="keyword">else</span> b)&gt;c) <span class="keyword">else</span> c</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

<pre><code>输入a:23
输入b:45
输入c:11
45</code></pre><h3><span id="3-列表-list">3、列表 list</span></h3><ul>
<li>可以放数字、字符串、列表、和其他结构</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">"fuck shit"</span>,[<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>]]</span><br><span class="line">print(L1)</span><br></pre></td></tr></table></figure>

<pre><code>[1, 2, 3, &apos;fuck shit&apos;, [7, 9, 11]]</code></pre><h3><span id="4-range">4、range</span></h3><ul>
<li>可以看成一个函数</li>
<li>产生一个有规律的有数字组成的列表</li>
<li>语法： range(start,end,step)</li>
<li>start:开始数字，生成列表包含start,默认为0；end:结束值，结果列表不包含end;</li>
<li>step:步长，默认为1</li>
<li>python2中range()生成的是列表，同时有xrange()函数，功能类似</li>
<li>python3中，生成结果是迭代器，不是列表，可粗略地认为是列表</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L1 = range(<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line"><span class="comment">#   可看成L1 == [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>

<pre><code>range(1, 6)</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = range(<span class="number">2</span>,<span class="number">15</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment">#  可看成a == [2,6,10,14]</span></span><br></pre></td></tr></table></figure>

<h3><span id="5-for循环">5、for循环</span></h3><ul>
<li>一般明确循环次数</li>
<li>语法：    for i in xxx:</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L1 = [<span class="number">5</span>,<span class="number">9</span>,<span class="number">55</span>,<span class="number">99</span>,<span class="number">77</span>,<span class="string">"fuck"</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L1:</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>

<pre><code>5
9
55
99
77
fuck</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = range(<span class="number">1</span>,<span class="number">100</span>,<span class="number">19</span>)</span><br><span class="line"><span class="keyword">for</span> a1 <span class="keyword">in</span> a:</span><br><span class="line">    print(a1)</span><br></pre></td></tr></table></figure>

<pre><code>1
20
39
58
77
96</code></pre><h4><span id="运用循环求和">运用循环求和</span></h4><ul>
<li>求从1加到100</li>
<li>使用range</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L = range(<span class="number">1</span>,<span class="number">101</span>)</span><br><span class="line">mySum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> L:</span><br><span class="line">    mySum += idx</span><br><span class="line">print(mySum)</span><br></pre></td></tr></table></figure>

<pre><code>5050</code></pre><h3><span id="6-while循环">6、while循环</span></h3><ul>
<li>不明确循环次数，却满足一定条件</li>
<li>语法；      while (条件):<pre><code>循环体</code></pre></li>
</ul>
<h4><span id="示例银行存款">示例：银行存款</span></h4><ul>
<li>本金10000</li>
<li>年利率： %2.5</li>
<li>多少年总金额超过20000<ul>
<li>分析：没有明确循环次数</li>
<li>条件：总金额超过20000</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">year = <span class="number">0</span></span><br><span class="line">money = <span class="number">10000</span></span><br><span class="line">ratio = <span class="number">0.025</span></span><br><span class="line"><span class="keyword">while</span> (money &lt; <span class="number">20000</span>):</span><br><span class="line">    year += <span class="number">1</span></span><br><span class="line">    money = money + money*ratio</span><br><span class="line">print(<span class="string">"year is %d"</span> %year)</span><br></pre></td></tr></table></figure>

<pre><code>year is 29</code></pre><h4><span id="累加求和">累加求和</span></h4><ul>
<li>1-100</li>
<li>while循环</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sum = <span class="number">0</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= <span class="number">100</span>):</span><br><span class="line">    sum += i</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">print(sum)</span><br></pre></td></tr></table></figure>

<pre><code>5050</code></pre><h3><span id="7-break语句">7、 break语句</span></h3><ul>
<li>无条件终止循环，并跳出循环体</li>
</ul>
<h4><span id="示例">示例</span></h4><ul>
<li>在200-300中找到第一个可以被9整除的数</li>
<li>使用break</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>,<span class="number">301</span>):</span><br><span class="line">    num = i%<span class="number">9</span></span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(i)</span><br></pre></td></tr></table></figure>

<pre><code>207</code></pre><h4><span id="对于嵌套多重循环break跳出离他最近的循环">对于嵌套多重循环，break跳出离他最近的循环</span></h4><h4><span id="打印99乘法表">打印9*9乘法表</span></h4><ul>
<li>要求最大值为36</li>
<li>典型 for 嵌套循环</li>
<li>break</li>
<li>调用sys模块中write可以在打印时不会换行</li>
<li>sys.stdout.write();括号内只能用字符型</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span> (i*j&gt;<span class="number">36</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        sys.stdout.write(str(i*j))</span><br><span class="line">        sys.stdout.write(<span class="string">" "</span>)</span><br><span class="line">    print(<span class="string">" "</span>)</span><br></pre></td></tr></table></figure>

<pre><code>1 2 3 4 5 6 7 8 9  
2 4 6 8 10 12 14 16 18  
3 6 9 12 15 18 21 24 27  
4 8 12 16 20 24 28 32 36  
5 10 15 20 25 30 35  
6 12 18 24 30 36  
7 14 21 28 35  
8 16 24 32  
9 18 27 36  </code></pre><h3><span id="8-continue">8、continue</span></h3><ul>
<li>含义：继续下一轮循环</li>
<li>当我们已经确定不需要此轮循环时使用</li>
</ul>
<h4><span id="例累加求和">例：累加求和</span></h4><ul>
<li>当数为偶数时才求和</li>
<li>1-100</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    <span class="keyword">if</span> (i%<span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    sum += i</span><br><span class="line">print(sum)</span><br></pre></td></tr></table></figure>

<pre><code>2550</code></pre><h4><span id="例99乘法表">例：9*9乘法表</span></h4><ul>
<li>要求：打印值小于12的数</li>
<li>嵌套for循环</li>
<li>使用continue</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span> (i*j&gt;<span class="number">12</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        sys.stdout.write(str(i*j))</span><br><span class="line">        sys.stdout.write(<span class="string">" "</span>)</span><br><span class="line">    print(<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>1 2 3 4 5 6 7 8 9 

2 4 6 8 10 12 

3 6 9 12 

4 8 12 

5 10 

6 12 

7 

8 

9</code></pre>]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python中的运算符</title>
    <url>/2018-08-10-python-2.html</url>
    <content><![CDATA[<p>python自学第二节<br>运算符</p>
<h2><span id="python中的运算符">python中的运算符</span></h2><h3><span id="1-算数运算符">1、算数运算符</span></h3><ul>
<li>+</li>
<li>-</li>
<li>*</li>
<li>/</li>
<li>//地板除,得到整的结果：如：4   8   9.0  ….</li>
<li>% 取余</li>
<li>** 指数幂</li>
</ul>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">5.0</span></span><br><span class="line">a/<span class="number">4</span></span><br></pre></td></tr></table></figure>




<pre><code>1.25</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">5</span></span><br><span class="line">a/<span class="number">4</span></span><br></pre></td></tr></table></figure>




<pre><code>1.25</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">5</span></span><br><span class="line">a/<span class="number">3</span></span><br></pre></td></tr></table></figure>




<pre><code>1.6666666666666667</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 得到结果为整！</span></span><br><span class="line">a = <span class="number">22</span></span><br><span class="line">a // <span class="number">2</span></span><br></pre></td></tr></table></figure>




<pre><code>11</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">22.9</span></span><br><span class="line">a // <span class="number">2</span></span><br></pre></td></tr></table></figure>




<pre><code>11.0</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">17</span></span><br><span class="line">a // <span class="number">3</span></span><br></pre></td></tr></table></figure>




<pre><code>5</code></pre><ul>
<li>** 指数幂</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span> ** <span class="number">4</span></span><br></pre></td></tr></table></figure>




<pre><code>256</code></pre><h3><span id="算数运算符的优先级">算数运算符的优先级</span></h3><ul>
<li>（）</li>
<li>**</li>
<li>/ *   //  %</li>
<li>+,-</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">5</span> + <span class="number">4</span> ** <span class="number">2</span> - <span class="number">7</span> // <span class="number">4</span> - (<span class="number">5</span> % <span class="number">2</span>)</span><br></pre></td></tr></table></figure>




<pre><code>19</code></pre><h3><span id="运算中出现浮点数结果一定是浮点数">运算中出现浮点数，结果一定是浮点数</span></h3><h3><span id="运算小练习">运算小练习</span></h3><ul>
<li>摄氏度、华氏温度、开氏温度的转换</li>
<li>摄氏度=5.0/9.0*(华氏温度 - 32)</li>
<li>开氏温度=5.0/9.0*(华氏温度 - 32) + 273.15</li>
<li>今天32摄氏度，求华氏温度，开氏温度</li>
<li>华氏温度=摄氏度*9.0/5.0+32</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="number">32</span></span><br><span class="line">h = s*<span class="number">9.0</span>/<span class="number">5.0</span>+<span class="number">32</span></span><br><span class="line">k = <span class="number">5.0</span>/<span class="number">9.0</span>*(h - <span class="number">32</span>) + <span class="number">273.15</span></span><br><span class="line">print(<span class="string">"华氏温度h: %f"</span> % h)</span><br><span class="line">print(<span class="string">"开氏温度k: %f"</span> % k)</span><br></pre></td></tr></table></figure>

<pre><code>华氏温度h: 89.600000
开氏温度k: 305.150000</code></pre><h3><span id="2-赋值运算符">2、赋值运算符</span></h3><ul>
<li>=，+=，-=,*=,/=</li>
<li>** = ,//=</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">3</span></span><br><span class="line">a **= <span class="number">6</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line">b //= <span class="number">3</span></span><br><span class="line">print(a)</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>

<pre><code>729
1</code></pre><ul>
<li>批量赋值</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a,b,c = <span class="number">100</span>,<span class="number">234</span>,<span class="number">456</span></span><br><span class="line">print(<span class="string">"%d\n%d\n%d"</span> %(a,b,c))</span><br></pre></td></tr></table></figure>

<pre><code>100
234
456</code></pre><ul>
<li>数值交换</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a,b = <span class="number">123</span>,<span class="number">456</span></span><br><span class="line">a,b = b,a</span><br><span class="line">print(<span class="string">"%d\n%d"</span> %(a,b))</span><br></pre></td></tr></table></figure>

<pre><code>456
123</code></pre><h4><span id="数值运算练习">数值运算练习</span></h4><ul>
<li>(1)求r=6.6cm的球的体积和面积</li>
<li>面积s=4<em>pi</em>r^2</li>
<li>体积v=4/3<em>pi</em>r^3</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pi = <span class="number">3.1415926</span></span><br><span class="line">r = <span class="number">6.6</span></span><br><span class="line">s = <span class="number">4</span>*pi*r**<span class="number">2</span></span><br><span class="line">v = <span class="number">4</span>/<span class="number">3</span>*pi*r**<span class="number">3</span></span><br><span class="line">print(<span class="string">"面积为%f;体积为%f"</span> % (s,v))</span><br></pre></td></tr></table></figure>

<pre><code>面积为547.391095;体积为1204.260408</code></pre><ul>
<li>(2)求当前时间<ul>
<li>从7：00：00开始已经过去476589s，求现在的时间</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">startTime = <span class="number">7</span></span><br><span class="line">doneTimeS = <span class="number">476589</span></span><br><span class="line">minute = doneTimeS//<span class="number">60</span></span><br><span class="line">S = doneTimeS%<span class="number">60</span></span><br><span class="line">Time = minute//<span class="number">60</span></span><br><span class="line">M = minute%<span class="number">60</span></span><br><span class="line">nowTime = (startTime + Time)//<span class="number">24</span></span><br><span class="line">print(<span class="string">"现在的时间：%02d:%02d:%02d"</span> % (nowTime,M,S))</span><br></pre></td></tr></table></figure>

<pre><code>现在的时间：05:23:09</code></pre><h3><span id="3-比较运算符">3、比较运算符</span></h3><ul>
<li>&lt; &gt; &lt;= &gt;= == !=</li>
<li>比较的结果是bool值</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">5</span> &gt; <span class="number">1</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">6</span> != <span class="number">6</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><h3><span id="4-逻辑运算符">4、逻辑运算符</span></h3><ul>
<li><p>and逻辑与,短路与</p>
</li>
<li><p>or 逻辑或</p>
</li>
<li><p>not 逻辑非</p>
</li>
<li><p>and从左往右运算值时，都为真则返回最后一个值</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span> <span class="keyword">and</span> <span class="number">2</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure>




<pre><code>2</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">6</span> <span class="keyword">and</span> <span class="number">1</span> <span class="keyword">and</span> <span class="number">1111</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure>




<pre><code>1111</code></pre><ul>
<li>or只要第一个值为真，就直接返回第一个值</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">111</span> <span class="keyword">or</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>




<pre><code>111</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">2</span></span><br><span class="line">b = <span class="number">9</span></span><br><span class="line">a &gt; b <span class="keyword">and</span> a</span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><h3><span id="5-特殊运算符">5、特殊运算符</span></h3><ul>
<li><p>is 判断两个对象的内存地址是否相同</p>
</li>
<li><p>is not 与is相反</p>
</li>
<li><p>del 删除某个对象，解除对象的绑定值，可能释放掉它的内存（视情况）</p>
</li>
<li><p>在python中，对于一些初级的，常用的对象，无论把它赋值给几个变量，它会被存储在相同的内存中；而其他才会重新开辟内存存储</p>
</li>
<li><p>例子如下</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">1</span></span><br><span class="line">a <span class="keyword">is</span> b</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><ul>
<li>查看地址用  id()</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">1</span></span><br><span class="line">a <span class="keyword">is</span> b</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">id(a)</span><br></pre></td></tr></table></figure>




<pre><code>2012965952</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">id(b)</span><br></pre></td></tr></table></figure>




<pre><code>2012965952</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">456</span></span><br><span class="line">d = <span class="number">456</span></span><br><span class="line">c <span class="keyword">is</span> d</span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">id(c)</span><br></pre></td></tr></table></figure>




<pre><code>2069301952784</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">id(d)</span><br></pre></td></tr></table></figure>




<pre><code>2069301953168</code></pre><ul>
<li>del</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">em = <span class="number">678</span></span><br><span class="line"><span class="comment"># 删除em</span></span><br><span class="line"><span class="keyword">del</span> em</span><br><span class="line">id(em)</span><br></pre></td></tr></table></figure>


<pre><code>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-34-aa4fc6229635&gt; in &lt;module&gt;()
      2 # 删除em
      3 del em
----&gt; 4 id(em)


NameError: name &apos;em&apos; is not defined</code></pre>]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>标准输入输出</title>
    <url>/2018-08-10-python-3.html</url>
    <content><![CDATA[<p>python自学第三节<br>标准输入输出</p>
<h2><span id="标准输入输出">标准输入输出</span></h2><ul>
<li>input（） 要求用户键入</li>
<li>print（） 屏幕输出</li>
</ul>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">age = input(<span class="string">"请输入你的年龄，按回车键结束"</span>)</span><br><span class="line">print(age)</span><br></pre></td></tr></table></figure>

<pre><code>请输入你的年龄，按回车键结束20
20</code></pre>]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>函数、return、函数参数、列表字典传入函数、函数文档</title>
    <url>/2018-08-10-python-5.html</url>
    <content><![CDATA[<p>python自学第五节<br>函数、return、函数参数、列表字典传入函数、函数文档</p>
<h2><span id="函数">函数</span></h2><ul>
<li>作用：<ul>
<li>代码组织</li>
<li>代码复用</li>
</ul>
</li>
<li>函数名</li>
<li>参数</li>
<li>返回值（可没有）</li>
<li>函数的定义</li>
<li>函数的调用</li>
</ul>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FirstFun</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"这是一个函数"</span>)</span><br><span class="line"><span class="comment"># 函数调用</span></span><br><span class="line">FirstFun()</span><br></pre></td></tr></table></figure>

<pre><code>这是一个函数</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">numFun</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        print(i)</span><br><span class="line">numFun()</span><br></pre></td></tr></table></figure>

<pre><code>1
2
3
4
5</code></pre><h3><span id="1-函数返回return语句">1、函数返回，return语句</span></h3><ul>
<li>表示无条件结束函数并返回结果</li>
<li>约定，任何函数都应该以return语句表示结束；无返回值可return None</li>
</ul>
<h4><span id="写一个求阶乘的函数">写一个求阶乘的函数</span></h4><ul>
<li>要求键入一个大于0的数</li>
<li>返回它的阶乘值</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">getnum = int(input(<span class="string">"输入大于0的数："</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fact</span><span class="params">(num)</span>:</span></span><br><span class="line">    w = num</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,num):</span><br><span class="line">        w *= (num-i)</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line">Fact(getnum)</span><br></pre></td></tr></table></figure>

<pre><code>输入大于0的数：5





120</code></pre><h3><span id="2-函数的参数">2、函数的参数</span></h3><ul>
<li>形参，函数定义时</li>
<li>实参，函数调用时</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Func1</span><span class="params">(yourname)</span>:</span></span><br><span class="line">    print(<span class="string">"your name is "</span> + yourname)</span><br><span class="line">Func1(<span class="string">"I"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>your name is I</code></pre><ul>
<li>关键字参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Func2</span><span class="params">(name,food)</span>:</span></span><br><span class="line">    print(name + <span class="string">" like eat "</span> + food)</span><br><span class="line">Func2(<span class="string">"Jony"</span>,<span class="string">"fish"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Jony like eat fish</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Func2(<span class="string">"fish"</span>,<span class="string">"Jony"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>fish like eat Jony</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 设置关键字参数</span></span><br><span class="line">Func2(name = <span class="string">"Jony"</span>,food = <span class="string">"fish"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Jony like eat fish</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 可换位置</span></span><br><span class="line">Func2(food = <span class="string">"fish"</span>,name = <span class="string">"Jony"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Jony like eat fish</code></pre><h3><span id="3-默认参数">3、默认参数</span></h3><ul>
<li>函数在定义时，就给参数一个默认值</li>
<li>注意：函数定义时，给某个参数默认值，其之后不能出现没有默认值的参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 给出一个默认参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Func3</span><span class="params">(score1,score2 = <span class="number">50</span>)</span>:</span></span><br><span class="line">    print(score1+score2)</span><br><span class="line"><span class="comment"># 调用时只写了一个参数，另一参数使用默认值</span></span><br><span class="line">Func3(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<pre><code>60</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Func3(<span class="number">10</span>,<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<pre><code>30</code></pre><h3><span id="4-序列参数-字典参数即将序列字典传入函数">4、序列参数、字典参数（即将序列，字典传入函数）</span></h3><ul>
<li>列表参数：所有参数作为一个列表传入<ul>
<li>在调用时列表前使用一个*号</li>
<li>列表的参数个数与函数参数个数一致</li>
</ul>
</li>
<li>字典参数：所有参数作为一个字典传入<ul>
<li>在调用时列表前使用两个**号</li>
<li>字典的参数个数与函数参数个数一致</li>
<li>字典的键与函数形参相同，键作为字符串类型</li>
<li>字典的值传给键所对应的形参</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myFunc</span><span class="params">(a,b,c)</span>:</span></span><br><span class="line">    print(<span class="string">"Value of a is %s"</span> %a)</span><br><span class="line">    print(<span class="string">"Value of b is %s"</span> %b)</span><br><span class="line">    print(<span class="string">"Value of c is %s"</span> %c)</span><br><span class="line">L1 = [<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>]</span><br><span class="line"><span class="comment"># 在调用时列表前使用一个*号</span></span><br><span class="line">myFunc(*L1)</span><br></pre></td></tr></table></figure>

<pre><code>Value of a is one
Value of b is two
Value of c is three</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L2 = &#123;<span class="string">"a"</span>:<span class="string">"one"</span>,<span class="string">"b"</span>:<span class="string">"two"</span>,<span class="string">"c"</span>:<span class="string">"three"</span>&#125;</span><br><span class="line"><span class="comment"># 使用两个*号</span></span><br><span class="line">myFunc(**L2)</span><br></pre></td></tr></table></figure>

<pre><code>Value of a is one
Value of b is two
Value of c is three</code></pre><h3><span id="5-星号元组参数">5、星号元组参数</span></h3><ul>
<li>星号元组参数</li>
<li>语法：<ul>
<li>def 函数名(*元组形参):<br>   语句块</li>
</ul>
</li>
<li>含义： *元组形参相当于将参数设置成列表<ul>
<li>形参可以任意个数</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Lfunc</span><span class="params">(*arg)</span>:</span></span><br><span class="line">    print(<span class="string">"进入元组参数"</span>)</span><br><span class="line">    print(arg)</span><br><span class="line"><span class="comment"># 不给参数代表列表为空</span></span><br><span class="line">Lfunc()</span><br></pre></td></tr></table></figure>

<pre><code>进入元组参数
()</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 可放多个参数</span></span><br><span class="line">Lfunc(<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>进入元组参数
(&apos;1&apos;, &apos;2&apos;, &apos;3&apos;)</code></pre><h3><span id="6-双星号字典参数">6、双星号字典参数</span></h3><ul>
<li>语法：<ul>
<li>def 函数名(**元组参数):<br>   函数体</li>
</ul>
</li>
<li>**函数名 代表的是字典</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DiFun</span><span class="params">(**args)</span>:</span></span><br><span class="line">    print(<span class="string">"进入字典"</span>)</span><br><span class="line">    print(args)</span><br><span class="line">DiFun()</span><br></pre></td></tr></table></figure>

<pre><code>进入字典
{}</code></pre><ul>
<li>双星号字典参数，调用时必须按照字典的格式；有”键”和”值”</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DiFun(a=<span class="string">"one"</span>,b=<span class="string">"two"</span>,c=<span class="string">"three"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>进入字典
{&apos;a&apos;: &apos;one&apos;, &apos;b&apos;: &apos;two&apos;, &apos;c&apos;: &apos;three&apos;}</code></pre><h3><span id="7-单星号元组参数与双星号字典参数都叫做-不定长参数">7、单星号元组参数与双星号字典参数都叫做 不定长参数</span></h3><ul>
<li>说明：<ul>
<li>位置形参，单星号元组形参，双星号字典形参可以混用</li>
<li>混用时，顺序必须是：位置形参，单星号元组形参，双星号字典形参</li>
</ul>
</li>
</ul>
<h3><span id="8-函数返回值">8、函数返回值</span></h3><ul>
<li>一般需要返回值，使用return</li>
<li>函数的类型就是返回值的类型</li>
<li>可以没有return，不建议去掉</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fun1</span><span class="params">(one)</span>:</span></span><br><span class="line">    print(<span class="string">"skr skr skr!!!"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">Fun1(<span class="number">999</span>)</span><br></pre></td></tr></table></figure>

<pre><code>skr skr skr!!!</code></pre><ul>
<li>有return无返回值时，返回None</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = Fun1(<span class="number">999</span>)</span><br><span class="line">print(w)</span><br></pre></td></tr></table></figure>

<pre><code>skr skr skr!!!
None</code></pre><ul>
<li>没有return时，返回值也为None</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SecFun</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"第二个 skr,没有return"</span>)</span><br><span class="line">w = SecFun()</span><br><span class="line">print(w)</span><br></pre></td></tr></table></figure>

<pre><code>第二个 skr,没有return
None</code></pre><ul>
<li>返回值为多个的用法<ul>
<li>当函数有多个返回值却给它一个存储变量时，自动将其打包为tuple类型</li>
<li>可以将多个返回值赋值给对应个数的变量</li>
<li>所以多个返回值只能打包成一个tuple或者与其对应数量的变量</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nFunc</span><span class="params">(one,two)</span>:</span></span><br><span class="line">    one += <span class="number">10</span></span><br><span class="line">    two *= <span class="number">3</span></span><br><span class="line">    three = one + two</span><br><span class="line">    <span class="keyword">return</span> one,two,three</span><br><span class="line">a = nFunc(<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">print(a)</span><br><span class="line">type(a)</span><br></pre></td></tr></table></figure>

<pre><code>(12, 12, 24)





tuple</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">o,t,h = nFunc(<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">print(o,t,h)</span><br></pre></td></tr></table></figure>

<pre><code>12 12 24</code></pre><h3><span id="9-函数文档">9、函数文档</span></h3><ul>
<li>函数文档值在函数开头起一定说明的文字</li>
<li>例子如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Sum</span><span class="params">(one,two)</span>:</span></span><br><span class="line">    <span class="string">'''这是函数文档，解释函数的作用</span></span><br><span class="line"><span class="string">    这个函数是用来求one到two值的求和'''</span></span><br><span class="line">    three = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(one,two + <span class="number">1</span>):</span><br><span class="line">        three += i</span><br><span class="line">    <span class="keyword">return</span> three</span><br><span class="line">Sum(<span class="number">100</span>,<span class="number">150</span>)</span><br></pre></td></tr></table></figure>




<pre><code>6375</code></pre><ul>
<li>查看函数文档可用； 函数.<strong>doc</strong>  doc两边是两个下划线</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Sum.__doc__</span><br></pre></td></tr></table></figure>




<pre><code>&apos;这是函数文档，解释函数的作用\n    这个函数是用来求one到two值的求和&apos;</code></pre><ul>
<li>可使用help来查询某个函数的函数文档</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">help(Sum)</span><br></pre></td></tr></table></figure>

<pre><code>Help on function Sum in module __main__:

Sum(one, two)
    这是函数文档，解释函数的作用
    这个函数是用来求one到two值的求和</code></pre>]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python数据类型</title>
    <url>/2018-08-10-python-1.html</url>
    <content><![CDATA[<p>python自学第一节<br>数据类型</p>
<a id="more"></a>

<h1><span id="python数据类型">python数据类型</span></h1><h2><span id="1-数字类型">1 数字类型</span></h2><p>常量数字</p>
<p> 数字类型  |  数字举例</p>
<p> ————–| —————–</p>
<p> 十进制整数 |  222， 666</p>
<p> 浮点数     |  0.8765， 4e-12</p>
<p> 复数       |  4+5j</p>
<p> 二进制（0b开头）| 0b1001</p>
<p> 十六进制（0x开头）| 0xfec</p>
<p> 八进制（0o开头）| 0o432</p>
<pre><code>-补充，八进制在python2.x中可以以0开头，而在python3中只能0o开头</code></pre><p>整数</p>
<p>浮点数</p>
<p>复数</p>
<p>bool作为数字使用</p>
<!--more-->

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 0b二进制</span></span><br><span class="line">a = <span class="number">0b101</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<pre><code>5</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 十六进制</span></span><br><span class="line">a = <span class="number">0xfbe</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<pre><code>4030</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 八进制</span></span><br><span class="line">a = <span class="number">0o776</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<pre><code>510</code></pre><h3><span id="1整数">(1)整数</span></h3><p>可以表示任何大的数</p>
<p>  -二进制</p>
<p>  -八进制</p>
<p>  -十六进制</p>
<h4><span id="进制之间的转换">进制之间的转换</span></h4><h4><span id="转换成二进制">转换成二进制</span></h4><pre><code>bin()</code></pre><h4><span id="转换为八进制">转换为八进制</span></h4><pre><code>oct()</code></pre><h4><span id="转换为十六进制">转换为十六进制</span></h4><pre><code>hex()</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 十进制转换为二进制</span></span><br><span class="line">a = <span class="number">678</span></span><br><span class="line">b = bin(a)</span><br><span class="line">print(b)</span><br><span class="line"><span class="comment"># 十进制转换为八进制</span></span><br><span class="line">c = oct(a)</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># 十进制转换为十六进制</span></span><br><span class="line">d = hex(a)</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

<pre><code>0b1010100110
0o1246
0x2a6</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 二进制转换为八进制</span></span><br><span class="line">a = <span class="number">0b1011</span></span><br><span class="line">b = oct(a)</span><br><span class="line">print(b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检验是否正确转换</span></span><br><span class="line">c = <span class="number">0o13</span></span><br><span class="line">print(a)</span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<pre><code>0o13
11
11</code></pre><h3><span id="2浮点数">(2)浮点数</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 小数</span></span><br><span class="line">a = <span class="number">3.456</span></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># 科学计数法</span></span><br><span class="line">b = <span class="number">3.356e9</span></span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>

<pre><code>3.456
3356000000.0</code></pre><h3><span id="3复数">(3)复数</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 实部和虚部</span></span><br><span class="line">a = <span class="number">55</span> + <span class="number">6j</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<pre><code>(55+6j)</code></pre><h3><span id="4bool">(4)bool</span></h3><h2><span id="2字符串">2字符串</span></h2><p>单引号 ‘’</p>
<p>双引号 “”</p>
<p>三单引号 ‘’’ ‘’’</p>
<p>三双单引号””” “””</p>
<h4><span id="几个引号表示字符串的区别">几个引号表示字符串的区别</span></h4><ul>
<li>单引号和双引号没有区别</li>
<li>三单引号和三双单引号没有区别</li>
<li>三引号可表示换行类的字符串，或者在函数开头解释</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">'''这世界</span></span><br><span class="line"><span class="string">不可能</span></span><br><span class="line"><span class="string">有这么美丽'''</span></span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line">b = <span class="string">"这世界不可能有这么美丽"</span></span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>

<pre><code>这世界
不可能
有这么美丽
这世界不可能有这么美丽</code></pre><h4><span id="当字符串中出现引号的表示方法及转义字符">当字符串中出现引号的表示方法及转义字符</span></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">"Let's go"</span></span><br><span class="line">b =  <span class="string">'''Let's go '''</span></span><br><span class="line">c = <span class="string">"""这是'FF' """</span></span><br><span class="line"><span class="comment">#转义字符</span></span><br><span class="line">d = <span class="string">"Let\'s go"</span></span><br><span class="line">print(a)</span><br><span class="line">print(b)</span><br><span class="line">print(c)</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

<pre><code>Let&apos;s go
Let&apos;s go 
这是&apos;FF&apos; 
Let&apos;s go</code></pre><h3><span id="3转义字符">3转义字符</span></h3><ul>
<li>一些不好直接表示的符号，如引号，换行符，制表符</li>
<li>单引号 &#39;</li>
<li>双引号 &quot;</li>
<li>响铃 \a</li>
<li>换行 \n</li>
<li>水平制表 \t</li>
<li>垂直制表 \v</li>
<li>倒退 \b</li>
<li>空字符串，字符值为0 \0</li>
<li>unicode16位的十六进制数值 \uXXXX (四个数字)</li>
<li>unicode32为的十六进制数值 \uXXXX XXXX (八个数字)</li>
<li>八进制 \oXX</li>
<li>十六进制 \xXX (第一个为x，后面为数字)</li>
</ul>
<h3><span id="4-string类型的api">4   string类型的API</span></h3><ul>
<li>API 应用程序接口<h4><span id="1一般函数">（1）一般函数</span></h4></li>
<li>startswith\endswith<br>判断\检查以什么开头\结尾</li>
<li>count<pre><code>-计数，计算一个字符串中一个子字符串出现的个数</code></pre></li>
<li>find<pre><code>-查找一个字符串中一个字符出现的位置</code></pre></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.startswith(<span class="string">"I"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.endswith(<span class="string">"l"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.count(<span class="string">"w"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>2</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.count(<span class="string">"l"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>4</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 字符下标从0开始</span></span><br><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.find(<span class="string">"w"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>2</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I well well"</span></span><br><span class="line">s.find(<span class="string">"a"</span>)</span><br></pre></td></tr></table></figure>




<pre><code>-1</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">help(str)</span><br></pre></td></tr></table></figure>

<pre><code>Help on class str in module builtins:

class str(object)
 |  str(object=&apos;&apos;) -&gt; str
 |  str(bytes_or_buffer[, encoding[, errors]]) -&gt; str
 |  
 |  Create a new string object from the given object. If encoding or
 |  errors is specified, then the object must expose a data buffer
 |  that will be decoded using the given encoding and error handler.
 |  Otherwise, returns the result of object.__str__() (if defined)
 |  or repr(object).
 |  encoding defaults to sys.getdefaultencoding().
 |  errors defaults to &apos;strict&apos;.
 |  
 |  Methods defined here:
 |  
 |  __add__(self, value, /)
 |      Return self+value.
 |  
 |  __contains__(self, key, /)
 |      Return key in self.
 |  
 |  __eq__(self, value, /)
 |      Return self==value.
 |  
 |  __format__(...)
 |      S.__format__(format_spec) -&gt; str
 |      
 |      Return a formatted version of S as described by format_spec.
 |  
 |  __ge__(self, value, /)
 |      Return self&gt;=value.
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __getitem__(self, key, /)
 |      Return self[key].
 |  
 |  __getnewargs__(...)
 |  
 |  __gt__(self, value, /)
 |      Return self&gt;value.
 |  
 |  __hash__(self, /)
 |      Return hash(self).
 |  
 |  __iter__(self, /)
 |      Implement iter(self).
 |  
 |  __le__(self, value, /)
 |      Return self&lt;=value.
 |  
 |  __len__(self, /)
 |      Return len(self).
 |  
 |  __lt__(self, value, /)
 |      Return self&lt;value.
 |  
 |  __mod__(self, value, /)
 |      Return self%value.
 |  
 |  __mul__(self, value, /)
 |      Return self*value.n
 |  
 |  __ne__(self, value, /)
 |      Return self!=value.
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  __rmod__(self, value, /)
 |      Return value%self.
 |  
 |  __rmul__(self, value, /)
 |      Return self*value.
 |  
 |  __sizeof__(...)
 |      S.__sizeof__() -&gt; size of S in memory, in bytes
 |  
 |  __str__(self, /)
 |      Return str(self).
 |  
 |  capitalize(...)
 |      S.capitalize() -&gt; str
 |      
 |      Return a capitalized version of S, i.e. make the first character
 |      have upper case and the rest lower case.
 |  
 |  casefold(...)
 |      S.casefold() -&gt; str
 |      
 |      Return a version of S suitable for caseless comparisons.
 |  
 |  center(...)
 |      S.center(width[, fillchar]) -&gt; str
 |      
 |      Return S centered in a string of length width. Padding is
 |      done using the specified fill character (default is a space)
 |  
 |  count(...)
 |      S.count(sub[, start[, end]]) -&gt; int
 |      
 |      Return the number of non-overlapping occurrences of substring sub in
 |      string S[start:end].  Optional arguments start and end are
 |      interpreted as in slice notation.
 |  
 |  encode(...)
 |      S.encode(encoding=&apos;utf-8&apos;, errors=&apos;strict&apos;) -&gt; bytes
 |      
 |      Encode S using the codec registered for encoding. Default encoding
 |      is &apos;utf-8&apos;. errors may be given to set a different error
 |      handling scheme. Default is &apos;strict&apos; meaning that encoding errors raise
 |      a UnicodeEncodeError. Other possible values are &apos;ignore&apos;, &apos;replace&apos; and
 |      &apos;xmlcharrefreplace&apos; as well as any other name registered with
 |      codecs.register_error that can handle UnicodeEncodeErrors.
 |  
 |  endswith(...)
 |      S.endswith(suffix[, start[, end]]) -&gt; bool
 |      
 |      Return True if S ends with the specified suffix, False otherwise.
 |      With optional start, test S beginning at that position.
 |      With optional end, stop comparing S at that position.
 |      suffix can also be a tuple of strings to try.
 |  
 |  expandtabs(...)
 |      S.expandtabs(tabsize=8) -&gt; str
 |      
 |      Return a copy of S where all tab characters are expanded using spaces.
 |      If tabsize is not given, a tab size of 8 characters is assumed.
 |  
 |  find(...)
 |      S.find(sub[, start[, end]]) -&gt; int
 |      
 |      Return the lowest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Return -1 on failure.
 |  
 |  format(...)
 |      S.format(*args, **kwargs) -&gt; str
 |      
 |      Return a formatted version of S, using substitutions from args and kwargs.
 |      The substitutions are identified by braces (&apos;{&apos; and &apos;}&apos;).
 |  
 |  format_map(...)
 |      S.format_map(mapping) -&gt; str
 |      
 |      Return a formatted version of S, using substitutions from mapping.
 |      The substitutions are identified by braces (&apos;{&apos; and &apos;}&apos;).
 |  
 |  index(...)
 |      S.index(sub[, start[, end]]) -&gt; int
 |      
 |      Return the lowest index in S where substring sub is found, 
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Raises ValueError when the substring is not found.
 |  
 |  isalnum(...)
 |      S.isalnum() -&gt; bool
 |      
 |      Return True if all characters in S are alphanumeric
 |      and there is at least one character in S, False otherwise.
 |  
 |  isalpha(...)
 |      S.isalpha() -&gt; bool
 |      
 |      Return True if all characters in S are alphabetic
 |      and there is at least one character in S, False otherwise.
 |  
 |  isdecimal(...)
 |      S.isdecimal() -&gt; bool
 |      
 |      Return True if there are only decimal characters in S,
 |      False otherwise.
 |  
 |  isdigit(...)
 |      S.isdigit() -&gt; bool
 |      
 |      Return True if all characters in S are digits
 |      and there is at least one character in S, False otherwise.
 |  
 |  isidentifier(...)
 |      S.isidentifier() -&gt; bool
 |      
 |      Return True if S is a valid identifier according
 |      to the language definition.
 |      
 |      Use keyword.iskeyword() to test for reserved identifiers
 |      such as &quot;def&quot; and &quot;class&quot;.
 |  
 |  islower(...)
 |      S.islower() -&gt; bool
 |      
 |      Return True if all cased characters in S are lowercase and there is
 |      at least one cased character in S, False otherwise.
 |  
 |  isnumeric(...)
 |      S.isnumeric() -&gt; bool
 |      
 |      Return True if there are only numeric characters in S,
 |      False otherwise.
 |  
 |  isprintable(...)
 |      S.isprintable() -&gt; bool
 |      
 |      Return True if all characters in S are considered
 |      printable in repr() or S is empty, False otherwise.
 |  
 |  isspace(...)
 |      S.isspace() -&gt; bool
 |      
 |      Return True if all characters in S are whitespace
 |      and there is at least one character in S, False otherwise.
 |  
 |  istitle(...)
 |      S.istitle() -&gt; bool
 |      
 |      Return True if S is a titlecased string and there is at least one
 |      character in S, i.e. upper- and titlecase characters may only
 |      follow uncased characters and lowercase characters only cased ones.
 |      Return False otherwise.
 |  
 |  isupper(...)
 |      S.isupper() -&gt; bool
 |      
 |      Return True if all cased characters in S are uppercase and there is
 |      at least one cased character in S, False otherwise.
 |  
 |  join(...)
 |      S.join(iterable) -&gt; str
 |      
 |      Return a string which is the concatenation of the strings in the
 |      iterable.  The separator between elements is S.
 |  
 |  ljust(...)
 |      S.ljust(width[, fillchar]) -&gt; str
 |      
 |      Return S left-justified in a Unicode string of length width. Padding is
 |      done using the specified fill character (default is a space).
 |  
 |  lower(...)
 |      S.lower() -&gt; str
 |      
 |      Return a copy of the string S converted to lowercase.
 |  
 |  lstrip(...)
 |      S.lstrip([chars]) -&gt; str
 |      
 |      Return a copy of the string S with leading whitespace removed.
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  partition(...)
 |      S.partition(sep) -&gt; (head, sep, tail)
 |      
 |      Search for the separator sep in S, and return the part before it,
 |      the separator itself, and the part after it.  If the separator is not
 |      found, return S and two empty strings.
 |  
 |  replace(...)
 |      S.replace(old, new[, count]) -&gt; str
 |      
 |      Return a copy of S with all occurrences of substring
 |      old replaced by new.  If the optional argument count is
 |      given, only the first count occurrences are replaced.
 |  
 |  rfind(...)
 |      S.rfind(sub[, start[, end]]) -&gt; int
 |      
 |      Return the highest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Return -1 on failure.
 |  
 |  rindex(...)
 |      S.rindex(sub[, start[, end]]) -&gt; int
 |      
 |      Return the highest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Raises ValueError when the substring is not found.
 |  
 |  rjust(...)
 |      S.rjust(width[, fillchar]) -&gt; str
 |      
 |      Return S right-justified in a string of length width. Padding is
 |      done using the specified fill character (default is a space).
 |  
 |  rpartition(...)
 |      S.rpartition(sep) -&gt; (head, sep, tail)
 |      
 |      Search for the separator sep in S, starting at the end of S, and return
 |      the part before it, the separator itself, and the part after it.  If the
 |      separator is not found, return two empty strings and S.
 |  
 |  rsplit(...)
 |      S.rsplit(sep=None, maxsplit=-1) -&gt; list of strings
 |      
 |      Return a list of the words in S, using sep as the
 |      delimiter string, starting at the end of the string and
 |      working to the front.  If maxsplit is given, at most maxsplit
 |      splits are done. If sep is not specified, any whitespace string
 |      is a separator.
 |  
 |  rstrip(...)
 |      S.rstrip([chars]) -&gt; str
 |      
 |      Return a copy of the string S with trailing whitespace removed.
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  split(...)
 |      S.split(sep=None, maxsplit=-1) -&gt; list of strings
 |      
 |      Return a list of the words in S, using sep as the
 |      delimiter string.  If maxsplit is given, at most maxsplit
 |      splits are done. If sep is not specified or is None, any
 |      whitespace string is a separator and empty strings are
 |      removed from the result.
 |  
 |  splitlines(...)
 |      S.splitlines([keepends]) -&gt; list of strings
 |      
 |      Return a list of the lines in S, breaking at line boundaries.
 |      Line breaks are not included in the resulting list unless keepends
 |      is given and true.
 |  
 |  startswith(...)
 |      S.startswith(prefix[, start[, end]]) -&gt; bool
 |      
 |      Return True if S starts with the specified prefix, False otherwise.
 |      With optional start, test S beginning at that position.
 |      With optional end, stop comparing S at that position.
 |      prefix can also be a tuple of strings to try.
 |  
 |  strip(...)
 |      S.strip([chars]) -&gt; str
 |      
 |      Return a copy of the string S with leading and trailing
 |      whitespace removed.
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  swapcase(...)
 |      S.swapcase() -&gt; str
 |      
 |      Return a copy of S with uppercase characters converted to lowercase
 |      and vice versa.
 |  
 |  title(...)
 |      S.title() -&gt; str
 |      
 |      Return a titlecased version of S, i.e. words start with title case
 |      characters, all remaining cased characters have lower case.
 |  
 |  translate(...)
 |      S.translate(table) -&gt; str
 |      
 |      Return a copy of the string S in which each character has been mapped
 |      through the given translation table. The table must implement
 |      lookup/indexing via __getitem__, for instance a dictionary or list,
 |      mapping Unicode ordinals to Unicode ordinals, strings, or None. If
 |      this operation raises LookupError, the character is left untouched.
 |      Characters mapped to None are deleted.
 |  
 |  upper(...)
 |      S.upper() -&gt; str
 |      
 |      Return a copy of S converted to uppercase.
 |  
 |  zfill(...)
 |      S.zfill(width) -&gt; str
 |      
 |      Pad a numeric string S with zeros on the left, to fill a field
 |      of the specified width. The string S is never truncated.
 |  
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |  
 |  maketrans(x, y=None, z=None, /)
 |      Return a translation table usable for str.translate().
 |      
 |      If there is only one argument, it must be a dictionary mapping Unicode
 |      ordinals (integers) or characters to Unicode ordinals, strings or None.
 |      Character keys will be then converted to ordinals.
 |      If there are two arguments, they must be strings of equal length, and
 |      in the resulting dictionary, each character in x will be mapped to the
 |      character at the same position in y. If there is a third argument, it
 |      must be a string, whose characters will be mapped to None in the result.</code></pre><h4><span id="2-判断字符串">(2) 判断字符串</span></h4><ul>
<li>islower/isupper<pre><code>- 判断字符串是否全是大写小写</code></pre></li>
<li>isdigit<pre><code>- 判断字符串是否全是数字</code></pre></li>
<li>isalpha<pre><code>- 判断是否全是英文字母</code></pre></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"XDFGHJ"</span></span><br><span class="line">w.isupper()</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"asdfgh"</span></span><br><span class="line">w.islower()</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"123467"</span></span><br><span class="line">w.isdigit()</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"AaSs"</span></span><br><span class="line">w.isalpha()</span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><h4><span id="3操作字符串">（3）操作字符串</span></h4><ul>
<li>lower/upper<ul>
<li>将字符串转换为小写、大写</li>
</ul>
</li>
<li>strip/lstrip/rstrip<ul>
<li>去掉字符串最左和最右的空格/去掉最左的空格/去掉最右的空格</li>
</ul>
</li>
<li>swapcase<ul>
<li>交换大小写</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"AS DD"</span></span><br><span class="line">w1 = w.lower()</span><br><span class="line">w2 = w1.upper()</span><br><span class="line">print(w1)</span><br><span class="line">print(w2)</span><br></pre></td></tr></table></figure>

<pre><code>as dd
AS DD</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 交换大小写</span></span><br><span class="line">w = <span class="string">"AS bbbbbbb"</span></span><br><span class="line">w.swapcase()</span><br></pre></td></tr></table></figure>




<pre><code>&apos;as BBBBBBB&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"  .   123,wehdjahsk   .   "</span></span><br><span class="line">w1 = w.strip()</span><br><span class="line">w2 = w.lstrip()</span><br><span class="line">w3 = w.rstrip()</span><br><span class="line">print(w1)</span><br><span class="line">print(w2)</span><br><span class="line">print(w3)</span><br></pre></td></tr></table></figure>

<pre><code>.   123,wehdjahsk   .
.   123,wehdjahsk   .   
  .   123,wehdjahsk   .</code></pre><h4><span id="4字符串的格式化">(4)字符串的格式化</span></h4><ul>
<li>%</li>
<li>format</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = <span class="string">"My name is Inno and my age is 19,my height is 172"</span></span><br><span class="line"><span class="comment">#格式化</span></span><br><span class="line">s = <span class="string">"My name ia %s and my age is %d,my height is %d"</span> % (<span class="string">"Inno"</span>,<span class="number">19</span>,<span class="number">172</span>)</span><br><span class="line">print(w)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>My name is Inno and my age is 19,my height is 172
My name ia Inno and my age is 19,my height is 172</code></pre><ul>
<li>用%进行格式化<ul>
<li>%d 整形数</li>
<li>%f 浮点数</li>
<li>%s 字符</li>
</ul>
</li>
<li>当替换只有一个时，后面括号可省略</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"I don\'t have %f"</span> % <span class="number">5.55</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>I don&apos;t have 5.550000</code></pre><ul>
<li>对小数位数进行限制   .xf<ul>
<li>要替换的参数数量与后面括号中参数对应</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 对小数位数进行限制   .xf</span></span><br><span class="line">s = <span class="string">"I don\'t have %.1f"</span> % <span class="number">5.55</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>I don&apos;t have 5.5</code></pre><ul>
<li>如果想要输出%，只要字符串后面不跟% （）就行</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="string">"这是%100会出现%"</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>这是%100会出现%</code></pre><h4><span id="占位符的种类">占位符的种类</span></h4><ul>
<li>%s 字符串</li>
<li>%r 字符串，但是是使用repr而不是str</li>
<li>%c 整数转换为单个字符</li>
<li>%d 十进制整数</li>
<li>%u 无符号整数</li>
<li>%o 八进制整数</li>
<li>%x %X 十六进制</li>
<li>%e %E 科学计数法浮点数，如2.35e5  7.89898E19</li>
<li>%f %F 浮点数十进制形式</li>
<li>%g %G 十进制浮点数或指数浮点数自动转换</li>
<li>格式字符前出现 - 表示左对齐</li>
<li>格式字符前出现 0 表示高位不足用0补齐</li>
<li>width表示宽度</li>
<li>pricision表示精度</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = <span class="number">2.35E+12</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>2350000000000.0</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 左对齐，右对齐，0补全</span></span><br><span class="line">s = <span class="string">"you are%7dage"</span> % <span class="number">16</span></span><br><span class="line">print(s)</span><br><span class="line">w = <span class="string">"you are%-7dage"</span> % <span class="number">16</span></span><br><span class="line">print(w)</span><br><span class="line"></span><br><span class="line">h = <span class="string">"you are%07dage"</span> % <span class="number">16</span></span><br><span class="line"></span><br><span class="line">print(h)</span><br></pre></td></tr></table></figure>

<pre><code>you are     16age
you are16     age
you are0000016age</code></pre><h3><span id="bool类型">bool类型</span></h3><ul>
<li>True/False</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">3</span> &gt; <span class="number">4</span></span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b = <span class="literal">False</span></span><br><span class="line">b</span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 字符可直接比较</span></span><br><span class="line"><span class="string">"H"</span> &gt; <span class="string">"A"</span></span><br></pre></td></tr></table></figure>




<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">"haha"</span> &gt; <span class="string">"kkkk"</span></span><br></pre></td></tr></table></figure>




<pre><code>False</code></pre><ul>
<li>bool类型作为数字参与运算，表示1</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bool类型作为数字参与运算，表示1</span></span><br><span class="line"><span class="literal">True</span> * <span class="number">3</span></span><br></pre></td></tr></table></figure>




<pre><code>3</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="literal">True</span> + <span class="number">8</span></span><br></pre></td></tr></table></figure>




<pre><code>9</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="literal">True</span> * <span class="number">0</span></span><br></pre></td></tr></table></figure>




<pre><code>0</code></pre><ul>
<li>数字作为判断，非0都为True</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="number">6</span>:</span><br><span class="line">    print(<span class="string">"True"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"False"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>True</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="number">4</span>&gt;<span class="number">5</span>):</span><br><span class="line">    print(<span class="string">"True"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"False"</span>)</span><br></pre></td></tr></table></figure>

<pre><code>False</code></pre><h3><span id="none">None</span></h3><ul>
<li>一个特殊的常量</li>
<li>不表示任何类型，用来占位或者解除变量绑定，None与任何类型比较返回False<ul>
<li>作用：<ul>
<li>占位</li>
<li>解除绑定</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">567</span></span><br><span class="line">print(a)</span><br><span class="line">a = <span class="literal">None</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<pre><code>567
None</code></pre><ul>
<li>None与其他类型比较会报错</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="literal">None</span></span><br><span class="line">a &gt; <span class="number">8</span></span><br></pre></td></tr></table></figure>


<pre><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-27-93a628a0a8a1&gt; in &lt;module&gt;()
      1 a = None
----&gt; 2 a &gt; 8


TypeError: &apos;&gt;&apos; not supported between instances of &apos;NoneType&apos; and &apos;int&apos;</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="literal">None</span> &gt; <span class="string">"L"</span></span><br></pre></td></tr></table></figure>


<pre><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-28-210e6e66cd8b&gt; in &lt;module&gt;()
----&gt; 1 None &gt; &quot;L&quot;


TypeError: &apos;&gt;&apos; not supported between instances of &apos;NoneType&apos; and &apos;str&apos;</code></pre>]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>浏览器中session的使用，保存登陆状态与注销登陆</title>
    <url>/2019-08-02-session-brower.html</url>
    <content><![CDATA[<h2><span id="浏览器中session的使用保存登陆状态与注销登陆">浏览器中session的使用，保存登陆状态与注销登陆</span></h2><p>说明:</p>
<ul>
<li>apache2</li>
<li>php7</li>
<li>代码在<?php ?>标签内</li>
</ul>
<p>上篇文章:</p>
<p><a href="https://inno-hua.xyz/2019/07/31/php-password_hash().html" target="_blank" rel="noopener external nofollow noreferrer">PHP中password_hash()密码加密</a></p>
<a id="more"></a>

<h3><span id="1-保存登陆状态">1. 保存登陆状态</span></h3><ul>
<li>网页提交表单包含name=’username’</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; post获取用户名</span><br><span class="line">$username &#x3D; $_POST[&#39;username&#39;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 使用session保存密码</span><br><span class="line">session_start();</span><br><span class="line">$_SESSION[&#39;username&#39;] &#x3D; $username;</span><br></pre></td></tr></table></figure>

<h3><span id="2用户登出后销毁状态">2.用户登出后销毁状态</span></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">session_start();</span><br><span class="line">unset($_SESSION[&#39;username&#39;]);</span><br></pre></td></tr></table></figure>

<h3><span id="3在用户登陆后指向另一页面判断是否为登陆状态">3.在用户登陆后指向另一页面判断是否为登陆状态</span></h3><ul>
<li>只有在登录状态才能打开此页面welcome.php</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 判断是否为登陆状态</span><br><span class="line">session_start();</span><br><span class="line">if(!$_SESSION[&#39;username&#39;])&#123;&#x2F;&#x2F;未登陆</span><br><span class="line">    echo &quot;你没登陆&quot;;</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 可以把保存的session值赋值给变量</span><br><span class="line">$username &#x3D; $_SESSION[&#39;username&#39;];</span><br></pre></td></tr></table></figure>
<h3><span id="4使用session判断登录状态与登出状态">4.使用session判断登录状态与登出状态</span></h3><ul>
<li>welcome.php</li>
<li>通过链接welcome.php?action=logout来注销</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(!isset($_SESSION[&#39;username&#39;]))&#123;&#x2F;&#x2F;判断登录状态</span><br><span class="line">		echo &quot;你还未登陆&quot;;</span><br><span class="line">		echo &quot;&lt;br&#x2F;&gt;&quot; . &quot;&lt;a href&#x3D;&#39;login.html&#39;&gt;登陆&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">		exit();</span><br><span class="line">	&#125;else&#123;&#x2F;&#x2F; 已登录状态</span><br><span class="line">		$username &#x3D; $_SESSION[&#39;username&#39;];</span><br><span class="line">		echo &quot;&lt;title&gt;登陆成功&lt;&#x2F;title&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;h3&gt;登陆成功&lt;&#x2F;h3&gt;&quot; . &quot;$username&quot; . &quot; 欢迎你！&quot;;</span><br><span class="line">		echo &#39;点击此处 &lt;a href&#x3D;&quot;welcome.php?action&#x3D;logout&quot;&gt;注销&lt;&#x2F;a&gt;&lt;br &#x2F;&gt;&#39;;</span><br><span class="line">	&#125;</span><br><span class="line">	if($_GET[&#39;action&#39;] &#x3D;&#x3D; &quot;logout&quot;)&#123;&#x2F;&#x2F; 判断注销状态</span><br><span class="line">		session_start();</span><br><span class="line">		unset($_SESSION[&#39;username&#39;]);</span><br><span class="line">		echo &#39;注销登录成功！&#39;;</span><br><span class="line">		echo &quot;&lt;script&gt;</span><br><span class="line">		window.location.href &#x3D; &#39;login.html&#39;;</span><br><span class="line">	&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">	</span><br><span class="line">	exit();</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>php 浏览器session</tag>
      </tags>
  </entry>
  <entry>
    <title>校园网ip重置</title>
    <url>/2019-06-12-about-ipconfig.html</url>
    <content><![CDATA[<p>中文名：显示IP配置值   是一种DOS命令  可显示IP地址信息</p>
<p>更多关于ipconfig信息(百科):<a href="https://baike.baidu.com/item/ipconfig/2496619?fr=aladdin" target="_blank" rel="noopener external nofollow noreferrer">ipconfig</a></p>
<a id="more"></a>

<h2><span id="常用dos指令">常用DOS指令</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ipconfig/release</span><br><span class="line">ipconfig/reenew</span><br></pre></td></tr></table></figure>

<h3><span id="可用于解决局域网中电脑无法获取ip问题">可用于解决局域网中电脑无法获取ip问题</span></h3><p>指令描述</p>
<p>ipconfig/release 释放ip地址</p>
<p>ipconfig/renew 重新获取ip地址</p>
<h2><span id="其他关于ipconfig的dos指令">其他关于ipconfig的DOS指令</span></h2><p>ipconfig /all：显示本机TCP/IP配置的详细信息</p>
<p>ipconfig /flushdns：清除本地DNS缓存内容</p>
<p>ipconfig /displaydns：显示本地DNS内容</p>
<p>ipconfig /registerdns：DNS客户端手工向服务器进行注册</p>
<p>ipconfig /showclassid：显示网络适配器的DHCP类别信息</p>
<p>ipconfig /setclassid：设置网络适配器的DHCP类别</p>
<p>ipconfig /renew “Local Area Connection”：更新“本地连接”适配器的由 DHCP 分配 IP 地址的配置</p>
<p>ipconfig /showclassid Local*：显示名称以 Local 开头的所有适配器的 DHCP 类别 ID</p>
<p>ipconfig /setclassid “Local Area Connection” TEST：将“本地连接”适配器的 DHCP 类别 ID 设置为 TEST</p>
<h3><span id="可在windows下cmd命令打开dos面板进行">可在windows下cmd命令打开DOS面板进行</span></h3>]]></content>
      <tags>
        <tag>IPconfig</tag>
      </tags>
  </entry>
</search>
